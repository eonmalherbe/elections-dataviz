{"version":3,"sources":["config/index.js","utils/index.js","components/BarChart/d3barchart.js","events/index.js","api/config.js","api/race-for-seats.js","api/race-for-votes.js","api/turnout.js","api/spoilt.js","api/prog-votescount.js","api/index.js","components/BarChart/barchart.js","components/RaceForSeatBarchart/barchart.js","components/SpoiltBarchart/barchart.js","components/Map/map.js","components/TurnoutMap/map.js","components/TurnoutBarchart/barchart.js","components/BarchartWithNavMap/barchartMap.js","components/ProgVotesCountPiechart/d3piechart.js","components/ProgVotesCountPiechart/piechart.js","components/RaceForSeatDonut/piechart.js","components/VoteCompBarchart/barchart.js","components/SeatCompBarchart/barchart.js","components/SeatHorseShoeChart/d3horseshoe.js","components/SeatHorseShoeChart/horseshoe.js","components/VotePredictionLineChart/d3voteprediction.js","components/VotePredictionLineChart/voteprediction.js","components/SplitNatProv/d3groupbarchart.js","components/SplitNatProv/barchart.js","components/NavBar/navbar.js","components/QuickResultsWidget/quickResultsWidget.js","components/TVVoteCompBarchart/d3groupbarchart.js","components/TVSeatCompBarchart/barchart.js","components/TVVoteSwingBarchart/d3deltabarchart.js","components/TVSeatSwingBarchart/barchart.js","components/TVVoteCompBarchart/barchart.js","components/TVVoteSwingBarchart/barchart.js","App.js","serviceWorker.js","index.js"],"names":["config","DOMAIN","CSS_PREFIX","calcPercent","a","b","toFixed","getYear","desc","exec","parseVotesData","data","props","firstEdge","regionType","edges","console","error","nodeData","sort","node","percOfVotes","slice","numParties","map","el","name","iecId","validVotes","partyInfo","parseVotesComparisonData","eventDescriptions","electionType","results","edge","partyResults","result","filter","partyIecId","partyAbbr","abbreviation","indexOf","new_results","i","length","available","j","push","Object","objectSpread","parseVotesComparisonDataMultipleParties","partyAbbrs","partyIdx","newProps","partyIecIds","parseProgressVotesCount","percent","totalCount","count","getTopPartyNameFromNode","parseSeatsData","seats","parseSeatsComparisonData","parseSeatsComparisonDataMultipleParties","parseSpoiltVotesData","getRegionName","state","beautifiedMuniName","muniName","split","provinceName","getNationalProvincialStr2","eventDescription","toLocaleLowerCase","getSeatsCount","Eastern Cape","Free State","Gauteng","KwaZulu-Natal","Limpopo","Mpumalanga","North West","Northern Cape","Western Cape","getNationOrProvinceName","getNationOrProvinceName2","createTooltip","className","tooltipClassName","document","getElementsByClassName","d3","concat","append","attr","style","fixMapLabelIntersect","labelElements","regions","overlapCnt","getBoundingClientRect","rect1","rect2","right","left","bottom","top","setAttribute","innerHTML","triggerCustomEvent","eventName","eventParam","event","CustomEvent","detail","dispatchEvent","formatPartyName","toLowerCase","replace","l","toUpperCase","getSubRegionName","properties","SPROVINCE","smunicipal","getMunicipalityiecId","getMunicipalityCode","code","VDNumber","PKLVDNUMBE","getRegionFileName","muniCode","handleRegionChange","newState","JSON","parse","stringify","componentID","this","setState","fetchDataFromOBJ","keys","forEach","key","formatClassNameFromString","str","createSvg","container","width","height","selectAll","remove","classed","createErrorText","xOffset","yOffset","undefined","Chart","options","chartType","yAxisLabel","yValue","d","yValueFormat","value","offset","predefColors","svg","showLegend","tooltipDiv","x","rangeRound","y","text","barSvg","barTextSvg","errorText","draw","chartData","colorsData","partyColorByName","partyAbbrByName","getFillColorFromPartyName","partyName","getFillColor","noXaxisByParty","colour","domain","minMaxY","dynamicYAxisFromValues","maxValue","parseFloat","customizeDynamicMaxValue","select","transition","duration","call","ticks","tickFormat","bars","exit","enter","bandwidth","on","html","getTooltipText","pageX","pageY","Number","barTexts","parties","_ref","party","legends","xydata","parseInt","getLegendXY","destroy","events","client","ApolloClient","link","HttpLink","uri","useGETForQueries","headers","Content-Type","cache","InMemoryCache","getSeatsDataForComparison","query","gql","_templateObject","_templateObject2","getSeatsData","_templateObject3","_templateObject4","getVotesDataForComparison","race_for_votes_templateObject3","race_for_votes_templateObject4","_templateObject5","_templateObject6","getVotesDataM","_templateObject11","_templateObject12","_templateObject13","_templateObject14","getTurnoutDataForOneEvent","turnout_templateObject4","turnout_templateObject5","turnout_templateObject6","turnout_templateObject7","getSpoiltData","spoilt_templateObject","spoilt_templateObject2","spoilt_templateObject3","spoilt_templateObject4","getProgressVotesCount","prog_votescount_templateObject","prog_votescount_templateObject2","prog_votescount_templateObject3","prog_votescount_templateObject4","getPartyColors","api_templateObject2","getProvincesData","provincesData","munis","localeCompare","partyColorsData","originName","styles","cn","chartOptions","maxVal","Math","min","BarChart","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","comp","stylesheetFor","chart","refreshIntervalID","exportAsPNG","bind","assertThisInitialized","exportAsPNGUri","handlePreviewEvent","self","getContainer","setInterval","addEventListener","removeEventListener","clearInterval","svgToPng","saveSvgAsPng","refs","vizcontainer","childNodes","Promise","resolve","reject","svgAsPngUri","log","_this$state","react_default","createElement","ref","dataLoaders","partyColorsLoader","all","then","values","votesData","drawGraph","catch","locationResult","fetchLocationTrackFromVDdata","needUpdate","Component","regionColor","Map","disableNavigation","prevProps","prevState","rect","rendercanvas","window","canvg","ignoreDimensions","scaleWidth","scaleHeight","toDataURL","e","canvas","filename","lnk","download","href","createEvent","initMouseEvent","fireEvent","loading","react_loading_default","type","color","_this2","fullRouteGeoJsonFile","getLoadingSpinner","h","geoJsonLoader","_templateObject15","_templateObject16","_templateObject17","getMainParties","geoJsonData","locationToMainParty","parseMainPartyData","jsonDataFeatures","getMainPartyName","objects","topojson","features","projection","fitSize","path","availableCnt","center","projectionCenter","geometry","polylabel","coordinates","undefinedText","mainPartyName","subRegionName","tooltipText","appendSpan","foDiv","regionName","addSub","appendLink","setRegionType","currentRegionName","setTimeout","alert","isTurnout","turnout_templateObject","turnout_templateObject2","turnout_templateObject3","getTurnoutData","locationToMainData","getFillColorFromTurnout","turnout","getFillColorFromCountProg","countProg","getMainData","mainData","locationToTurnout","percVoterTurnout","parseTurnoutData","locationToProgVotes","parseCountingProgressDataForMap","it","eventType","turnout_templateObject8","turnout_templateObject9","turnout_templateObject10","turnout_templateObject11","getTurnoutDataForAllEvents","turnoutData","edge1","edge2","parseTurnoutDataForAllEvents","margin","variable","category","floatFormat","random","radius","pie","arc","outerRadius","innerRadius","cornerRadius","padAngle","totalSvg","transformX","labelSvg","toolTip","selection","hideTooltip","tip","toolTipHTML","arcTween","_current","t","colorsDataP","updatePath","data0","data1","each","m","k","findPreceding","startAngle","endAngle","n","findFollowing","findNeighborArc","attrTween","PieChart","progressVotesData","Completed","Not Completed","viewBox","seatsData","reduce","seats1","seats2","mainSvg","originChartData","largest","rest","totalSeats","rows","poslist","J","R","angle","Totals","PI","asin","sin","cos","onMouseMove","onMouseOut","Counter","partySvg","pythonConvertedCode","legendParams","boxX","columnSpacing","legendBoxWidth","boxMargin","positionBoxes2","idx","args","boxWidth","positionBoxes3","yShift","legendChart","el1","el2","legendContainer","seatParties","pos","HorseShoeChart","has_drawn","showPoints","pointRadius","showPointLabels","pointLabelOffset","showCurrentLine","minMaxData","getPartyColour","partyColours","partyColourByName","PartyColours","minX","maxX","range","radiusScale","axisContainer","lineContainer","eventCaptureContainer","valueline","cleaned_name","formatDate","hr","getHours","getMinutes","getDate","getMonth","getFullYear","VotePredictionLineChart","_isMounted","currentTimeText","Date","race_for_votes_templateObject","race_for_votes_templateObject2","getVotesPredictionData","predictionData","parseCSIRMinMax","lineData","percVds","prediction","predictionEdge","predictionNodeData","predictedPercent","partyIndex","actualPercent","oneLine","parseVotesPredictionData","_parseCSIRTurnoutTime","timestamp","parseCSIRTurnoutTimestamp","projectedTurnout","lastTimestamp","lastTimeStampText","XaxisOffset","groupChartData","topLabel","item","groupSvgs","groupSvg","_loop","subX","_ref2","usedValue","numPartiesSplitNatProv","eventDescriptionsSplitNatProv","_templateObject7","_templateObject8","_templateObject9","_templateObject10","getVotesDataForAllEvents","year","shortenedNatProv","getShortenedEventDescription","longEventDescription","edge1Year","edge2Year","parseVotesDataForAllEvents","cssPrefix","metrosData","CustomLink","onClick","hasSubMenu","toggleSubMenu","activateMe","newLocation","to","selectedMenuLabel","label","children","React","NavBar","nationalEventDescription","provincialEventDescription","activeLinkId","handleNavBarSelection","getElementById","id","rel","head","appendChild","navbar","target","activeElement","classList","add","lastClass","passInfo","enableMap","enableBarChart","enableTurnoutProgressSpoilt","selectionData","join","preventDefault","open","content","icon","metro","province","lib_default","activeLinkTo","LinkComponent","QuickResultsWidget","national","provincial","currentTurnout","currentCountingProg","currentSpoiltVotes","fetchCurrentResultData","handleSeatsElectedsEvent","showLoadingIcon","spoiltData","progVotesData","parsedSpoiltData","parsedTurnoutData","parseTurnoutDataForOneEvent","parsedProgVotesData","parsedVotesData","voteItem","parsedSeatsData","seatItem","curCountingProg","zipfileName","imageLoadPromises","toConsumableArray","barchartInstances","instance","mapInstance","barchartInstance","zip","JSZip","imgs","folder","element","file","base64","generateAsync","saveAs","triggerState","_this$state2","_this$state3","getRegionName2","getNationalProvincialStr4","getNationalProvincialStr3","getRegionName4","msgMapClick","_this$state4","mapState","Map_map","assign","TurnoutMap_map","_this3","_this$state5","BarChart_barchart","SeatHorseShoeChart_horseshoe","TurnoutBarchart_barchart","ProgVotesCountPiechart_piechart","VotePredictionLineChart_voteprediction","Array","VoteCompBarchart_barchart","SeatCompBarchart_barchart","SplitNatProv_barchart","placeholder","onShowVDResult","vdInput","components","renderQuickResultsTitle","renderTurnoutProgressSpoilt","renderMyVDEnterForm","renderBarchart","renderMap","NavBar_navbar","YaxisOffset","barAxisTextSvg","barAxisTexts","newGroupChartData","delta","deltaData","abs","barTextYDelta","axisThick","App","QuickResultsWidget_quickResultsWidget","Boolean","location","hostname","match","ReactDOM","render","src_App_0","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.e31d3fe7.chunk.js","sourcesContent":["var config = {\n    \"DOMAIN\": \"https://sabc-eds.github.io/elections-dataviz\",\n    // \"DOMAIN\": \"http://127.0.0.1:8080\",\n    \"CSS_PREFIX\": \"ELVIZ_\"\n}\n\nexport default config;","import * as d3 from \"d3\";\nimport config from \"../config\";\n\nfunction calcPercent(a, b) {\n  if (b == 0) {\n    return 0;\n  } else {\n    return (a/b*100).toFixed(2);\n  }\n}\n\nexport function getShortenedEventDescription(event) {\n  var year = /(19|20)\\d{2}/g.exec(event[\"description\"])[0];\n  var shortenedNatProv = (event[\"eventType\"][\"description\"] == \"National Election\"? \"Nat\": \"Prov\");\n  return `${year} ${shortenedNatProv}`;\n}\n\nexport function getYear(desc) {\n  return /(19|20)\\d{2}/g.exec(desc)[0];\n}\n\nexport function parseVotesDataForAllEvents(data, props) {\n    var results, edges;\n    var regionType = props.regionType;\n    if (regionType == \"national\") {\n      edges = data[\"data\"][\"allBallots\"].edges;\n    } else if (regionType == \"province\") {\n      edges = data[\"data\"][\"allProvincialBallots\"].edges;\n    } else if (regionType == \"municipality\") {\n      edges= data[\"data\"][\"allMunicipalBallots\"].edges;\n    } else { //\"municipality-vd\"\n      edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n    }\n\n    console.log(\"props\", props)\n    return edges.map(edge => {\n      var nodeData = edge[\"node\"];\n\n      var eventDescription = getShortenedEventDescription(nodeData[\"event\"]); //nodeData[\"event\"][\"description\"];\n      var partyResults = nodeData[\"partyResults\"] || nodeData[\"topResult\"];\n      results = partyResults[\"edges\"];\n      results = results.sort(function(a, b) {return b.node.percOfVotes - a.node.percOfVotes});\n      results = results.slice(0, props.numPartiesSplitNatProv);\n\n      return {\n        longEventDescription: nodeData[\"event\"][\"description\"],\n        eventDescription,\n        data: results.map(function(node) {\n          var el = node[\"node\"];\n          return {\n              name: el[\"party\"][\"abbreviation\"],\n              iecId: el[\"party\"][\"iecId\"],\n              validVotes: el[\"validVotes\"].toFixed(2),\n              percOfVotes: el[\"percOfVotes\"].toFixed(2),\n              partyInfo: el[\"party\"]\n          }\n        })\n      }\n    }).filter(edge => props.eventDescriptionsSplitNatProv.indexOf(edge.longEventDescription) != -1)\n    .sort(function(edge1, edge2) {\n      var edge1Year = parseInt(/(19|20)\\d{2}/g.exec(edge1.eventDescription)[0]);\n      var edge2Year = parseInt(/(19|20)\\d{2}/g.exec(edge2.eventDescription)[0]);\n      if (edge1Year == edge2Year) {\n        if (edge1.eventDescription > edge2.eventDescription) {\n          return 1;\n        }\n        return -1;\n      }\n      return -edge1Year + edge2Year;\n    })\n}\n \nexport function parseVotesData(data, props) {\n    var results, firstEdge;\n    var regionType = props.regionType;\n    if (regionType == \"national\") {\n      firstEdge = data[\"data\"][\"allBallots\"].edges[0];\n    } else if (regionType == \"province\") {\n      firstEdge = data[\"data\"][\"allProvincialBallots\"].edges[0];\n    } else if (regionType == \"municipality\") {\n      firstEdge= data[\"data\"][\"allMunicipalBallots\"].edges[0];\n    } else { //\"municipality-vd\"\n      firstEdge = data[\"data\"][\"allVotingDistrictBallots\"].edges[0];\n    }\n    if (!firstEdge){\n      console.error(\"party data is empty!!\");\n      return null;\n    }\n\n    var nodeData = firstEdge[\"node\"];\n    var partyResults = nodeData[\"partyResults\"] || nodeData[\"topResult\"];\n    results = partyResults[\"edges\"];\n    results = results.sort(function(a, b) {return b.node.percOfVotes - a.node.percOfVotes});\n\n    results = results.slice(0, props.numParties);\n\n    return results.map(function(node) {\n        var el = node[\"node\"];\n        return {\n            name: el[\"party\"][\"abbreviation\"],\n            iecId: el[\"party\"][\"iecId\"],\n            validVotes: el[\"validVotes\"].toFixed(2),\n            percOfVotes: el[\"percOfVotes\"].toFixed(2),\n            partyInfo: el[\"party\"]\n        }\n    });\n}\n\nexport function fetchLocationTrackFromVDdata(data) {\n  var firstEdge = data[\"data\"][\"allVotingDistrictBallots\"].edges[0];\n  var nodeData = firstEdge[\"node\"];\n  var locationResult = nodeData[\"location\"];\n  var newState = {\n    regionType: \"municipality-vd\",\n    iecId: locationResult[\"iecId\"],\n    muniCode: locationResult[\"ward\"][\"municipality\"][\"code\"],\n    provinceName: locationResult[\"ward\"][\"municipality\"][\"province\"][\"name\"],\n  };     \n  return newState;      \n}\n\nexport function parseVotesComparisonData(data, props) {\n  var results, edges;\n\n  var regionType = props.regionType;\n  var eventDescriptions = props.eventDescriptions[\"national\"]\n  if (props.electionType === \"provincial\")\n    eventDescriptions = props.eventDescriptions[\"provincial\"]\n\n  if (regionType == \"national\") {\n    edges = data[\"data\"][\"allBallots\"].edges;\n  } else if (regionType == \"province\") {\n    edges = data[\"data\"][\"allProvincialBallots\"].edges;\n  } else if (regionType == \"municipality\") {\n    edges= data[\"data\"][\"allMunicipalBallots\"].edges;\n  } else { //\"municipality-vd\"\n    edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n  }\n\n  var partyfilter_edges = edges.map(edge => {\n    var nodeData = edge[\"node\"];\n    var partyResults = nodeData[\"partyResults\"] || nodeData[\"topResult\"];\n    results = partyResults[\"edges\"]\n      .filter(a => props.partyIecId\n        ? (a.node[\"party\"][\"iecId\"] == props.partyIecId) \n        : (a.node[\"party\"][\"abbreviation\"] == props.partyAbbr));\n    var result = results[0];\n    if (result) {\n      var el = result[\"node\"];\n      return {\n          name: nodeData[\"event\"][\"description\"],\n          percOfVotes: el[\"percOfVotes\"].toFixed(2),\n          partyInfo: el[\"party\"]\n      }\n    }\n    return {\n      name: nodeData[\"event\"][\"description\"],\n      percOfVotes: 0,\n      partyInfo: {\n        name: props.partyAbbr,\n        abbreviation: props.partyAbbr,\n      }\n    }\n  });\n  var results = partyfilter_edges.filter(edge => eventDescriptions.indexOf(edge.name) != -1);\n\n  var new_results = [];\n  for(var i = 0; i < eventDescriptions.length; i ++) {\n    var available = false;\n    for (var j = 0; j < results.length; j ++) {\n      if (results[j].name == eventDescriptions[i]) {\n        var available = true;\n        new_results.push({\n          ...results[j],\n          name: getYear(results[j].name)\n        });\n        break;\n      }\n    }\n    if (!available) {\n      new_results.push({\n        name: getYear(eventDescriptions[i]),\n        percOfVotes: 0,\n        partyInfo: {\n          name: props.partyAbbr,\n          abbreviation: props.partyAbbr,\n        } \n      })\n    }\n  }\n  // new_results.sort(function(a, b) {\n  //   return a.name - b.name;\n  // })\n  return new_results;\n}\n\nexport function parseVotesComparisonDataMultipleParties(data, props) {\n  return props.partyAbbrs.map((partyAbbr, partyIdx) => {\n    var newProps = {...props};\n    newProps.partyAbbr = partyAbbr;\n    newProps.partyIecId = props.partyIecIds[partyIdx];\n    return {\n      partyAbbr,\n      data: parseVotesComparisonData(data, newProps)\n    }\n  })\n}\n\nexport function parseProgressVotesCount(data, props) {\n  var firstEdge;\n  var regionType = props.regionType;\n  if (regionType == \"national\") {\n    firstEdge = data[\"data\"][\"allBallots\"].edges[0];\n  } else if (regionType == \"province\") {\n    firstEdge = data[\"data\"][\"allProvincialBallots\"].edges[0];\n  } else if (regionType == \"municipality\") {\n    firstEdge= data[\"data\"][\"allMunicipalBallots\"].edges[0];\n  } else { //\"municipality-vd\"\n    firstEdge = data[\"data\"][\"allVotingDistrictBallots\"].edges[0];\n  }\n  if (!firstEdge){\n    console.error(\"progress votes count data is empty!!\");\n    return null;\n  }\n\n  var nodeData = firstEdge[\"node\"];\n\n  return [\n    {\n      name: \"Completed\",\n      percent: calcPercent(nodeData[\"vdWithResultsCaptured\"], nodeData[\"vdCount\"]),\n      totalCount: nodeData[\"vdCount\"],\n      count: nodeData[\"vdWithResultsCaptured\"]\n    }, {\n      name: \"Not Completed\",\n      percent: 100 - calcPercent(nodeData[\"vdWithResultsCaptured\"], nodeData[\"vdCount\"]),\n      totalCount: nodeData[\"vdCount\"],\n      count: nodeData[\"vdCount\"] - nodeData[\"vdWithResultsCaptured\"]\n    }\n  ]\n}\n\n// export function parseMainPartyData(data, props) {\n//     if (!data)  return null;\n//     var locationToMainParty = {};\n//     var edges;\n//     var regionType = props.regionType;\n//     var sort_results = function(party_results) {\n//         party_results[\"edges\"] = party_results[\"edges\"].sort(function(a, b) {\n//             return b.node.percOfVotes - a.node.percOfVotes;\n//         })\n//         return party_results;\n//     }\n//     if (regionType === \"national\") {\n//         edges = data[\"data\"][\"allProvincialBallots\"].edges;\n//         edges.forEach(function(edge) {\n//             var node = edge.node;\n//             var provinceName = node[\"location\"][\"name\"];\n//             var partyResults = sort_results(node[\"partyResults\"]);\n//             var partyName = partyResults[\"edges\"][0][\"node\"][\"party\"][\"name\"];\n//             locationToMainParty[provinceName] = partyName;\n//         })\n//     } else if (regionType === \"province\") {\n//         edges = data[\"data\"][\"allMunicipalBallots\"].edges;\n//         edges.forEach(function(edge) {\n//             var node = edge.node;\n//             var muniCode = node[\"location\"][\"code\"];\n//             var partyResults = sort_results(node[\"partyResults\"]);\n\n//             var partyName = partyResults[\"edges\"][0][\"node\"][\"party\"][\"name\"];\n//             locationToMainParty[muniCode] = partyName;\n//         })\n//     } else {// \"municipality\"\n//         edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n//         edges.forEach(function(edge) {\n//             var node = edge.node;\n//             var iecId = node[\"location\"][\"iecId\"];\n//             var partyResults = sort_results(node[\"partyResults\"]);\n\n//             var partyName = partyResults[\"edges\"][0][\"node\"][\"party\"][\"name\"];\n//             locationToMainParty[iecId] = partyName;\n//         })\n//     }\n//     return locationToMainParty;\n// }\n\nfunction getTopPartyNameFromNode(node) {\n  if (node && node[\"topParty\"] && node[\"topParty\"][\"party\"] && node[\"topParty\"][\"party\"][\"name\"])\n      return node[\"topParty\"][\"party\"][\"name\"];\n  return \"\";\n}\n\nexport function parseMainPartyData(data, props) {\n  if (!data)  return null;\n  var locationToMainParty = {};\n  var edges;\n  var regionType = props.regionType;\n  if (regionType === \"national\") {\n      edges = data[\"data\"][\"topPartiesByProvince\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var provinceName = node[\"location\"][\"name\"];\n          locationToMainParty[provinceName] = getTopPartyNameFromNode(node);\n      })\n  } else if (regionType === \"province\") {\n      edges = data[\"data\"][\"topPartiesByMunicipality\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var muniCode = node[\"location\"][\"code\"];\n          locationToMainParty[muniCode] = getTopPartyNameFromNode(node);\n      })\n  } else {// \"municipality\"\n      edges = data[\"data\"][\"topPartiesByVotingDistrict\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var iecId = node[\"location\"][\"iecId\"];\n          locationToMainParty[iecId] = getTopPartyNameFromNode(node);\n      })\n  }\n  return locationToMainParty;\n}\n\nexport function parseSeatsData(data, props) {\n  if (!data)  return null;\n  var edges = data[\"data\"][\"allSeatCalculations\"].edges;\n  var regionType = props.regionType;\n  var results = edges.map(edge => {\n    var node = edge.node;\n    var seats = 0;\n    if (regionType === \"national\") {\n      seats = node[\"nationalPr\"] + node[\"regional\"];\n    } else {//\"province\"\n      seats = node[\"regional\"];\n    }\n    return {\n      seats,\n      name: node[\"party\"][\"abbreviation\"],\n      iecId: node[\"party\"][\"iecId\"],\n      partyInfo: node[\"party\"],\n    }\n  })\n  \n  // results.sort(function(a,b) {\n  //   return b[\"seats\"] - a[\"seats\"];\n  // })\n  return results.slice(0, props.numParties);\n}\n\nexport function parseVotesPredictionData(data, props) {\n  // TODO actually implement a function that removes hypens and .s\n  var edges = data[\"data\"][\"CSIRPrediction\"][\"results\"].edges;\n  var partyIecIds = [];\n  var lineData = [];\n  edges.forEach(function(edge) {\n    var nodeData = edge.node;\n    var percVds = nodeData.percVds;\n    var prediction = nodeData.prediction;\n    var predictionEdges = prediction.edges;\n    predictionEdges.forEach(function(predictionEdge) {\n      console.log(\"predictionEdge\", predictionEdge);\n      var predictionNodeData = predictionEdge.node;\n      var partyInfo = predictionNodeData.party;\n      if (!partyInfo) {\n        return;\n      }\n      var predictedPercent = predictionNodeData.predictedPercent;\n      var actualPercent = predictionNodeData.actualPercent;\n\n      var partyIndex = partyIecIds.indexOf(partyInfo.iecId);\n      if (partyIndex == -1) {\n        partyIecIds.push(partyInfo.iecId);\n        lineData.push({\n          name: partyInfo.name,\n          iecId: partyInfo.iecId,\n          abbreviation: partyInfo.abbreviation,\n          cleaned_name: partyInfo.abbreviation.replace(/[^a-zA-Z0-9]+/g, ''),\n          data: []\n        });\n        partyIndex = partyIecIds.length - 1;\n      }\n      lineData[partyIndex].data.push({\n        'x': percVds,\n        'y': predictedPercent\n      })\n    })\n  })\n  lineData.forEach(oneLine => {\n    oneLine.data.sort(function(a, b) {\n      return a.x - b.x;\n    })\n  })\n  console.log(\"parsedLineData\", lineData);\n  // var lineData = [{\n  //     name : \"AFRICAN NATIONAL CONGRESS\",\n  //     cleaned_name : \"anc\",\n  //     data : [\n  //       {'x': 3, 'y': 51.6},\n  //       {'x': 6, 'y': 59.3},\n  //       {'x': 12, 'y': 55.4},\n  //       {'x': 20, 'y': 56},\n  //       {'x': 27, 'y': 59.5},\n  //       {'x': 33, 'y': 59.8},\n  //       {'x': 39, 'y': 61.2},\n  //       {'x': 45, 'y': 61.8},\n  //       {'x': 51, 'y': 62.7},\n  //       {'x': 57, 'y': 63.1},\n  //       {'x': 63, 'y': 63.6},\n  //       {'x': 69, 'y': 62.7},\n  //       {'x': 69, 'y': 62.7},\n  //       {'x': 75, 'y': 62.3},\n  //       {'x': 81, 'y': 62.9},\n  //       {'x': 87, 'y': 63},\n  //       {'x': 93, 'y': 62.8},\n  //       {'x': 100, 'y': 62.8},\n  //     ]\n  //   },\n  //   {\n  //     name : \"DEMOCRATIC ALLIANCE\",\n  //     cleaned_name: \"da\",\n  //     data : [\n  //       {'x': 3, 'y': 31.6},\n  //       {'x': 6, 'y': 39.3},\n  //       {'x': 12, 'y': 35.4},\n  //       {'x': 20, 'y': 36},\n  //       {'x': 27, 'y': 39.6},\n  //       {'x': 33, 'y': 39.8},\n  //       {'x': 39, 'y': 31.2},\n  //       {'x': 45, 'y': 31.4},\n  //       {'x': 51, 'y': 22.7},\n  //       {'x': 57, 'y': 33.1},\n  //       {'x': 63, 'y': 23.6},\n  //       {'x': 69, 'y': 32.7},\n  //       {'x': 69, 'y': 32.7},\n  //       {'x': 75, 'y': 22.3},\n  //       {'x': 81, 'y': 32.9},\n  //       {'x': 87, 'y': 33},\n  //       {'x': 93, 'y': 22.8},\n  //       {'x': 100, 'y': 22.8},\n  //     ]\n  //   }\n  // ];\n\n  return lineData;\n}\n\nexport function parseCSIRTurnoutTimestamp(data) {\n  var predictionData = data[\"data\"][\"CSIRPrediction\"];\n  var {\n    turnout,\n    timestamp\n  } = predictionData;\n  return {\n    turnout: turnout.toFixed(2),\n    timestamp\n  }\n}\n\nexport function parseCSIRMinMax(data) {\n  var predictionData = data[\"data\"][\"CSIRPrediction\"];\n  var {\n    minX,\n    maxX\n  } = predictionData;\n  return {\n    minX,\n    maxX\n  }\n}\n\nexport function parseSeatsComparisonData(data, props) {\n  if (!data)  return null;\n  var edges = data[\"data\"][\"allSeatCalculations\"].edges;\n  var regionType = props.regionType;\n  var eventDescriptions = props.eventDescriptions[\"national\"]\n  if (props.electionType === \"provincial\")\n    eventDescriptions = props.eventDescriptions[\"provincial\"]\n\n  var results = edges.map(edge => {\n    var node = edge.node;\n    var seats = 0;\n    if (regionType === \"national\") {\n      seats = node[\"nationalPr\"] + node[\"regional\"];\n    } else {//\"province\"\n      seats = node[\"regional\"];\n    }\n    return {\n      seats,\n      name: node[\"party\"][\"event\"][\"description\"],\n      partyInfo: node[\"party\"]\n    }\n  }).filter(result => eventDescriptions.indexOf(result.name) != -1)\n  .filter(result => \n    props.partyIecId\n    ? (result.partyInfo[\"iecId\"] == props.partyIecId)\n    : (result.partyInfo[\"abbreviation\"] == props.partyAbbr)\n  )\n\n  var new_results = [];\n  for(var i = 0; i < eventDescriptions.length; i ++) {\n    var available = false;\n    for (var j = 0; j < results.length; j ++) {\n      if (results[j].name == eventDescriptions[i]) {\n        var available = true;\n        new_results.push({\n          ...results[j],\n          name: getYear(results[j].name)\n        });\n        break;\n      }\n    }\n    if (!available) {\n      new_results.push({\n        name: getYear(eventDescriptions[i]),\n        seats: 0,\n        partyInfo: {\n          name: props.partyAbbr,\n          abbreviation: props.partyAbbr,\n        } \n      })\n    }\n  }\n      // name: nodeData[\"event\"][\"description\"],\n      // percOfVotes: 0,\n      // partyInfo: {\n      //   name: props.partyAbbr,\n      //   abbreviation: props.partyAbbr,\n      // }\n  // results.sort(function(a,b) {\n  //   return b[\"seats\"] - a[\"seats\"];\n  // })\n  return new_results;\n}\n\nexport function parseSeatsComparisonDataMultipleParties(data, props) {\n  return props.partyAbbrs.map((partyAbbr, partyIdx) => {\n    var newProps = {...props};\n    newProps.partyAbbr = partyAbbr;\n    newProps.partyIecId = props.partyIecIds[partyIdx];\n    return {\n      partyAbbr,\n      data: parseSeatsComparisonData(data, newProps)\n    }\n  })\n}\n\nexport function parseTurnoutData(data, props) {\n  if (!data)  return null;\n  var locationToTurnout = {};\n  var edges;\n  var regionType = props.regionType;\n  if (regionType === \"national\") {\n      edges = data[\"data\"][\"allProvincialBallots\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var provinceName = node[\"location\"][\"name\"];\n          var percVoterTurnout = node[\"percVoterTurnout\"].toFixed(2); \n          locationToTurnout[provinceName] = percVoterTurnout;\n      })\n  } else if (regionType === \"province\") {\n      edges = data[\"data\"][\"allMunicipalBallots\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var muniCode = node[\"location\"][\"code\"];\n          var percVoterTurnout = node[\"percVoterTurnout\"].toFixed(2); \n          locationToTurnout[muniCode] = percVoterTurnout;\n      })\n  } else {// \"municipality\" or \"municipality-vd\"\n      edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var iecId = node[\"location\"][\"iecId\"];\n          var percVoterTurnout = node[\"percVoterTurnout\"].toFixed(2); \n          locationToTurnout[iecId] = percVoterTurnout;\n      })\n  }\n  return locationToTurnout;\n}\n\nexport function parseCountingProgressDataForMap(data, props) {\n  if (!data)  return null;\n  var locationToProgVotes = {};\n  var edges;\n  var regionType = props.regionType;\n  if (regionType === \"national\") {\n      edges = data[\"data\"][\"allProvincialBallots\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var provinceName = node[\"location\"][\"name\"];\n          \n          locationToProgVotes[provinceName] = calcPercent(node[\"vdWithResultsCaptured\"], node[\"vdCount\"]); \n      })\n  } else if (regionType === \"province\") {\n      edges = data[\"data\"][\"allMunicipalBallots\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var muniCode = node[\"location\"][\"code\"];\n          locationToProgVotes[muniCode] = calcPercent(node[\"vdWithResultsCaptured\"], node[\"vdCount\"]); \n      })\n  } else {// \"municipality\" or \"municipality-vd\"\n      edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n      edges.forEach(function(edge) {\n          var node = edge.node;\n          var iecId = node[\"location\"][\"iecId\"];\n          locationToProgVotes[iecId] = calcPercent(node[\"vdWithResultsCaptured\"], node[\"vdCount\"]); \n      })\n  }\n  return locationToProgVotes;\n}\n\nexport function parseTurnoutDataForAllEvents(data, props) {\n  if (!data)  return null;\n  var edges;\n  var regionType = props.regionType;\n  if (regionType == \"national\") {\n    edges = data[\"data\"][\"allBallots\"].edges;\n  } else if (regionType == \"province\") {\n    edges = data[\"data\"][\"allProvincialBallots\"].edges;\n  } else if (regionType == \"municipality\") {\n    edges = data[\"data\"][\"allMunicipalBallots\"].edges;\n  } else if (regionType == \"municipality-vd\") {\n    edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n  }\n  \n  return edges.map(function(edge) {\n    var node = edge.node;\n    var event = node[\"event\"][\"description\"];\n    var eventType = node[\"event\"][\"eventType\"][\"description\"];\n    var percVoterTurnout = node[\"percVoterTurnout\"].toFixed(2); \n    return {\n      name: getYear(event),\n      eventType: eventType,\n      percVoterTurnout\n    }\n  }).filter(edge => edge.eventType.toLowerCase().indexOf(props.eventType) != -1)\n  .sort(function(edge1, edge2) {\n    var edge1Year = parseInt(/(19|20)\\d{2}/g.exec(edge1.name)[0]);\n    var edge2Year = parseInt(/(19|20)\\d{2}/g.exec(edge2.name)[0]);\n    return -edge1Year + edge2Year;\n  })\n}\n\nexport function parseTurnoutDataForOneEvent(data, props) {\n  if (!data)  return null;\n  var edges;\n  var regionType = props.regionType;\n  if (regionType == \"national\") {\n    edges = data[\"data\"][\"allBallots\"].edges;\n  } else if (regionType == \"province\") {\n    edges = data[\"data\"][\"allProvincialBallots\"].edges;\n  } else if (regionType == \"municipality\") {\n    edges = data[\"data\"][\"allMunicipalBallots\"].edges;\n  } else if (regionType == \"municipality-vd\") {\n    edges = data[\"data\"][\"allVotingDistrictBallots\"].edges;\n  }\n  \n  return edges.map(function(edge) {\n    var node = edge.node;\n    var event = node[\"event\"][\"description\"];\n    var percVoterTurnout = node[\"percVoterTurnout\"].toFixed(2); \n    return {\n      name: getYear(event),\n      percVoterTurnout\n    }\n  })\n}\n\nexport function parseSpoiltVotesData(data, props) {\n  var firstEdge;\n  var regionType = props.regionType;\n  if (regionType == \"national\") {\n    firstEdge = data[\"data\"][\"allBallots\"].edges[0];\n  } else if (regionType == \"province\") {\n    firstEdge = data[\"data\"][\"allProvincialBallots\"].edges[0];\n  } else if (regionType == \"municipality\") {\n    firstEdge= data[\"data\"][\"allMunicipalBallots\"].edges[0];\n  } else { //\"municipality-vd\"\n    firstEdge = data[\"data\"][\"allVotingDistrictBallots\"].edges[0];\n  }\n  if (!firstEdge){\n    console.error(\"spoilt data is empty!!\");\n    return null;\n  }\n\n  var nodeData = firstEdge[\"node\"];\n\n  return [\n    {\n      name: \"Valid\",\n      percent: calcPercent(nodeData[\"totalValidVotes\"], nodeData[\"totalVotesCast\"])\n    }, {\n      name: \"Spoilt\",\n      percent: calcPercent(nodeData[\"spoiltVotes\"], nodeData[\"totalVotesCast\"])\n    }\n  ]\n}\n\nexport function getRegionName(state) {\n  function beautifiedMuniName(muniName) {\n    if (muniName.indexOf(\" - \") != -1) {\n        muniName = muniName.split(\" - \")[1];\n    }\n    if (muniName.indexOf(\"[\") != -1) {\n        muniName = muniName.split(\"[\")[0];\n    }\n    return muniName;\n  }\n  if (state.regionType == \"national\") {\n    return \"South Africa\";\n  }\n  if (state.regionType == \"province\") {\n    return state.provinceName;\n  }\n  if (state.regionType == \"municipality\") {\n    return beautifiedMuniName(state.muniName);\n  }\n  if (state.regionType == \"municipality-vd\") {\n    return beautifiedMuniName(state.muniName) + \"-\" + state.iecId;\n  }\n}\n\nexport function getRegionName2(state) {\n  if (state.regionType == \"national\") {\n    var event = state.eventDescription.toLocaleLowerCase()\n\n    if (event.indexOf(\"national election\") >= 0) {\n      return \"National Assembly\"\n    }\n    else if (event.indexOf(\"provincial election\") >= 0) {\n      return \"Results for Provincial Legislatures\"\n    }\n    else\n      return \"\"\n  }\n  else if (state.regionType == \"province\") {\n    return getRegionName(state) + \" Legislature\";\n  }\n  return getRegionName(state);\n}\n\nexport function getRegionName3(state) {\n  if (state.regionType == \"national\")\n    return \"National\";\n  if (state.regionType == \"province\") {\n    return getRegionName(state) + \" Legislature\";\n  }\n  return getRegionName(state);\n}\n\nexport function getRegionName4(state) {\n  if (state.regionType == \"national\") {\n    return \"National Assembly\";\n  } else { // province\n    return state.provinceName + \" Legislature\";\n  }\n}\n\nexport function getNationalProvincialStr(state) {\n  var event = state.eventDescription.toLocaleLowerCase()\n  var nationalProvincialStr = \"\"; \n  if (event.indexOf(\"national election\") >= 0) {\n      nationalProvincialStr = \"National Assembly\";\n  } else {\n      nationalProvincialStr = \"Provincial Legislature\";\n  }\n  return nationalProvincialStr;\n}\n\nexport function getNationalProvincialStr2(state) {\n  var event = state.eventDescription.toLocaleLowerCase()\n  var nationalProvincialStr = \"\"; \n  if (event.indexOf(\"national election\") >= 0) {\n      nationalProvincialStr = \"National Assembly\";\n  } else {\n      nationalProvincialStr = state.provinceName + \" Legislature\";\n  }\n  return nationalProvincialStr;\n}\n\nexport function getNationalProvincialStr3(state) {\n  var event = state.eventDescription.toLocaleLowerCase()\n  var nationalProvincialStr = \"\"; \n  if (event.indexOf(\"national election\") >= 0) {\n      nationalProvincialStr = \"\";\n  } else {\n      nationalProvincialStr = \": \" + state.provinceName + \" Legislature\";\n  }\n  return nationalProvincialStr;\n}\n\nexport function getNationalProvincialStr4(state) {\n  var event = state.eventDescription.toLocaleLowerCase()\n  var nationalProvincialStr = \"\"; \n  if (event.indexOf(\"national election\") >= 0) {\n      nationalProvincialStr = \"National\";\n  } else {\n      nationalProvincialStr = state.provinceName + \" Legislature\";\n  }\n  return nationalProvincialStr;\n}\n\nexport function getSeatsCount(state) {\n  if (state.regionType == \"national\") {\n    return 400;\n  } else {\n    var seatsTable = {\n      \"Eastern Cape\": 63,\n      \"Free State\": 30,\n      \"Gauteng\": 73,\n      \"KwaZulu-Natal\": 80,\n      \"Limpopo\": 49,\n      \"Mpumalanga\": 30,\n      \"North West\": 33,\n      \"Northern Cape\": 30,\n      \"Western Cape\": 42,\n    }\n    return seatsTable[state.provinceName];\n  }\n  \n}\n\nexport function getNationOrProvinceName(state) {\n  if (state.regionType == \"national\") {\n    return \"South Africa\";\n  }\n  return state.provinceName;\n}\n\nexport function getNationOrProvinceName2(state) {\n  if (state.regionType == \"national\") {\n    return \"National Assembly\";\n  }\n  return state.provinceName;\n}\n\nexport function createTooltip(className) {\n  var tooltipClassName = className(config.CSS_PREFIX + \"tooltip\")\n  if (document.getElementsByClassName(tooltipClassName)[0]) {\n    return d3.select(`.${tooltipClassName}`);\n  } else {\n    return d3.select(\"body\").append(\"div\")\t\n      .attr(\"class\", tooltipClassName)\t\t\t\t\n      .style(\"opacity\", 0);\n  }\n}\n\n\n\nexport function fixMapLabelIntersect() {\n  var labelElements = document.getElementsByClassName(\"place-label\");\n  var regions = {};\n  var overlapCnt = {};\n  var i;\n\n  for (i = 0; i < labelElements.length; i ++) {\n      regions[i] = labelElements[i].getBoundingClientRect();\n  }\n\n  for (i = 0; i < labelElements.length; i ++) {\n      for (var j = 0; j < i; j ++) {\n          var rect1 = regions[i];\n          var rect2 = regions[j];\n          var overlap = !(rect1.right < rect2.left || \n              rect1.left > rect2.right || \n              rect1.bottom < rect2.top || \n              rect1.top > rect2.bottom);\n          if (overlap) {\n              overlapCnt[i] = overlapCnt[i]? (overlapCnt[i] + 1): 1;\n          }\n      }\n      if (overlapCnt[i] > 2) {\n          labelElements[i].setAttribute(\"opacity\", 0)\n      } else if (overlapCnt[i] > 0){\n          labelElements[i].innerHTML = labelElements[i].innerHTML.slice(0, 3) + \"...\";\n      } else {\n\n      }\n  }\n}\n\nexport function triggerCustomEvent(eventName, eventParam) {\n  var event = new CustomEvent(eventName, { detail: eventParam });\n  document.dispatchEvent(event);\n}\n\nexport function formatPartyName(name) {\n  return name.split(\"/\")[0].toLowerCase().replace(/\\b\\w/g, function(l){ return l.toUpperCase() })\n}\n\nexport function getSubRegionName(properties, state) {\n  if (state.regionType === \"national\") {\n      return properties.SPROVINCE;\n  } else if (state.regionType === \"province\") {\n      return properties.smunicipal && properties.smunicipal.split(\" - \")[1].split(\"[\")[0]; \n  } else {//municipality\n    return getMunicipalityiecId(properties);\n    // if (properties.Municipali) {\n    //   return properties.Municipali.split(\" - \")[1].split(\"[\")[0];\n    // }\n    // return properties.SMUNICIPAL && properties.SMUNICIPAL.split(\" - \")[1].split(\"[\")[0]; \n  }\n}\n\nexport function getMunicipalityCode(properties) {\n  return properties.code || (properties.smunicipal && properties.smunicipal.split(\" - \")[0].replace(/\\s/g, \"\"));\n}\n\nexport function getMunicipalityiecId(properties) {\n  return properties.VDNumber || properties.PKLVDNUMBE;\n}\n\nexport function getRegionFileName(state) {\n  var nationalMapFile = \"province_lo-res.geojson\";\n  function getProvinceFileName(provinceName) {\n      var provinceNameToFileMap = {\n          \"Limpopo\": \"lim_lo-res.geojson\",\n          \"Mpumalanga\": \"mp_lo-res.geojson\",\n          \"Gauteng\": \"gt_lo-res.geojson\",\n          \"KwaZulu-Natal\": \"kzn_lo-res.geojson\",\n          \"North West\": \"nw_lo-res.geojson\",\n          \"Free State\": \"fs_lo-res.geojson\",\n          \"Eastern Cape\": \"ec_lo-res.geojson\",\n          \"Northern Cape\": \"nc_lo-res.geojson\",\n          \"Western Cape\": \"wc_lo-res.geojson\",\n      }\n      return provinceNameToFileMap[provinceName];\n  }\n  switch(state.regionType) {\n      case \"national\":\n          return nationalMapFile;\n      case \"province\":\n          return getProvinceFileName(state.provinceName);\n      case \"municipality\":\n          return state.muniCode + \".topojson\";//\".geojson\";\n      case \"municipality-vd\":\n          return \"vd-data/\" + state.muniCode + \"-\" + state.iecId + \".topojson\"; //\".geojson\";\n      default:\n          return null;\n  }\n}\n\nexport function loadScript(id, scriptURL, callback) {\n  if (document.getElementById(id))\n    return;\n  var script = document.createElement('script');\n  script.onload = function () {\n    if(callback) {\n      callback();\n    }\n  };\n  script.id = id;\n  script.src = scriptURL;\n\n  document.head.appendChild(script);\n}\n\nexport function loadCanvg() {\n  loadScript(\"canvgScript\", \"https://cdn.jsdelivr.net/npm/canvg/dist/browser/canvg.min.js\", function() {\n    console.log(\"canvgScript load finished\");\n  });\n}\n\nexport function loadJSZip() {\n  loadScript(\"jsZipScript\", \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.0/jszip.min.js\", function() {\n    console.log(\"loadJSZip load finished\");\n  });\n}\n\nexport function loadScriptsForEmbedMode() {\n  loadCanvg();\n  loadJSZip();\n}\n\n\nexport function handleRegionChange(event) {\n  var newState = JSON.parse(JSON.stringify(event.detail));\n  delete newState.componentID;\n  this.setState(newState)\n}\n\nexport function fetchDataFromOBJ(state, props) {\n  Object.keys(state).forEach(key => {\n    if (typeof props[key] != 'undefined') {\n      state[key] = props[key];\n    }\n  })\n}\n\nexport function formatClassNameFromString(str) {\n  return \"formedClass_\" + str.replace(/[^a-zA-Z0-9]+/g, '');\n}\n\nexport function onPartyAbbrsChange(e) {\n    var options = e.target.options;\n    var values = [];\n    for (var i = 0, l = options.length; i < l; i++) {\n      if (options[i].selected) {\n        values.push(options[i].value);\n      }\n    }\n    values = values.slice(0, 4);\n    this.setState({\n        partyAbbrs: values.map(value => value.split(\"\\x22\")[0]),\n        partyIecIds: values.map(value => value.split(\"\\x22\")[1]),\n    })\n}\n\nexport function nationalEventSelected(state) {\n  for (var i = 0; i < state.electionEvents.length; i ++) {\n    if (state.electionEvents[i].description == state.eventDescription) {\n      if (state.electionEvents[i].eventType.description.toLowerCase().indexOf(\"national\") != -1) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nexport function createSvg(container, width, height) {\n  container.selectAll(\"svg\").remove();\n  var svg = container.append(\"svg\")\n      .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n      .attr(\"viewBox\", \"0 0 \" + (width) + \" \" + (height))\n      .classed(\"svg-content\", true);\n\n  return svg;\n}\n\nexport function createErrorText(container, xOffset, yOffset) {\n  if (xOffset === undefined) xOffset = 0;\n  if (yOffset === undefined) yOffset = 0;\n\n  var errorText = container.append(\"g\")\n    .attr(\"transform\", \"translate(\"+ xOffset + \",\" + yOffset + \")\")\n    .append(\"text\")\n    .attr(\"text-anchor\", \"middle\");\n\n  return errorText;\n}\n\nexport function PartyColours(partyColours) {\n  var partyColourByName = {};\n\n  if (partyColours && partyColours[\"data\"][\"allParties\"][\"edges\"]) {\n      partyColours[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n        partyColourByName[edge.node.name] = edge.node.colour;\n      })\n  }\n\n  // TODO should used cleaned name\n  function getFillColourFromPartyName(partyName, i) {\n    // console.log(partyColourByName[partyName])\n    // console.log(partyColourByName)\n    return partyColourByName[partyName];\n    //return partyColourByName[partyName.split(\"/\")[0]] || predefColours[i%predefColours.length];\n  }\n\n  return getFillColourFromPartyName;\n}\n\n","import * as d3 from \"d3\";\nimport {createTooltip, createSvg, createErrorText} from \"../../utils\";\nimport { type } from \"os\";\nimport config from \"../../config\";\nimport {\n  formatPartyName\n} from \"../../utils\";\n\nexport function Chart(container, width, height, className, options) {\n\n\n  if (!options) {\n    options = {};\n  } \n  if (!options.chartType) {\n    options.chartType = \"Race For Votes\";\n  }\n  if (!options.yAxisLabel) {\n    options.yAxisLabel = \"PERCENTAGE VOTES\";\n  }\n  if (!options.yValue) {\n    options.yValue = function(d) {\n      return d.percOfVotes;\n    }\n  }\n  if (!options.yValueFormat) {\n    options.yValueFormat = function(value) {\n      return value + '%';\n    }\n  }\n\n  var offset = {\n    width: 70,\n    height: 20\n  }\n\n  width = 700;\n  height = 200;\n\n  var predefColors = [\"blue\", \"yellow\", \"red\"];\n\n  var svg = createSvg(container, width + offset.width, height + offset.height + (options.showLegend ? 50 : 0))\n  var tooltipDiv = createTooltip(className);\n\n  var x = d3.scaleBand()\n    .rangeRound([offset.width, width])\n\n  var y = d3.scaleLinear()\n    .rangeRound([height, offset.height]);\n  \n    svg.append(\"g\")\n      .attr(\"transform\", \"translate(20,\"+(height/2+offset.height/2)+\")\")\n      .append(\"text\")\n      .attr(\"class\", className(config.CSS_PREFIX + \"percentage-label\"))\n      .attr(\"transform\", \"rotate(-90)\")\n      .text(options.yAxisLabel)\n      .attr(\"text-anchor\", \"middle\");\n  \n    svg.append(\"g\")\n      .attr(\"class\", \"x axis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n  \n    svg.append(\"g\")\n      .attr(\"class\", \"y axis\")\n      .attr(\"transform\", \"translate(\" + offset.width +\", 0)\")\n  \n    var barSvg = svg.append(\"g\")\n      .attr(\"class\", className(\"bar-container\"));\n    var barTextSvg = svg.append(\"g\")\n      .attr(\"class\", className(\"bartext-container\"));\n\n    var errorText = createErrorText(svg, width / 2, height / 2);\n\n    this.draw = function(chartData, colorsData) {\n\n      if (!chartData) {\n        errorText.text(\"chart data is not available\");\n        barSvg.selectAll('rect').remove();\n        barTextSvg.selectAll('text').remove();\n        return;\n      } else {\n        errorText.text(\"\");\n      }\n      var partyColorByName = {};\n      var partyAbbrByName = {};\n\n      if (options.noXaxisByParty) {\n\n      } else {\n        if (colorsData && colorsData[\"data\"][\"allParties\"][\"edges\"]) {\n          colorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n            partyColorByName[edge.node.name] = edge.node.colour;\n            partyAbbrByName[edge.node.name] = edge.node.abbreviation;\n          })\n        }\n      }\n\n      function getFillColorFromPartyName(partyName, i) {\n        return partyColorByName[partyName.split(\"/\")[0]] || predefColors[i%predefColors.length];\n      }\n\n      function getFillColor(d, i) {\n        if (options.noXaxisByParty) {\n          if (typeof colorsData == \"object\")\n            return colorsData[d.name];\n          if (typeof colorsData == \"function\")\n            return colorsData(d, i);\n          return colorsData;\n        } else {\n          return getFillColorFromPartyName(d.partyInfo.name, i);\n        }\n      }\n\n      function getTooltipText(d, i) {\n        if (options.noXaxisByParty) {\n          return d.name + \" : \" + options.yValueFormat(options.yValue(d));\n        } else {\n          return formatPartyName(d.partyInfo.name) + \" : \" + options.yValueFormat(options.yValue(d));\n        }\t\n      }\n\n      x.domain(chartData.map(function (d) {\n          return d.name;\n        }));\n      var minMaxY = [0, 100];\n      if (options.dynamicYAxisFromValues) {\n        var maxValue = d3.max(chartData, function(d) { return parseFloat(options.yValue(d)); });\n        if (options.customizeDynamicMaxValue) {\n          minMaxY[1] = options.customizeDynamicMaxValue(maxValue);\n        } else {\n          minMaxY[1] = maxValue + 1;\n        }\n      }\n      y.domain(minMaxY);\n  \n      svg.select(\".x.axis\").transition().duration(300).call(d3.axisBottom(x));\n      svg.select(\".y.axis\").transition().duration(300).call(d3.axisLeft(y)\n        .ticks(6)\n        .tickFormat(function(d) { return options.yValueFormat(d); })\n      )\n  \n      var bars = barSvg.selectAll(`.${className(\"bar\")}`).data(chartData);\n  \n      bars.exit()\n        .transition()\n        .duration(300)\n        .attr(\"y\", function(d) {\n          return y(0);\n        })\n        .attr(\"height\", 0)\n        .style(\"fill-opacity\", 1e-6)\n        .remove();\n  \n      bars.enter()\n          .append(\"rect\")\n          .attr(\"class\", (d) => className(\"bar\") + \" bar_\" + d.name)\n          .attr(\"x\", function (d) {\n            return x(d.name)+x.bandwidth()/20;\n          })\n          .attr(\"width\", x.bandwidth()*9/10)\n          .attr(\"fill\", (d,i) => getFillColor(d, i))\n          .on(\"mousemove\", function(d, i) {\t\t\n              d3.select(this)\n                .attr(\"opacity\", 0.8);\n              tooltipDiv.transition()\t\t\n                  .duration(200)\t\t\n                  .style(\"opacity\", .9);\t\t\n              tooltipDiv.html(getTooltipText(d, i))\n                  .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n              })\t\t\t\t\t\n          .on(\"mouseout\", function(d) {\t\t\n              d3.select(this)\n                .attr(\"opacity\", 1);\n              tooltipDiv.transition()\t\t\n                  .duration(200)\t\t\n                  .style(\"opacity\", 0);\t\n          })\n          .attr(\"y\", function(d) {\n            return y(0);\n          })\n          .attr(\"height\", 0)        \n  \n        barSvg.selectAll(`.${className(\"bar\")}`).data(chartData)\n          .attr(\"fill\", (d, i) => getFillColor(d, i))\n          .attr(\"x\", function (d) {\n            return x(d.name)+x.bandwidth()/20;\n          })\n          .attr(\"width\", x.bandwidth()*9/10)\n          .transition()\n          .duration(300)\n          .attr(\"y\", function (d) {\n            return y(Number(options.yValue(d)));\n          })\n          .attr(\"height\", function (d) {\n            return height - y(Number(options.yValue(d)));\n          })\n          \n        var barTexts = barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData);\n  \n        barTexts.exit()\n          .transition()\n          .duration(300)\n          .attr(\"y\", function(d) {\n            return y(0) - 5;\n          })\n          .style(\"fill-opacity\", 1e-6)\n          .remove();\n  \n        barTexts.enter().append(\"text\")\n          .attr(\"class\", className(\"bartext\"))\n          .attr(\"x\", function (d) {\n            return x(d.name)+x.bandwidth()/2;\n          })\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"font-size\", \"12px\")\n          .attr(\"y\", function(d) {\n            return y(0) - 5;\n          })\n        barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData)\n          .attr(\"x\", function (d) {\n            return x(d.name)+x.bandwidth()/2;\n          })\n          .text(function(d) {\n            return options.yValueFormat(options.yValue(d));\n          })\n          .transition()\n          .duration(300)\n          .attr(\"y\", function (d) {\n            return y(Number(options.yValue(d))) - 5;\n          })\n        \n        if (options.showLegend) {\n          var parties = [];\n          var partyIecIds = [];\n          chartData.forEach(({partyInfo}) => {\n            var party = partyInfo.name;\n            if (partyIecIds.indexOf(partyInfo.iecId) === -1 && partyInfo.iecId) {\n                parties.push(party);\n                partyIecIds.push(partyInfo.iecId);\n            }\n          })\n          \n          function getLegendXY(i) {\n            \n            var xydata = [offset.width + (i%5)*100, height + 30 + parseInt(i/5) * 40];\n            if (parties.length < 6) {\n              xydata[0] += 100 * ( 6 - parties.length) / 2;\n            }\n            return xydata;\n          }\n          svg.selectAll(`.${className(\"legend\")}`).remove();\n          var legends = svg.selectAll(`.${className(\"legend\")}`)\n              .data(parties)\n              .enter()\n              .append('g')\n              .attr(\"class\", className(\"legend\"))\n              .attr('transform', (d, i) => \"translate(\" + getLegendXY(i) + \")\")\n          legends\n              .append(\"rect\")\n              .attr('width', 10)\n              .attr('height', 10)\n              .attr('x', 0)\n              .attr('y', 0)\n              .attr(\"fill\", (party, i) => {\n                  return getFillColorFromPartyName(party);\n              })\n          legends.append('text')\n              .attr('x', 30)\n              .attr('y', 10)\n              .style('font-size', '12px')\n              .text(party => partyAbbrByName[party])\n        }\n        \n    }\n    this.destroy = function() {\n      svg.remove();\n    }\n  }","const REGION_CHANGE = \"region-change\";\nconst CHART_PREVIEW = \"chart-preview\";\nconst SEATS_ELECTEDS_EVENT = \"seats-electeds-event\";\nconst MAP_PREVIEW = \"map-preview\";\nconst QUICK_RESULTS_PREVIEW = \"quick-results-preview\"\nconst EXPORT_PNG = \"export-png\";\nconst EXPORT_SUPERWIDGET_PNG = \"export-superwidget-png\";\n\nexport default {\n    REGION_CHANGE,\n    CHART_PREVIEW,\n    SEATS_ELECTEDS_EVENT,\n    MAP_PREVIEW,\n    QUICK_RESULTS_PREVIEW,\n    EXPORT_PNG,\n    EXPORT_SUPERWIDGET_PNG,\n};","import { ApolloClient } from \"apollo-client\"\nimport { HttpLink } from \"apollo-link-http\"\nimport { InMemoryCache } from \"apollo-cache-inmemory\"\n\n// var API_URI = \"https://elections2019.xyz/graphql\";\nvar API_URI = \"https://eds.elections.sabc.co.za/graphql\";\n\n\nconst client = new ApolloClient({\n    link: new HttpLink({ uri: API_URI, useGETForQueries: true, headers: {\"Content-Type\" : \"application/graphql\" } }),\n    cache: new InMemoryCache()\n  })\n\nexport {\n    API_URI,\n    client\n}","import gql from \"graphql-tag\"\nimport {client} from \"./config\"\n\nexport function getSeatsDataForComparison(options) {\n  if (options.regionType === \"national\") {\n    return client.query({\n      query: gql`\n      {\n          allSeatCalculations(\n            eventType:\"National Election\" \n            orderBy:[\"-seats\"]){\n            edges{\n              node\n              {\n                nationalPr\n                regional\n                party{\n                  event {\n                    description\n                  }\n                  name\n                  abbreviation\n                  iecId\n                }\n                province{\n                  name\n                }\n              }\n            }\n          }\n      }\n      `\n    })\n  } else { //  if (options.regionType === \"province\")\n    return client.query({\n      query: gql`\n      {\n          allSeatCalculations(\n            province:\"${options.provinceName}\", \n            orderBy:[\"-seats\"]\n          ) {\n            edges{\n              node\n              {\n                nationalPr\n                regional\n                party{\n                  event {\n                    description\n                  }\n                  name\n                  abbreviation\n                  iecId\n                }\n                province{\n                  name\n                }\n              }\n            }\n          }\n      }\n      `\n    })\n  }\n}\n\n\nexport function getSeatsData(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n      return;\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n            allSeatCalculations(\n              event:\"${eventDescription}\", \n              orderBy:[\"-seats\"]\n            ) {\n              edges{\n                node\n                {\n                  nationalPr\n                  regional\n                  party{\n                    name\n                    abbreviation\n                    iecId\n                  }\n                  province{\n                    name\n                    country{\n                      event{\n                        description\n                      }\n                    }\n                  }\n                }\n              }\n            }\n        }\n        `\n      })\n    } else { //  if (options.regionType === \"province\")\n      eventDescription = eventDescription.replace(\"National\", \"Provincial\");\n      eventDescription = eventDescription.replace(\"NATIONAL\", \"PROVINCIAL\");\n      eventDescription = eventDescription.replace(\"national\", \"provincial\");\n      return client.query({\n        query: gql`\n        {\n            allSeatCalculations(\n              province:\"${options.provinceName}\", \n              event:\"${eventDescription}\", \n              orderBy:[\"-seats\"]\n            ) {\n              edges{\n                node\n                {\n                  nationalPr\n                  regional\n                  party{\n                    name\n                    abbreviation\n                    iecId\n                  }\n                  province{\n                    name\n                    country{\n                      event{\n                        description\n                      }\n                    }\n                  }\n                }\n              }\n            }\n        }\n        `\n      })\n    }\n  }\n  \n","import gql from \"graphql-tag\"\nimport {client} from \"./config\"\n\n\nexport function getVotesPredictionData(options) {\n    console.log(\"getVotesPredictionData\", options);\n    var eventType = (options.electionType == \"national\"? \"National Election\": \"Provincial Election\");\n\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          CSIRPrediction(eventType: \"${eventType}\", areaType:\"National\") {\n            turnout\n            timestamp\n            results{\n              edges{\n                node{\n                  percVds\n                  prediction{\n                    edges{\n                      node{\n                        party{\n                          name\n                          abbreviation\n                          iecId\n                        }\n                        actualPercent\n                        predictedPercent\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }`\n      })\n    } else { // regionType == \"province\"\n      return client.query({\n        query: gql`\n        {\n          CSIRPrediction(eventType: \"${eventType}\", areaType:\"Provincial\", province: \"${options.provinceName}\") {\n            turnout\n            timestamp\n            results{\n              edges{\n                node{\n                  percVds\n                  prediction{\n                    edges{\n                      node{\n                        party{\n                          name\n                          abbreviation\n                          iecId\n                        }\n                        actualPercent\n                        predictedPercent\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }`\n      })\n    }\n}\n\nexport function getVotesDataForComparison(options) {\n  if (options.regionType === \"national\") {\n    return client.query({\n      query: gql`\n      {\n        allBallots{\n          edges{\n            node{\n              event {\n                description\n              }\n              partyResults {\n                edges{\n                  node{\n                    percOfVotes\n                    party {\n                      name\n                      abbreviation\n                      iecId\n                    }\n                  }\n                }\n              }\n              location {\n                name\n              }\n            }\n          }\n        }\n      }\n      `\n    })\n  } else if (options.regionType === \"province\") {\n    return client.query({\n      query: gql`\n      {\n        allProvincialBallots(\n          province:\"${options.provinceName}\"\n        ){\n          edges{\n            node{\n              event {\n                description\n              }\n              partyResults {\n                edges{\n                  node{\n                    percOfVotes\n                    party {\n                      name\n                      abbreviation\n                      iecId\n                    }\n                  }\n                }\n              }\n              location {\n                name\n              }\n            }\n          }\n        }\n      }\n      `\n    })\n  } else if (options.regionType === \"municipality\") {\n    var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n\n    return client.query({\n      query: gql`\n      {\n        allMunicipalBallots(\n          province:\"${options.provinceName}\", \n          municipalCode: \"${muniCode}\"\n        ) {\n          edges{\n            node {\n              event {\n                description\n              }\n              partyResults {\n                edges{\n                  node{\n                    party {               \n                      name\n                      abbreviation\n                      iecId\n                    }\n                    validVotes\n                    percOfVotes\n                  }\n                }\n                \n              }\n              location {\n                code\n                name\n                longName\n              }\n            }\n          }\n        }\n      }\n      `\n    })\n  } else if (options.regionType === \"municipality-vd\") {\n    return client.query({\n      query: gql`\n      {\n        allVotingDistrictBallots(\n          iecId:\"${options.iecId}\", \n        ) {\n          edges{\n            node{\n              event {\n                description\n              }\n              location {\n                iecId\n              }\n              partyResults {\n                edges{\n                  node{\n                    party{\n                      name\n                    }\n                    percOfVotes\n                  }\n                }  \n              }\n            }\n          }\n        }\n      }\n      `\n    })\n  }\n}\n\nexport function getVotesDataForAllEvents(options) {\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allBallots{\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                  \n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            province:\"${options.provinceName}\"\n          ){\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality\") {\n      var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n  \n      return client.query({\n        query: gql`\n        {\n          allMunicipalBallots(\n            province:\"${options.provinceName}\", \n            municipalCode: \"${muniCode}\"\n          ) {\n            edges{\n              node {\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party {               \n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }\n                  \n                }\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality-vd\") {\n      return client.query({\n        query: gql`\n        {\n          allVotingDistrictBallots(\n            iecId:\"${options.iecId}\"\n          ) {\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                location {\n                  iecId\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party{\n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }  \n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    }\n  }\n\nexport function getVotesDataM(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n    return;\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allBallots(\n            event:\"${eventDescription}\"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                  \n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            event:\"${eventDescription}\",\n            province:\"${options.provinceName}\"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality\") {\n      var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n  \n      return client.query({\n        query: gql`\n        {\n          allMunicipalBallots(\n            event:\"${eventDescription}\",\n            province:\"${options.provinceName}\", \n            municipalCode: \"${muniCode}\"\n          ) {\n            edges{\n              node {\n                partyResults {\n                  edges{\n                    node{\n                      party {               \n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }\n                  \n                }\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality-vd\") {\n      return client.query({\n        query: gql`\n        {\n          allVotingDistrictBallots(\n            event:\"${eventDescription}\",\n            iecId:\"${options.iecId}\"\n          ) {\n            edges{\n              node{\n                location {\n                  iecId\n                  ward {\n                    municipality {\n                      code\n                      province {\n                        name\n                      }\n                    }\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party{\n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }  \n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    }\n  }\n\n  export function getMainParties(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n      return;\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          topPartiesByProvince(event:\"${eventDescription}\") {\n            edges {\n              node {\n                location{\n                  id\n                  name\n                }\n                totalVotesCast\n                topParty{\n                  validVotes\n                  percOfVotes\n                  party {\n                      id\n                      name\n                      abbreviation\n                      iecId\n                  }\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          topPartiesByMunicipality(\n            event:\"${eventDescription}\", \n            province:\"${options.provinceName}\") {\n            \n            edges {\n              node {\n                location{\n                    code\n                    name\n                    longName\n                }\n                totalVotesCast\n                topParty{\n                  party {               \n                    name\n                    abbreviation\n                    iecId\n                  }\n                  validVotes\n                  percOfVotes\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else { //if (options.regionType === \"municipality\") {\n        return client.query({\n          query: gql`\n          {\n            topPartiesByVotingDistrict(\n              event:\"${eventDescription}\", \n              province:\"${options.provinceName}\",\n              municipalCode: \"${options.muniCode}\"\n            ) {\n              \n              edges {\n                node {\n                  location{\n                    iecId\n                  }\n                  topParty{\n                    party{\n                      name\n                      abbreviation\n                      iecId\n                    }\n                  }\n                }\n              }\n            }\n          }\n          `\n        })\n    }\n  }\n  \n","import gql from \"graphql-tag\"\nimport {client} from \"./config\"\n\n\n\n  export function getTurnoutData(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n      return;\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            event:\"${eventDescription}\"\n          ){\n            edges{\n              node{\n                percVoterTurnout\n                vdCount\n                vdWithResultsCaptured\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allMunicipalBallots(\n            event:\"${eventDescription}\",\n            province:\"${options.provinceName}\"\n          ) {\n            edges{\n              node {\n                percVoterTurnout\n                vdCount\n                vdWithResultsCaptured\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else { // municipality or municipality-vd\n        return client.query({\n          query: gql`\n          {\n            allVotingDistrictBallots( \n              event:\"${eventDescription}\",\n              municipalCode:\"${options.muniCode}\"\n            ) {\n              edges{\n                node{\n                  location {\n                    iecId\n                  }\n                  percVoterTurnout\n                  vdCount\n                  vdWithResultsCaptured\n                }\n              }\n            }\n          }\n          `\n        })\n    }\n  }\n  \n  export function getTurnoutDataForOneEvent(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n      return;\n\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allBallots(\n            event:\"${eventDescription}\"\n          ) {\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            event:\"${eventDescription}\"\n            province:\"${options.provinceName}\"\n          ) {\n            edges{\n              node {\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality\") {\n        var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n\n        return client.query({\n          query: gql`\n          {\n            allMunicipalBallots( \n              event:\"${eventDescription}\"\n              province:\"${options.provinceName}\", \n              municipalCode: \"${muniCode}\"\n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          `\n        })\n    } else if (options.regionType === \"municipality-vd\") {\n        return client.query({\n          query: gql`\n          {\n            allVotingDistrictBallots(\n              event:\"${eventDescription}\"\n              iecId:\"${options.iecId}\"\n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          `\n        })\n      }\n  }\n\n  export function getTurnoutDataForAllEvents(options) {\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allBallots{\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            province:\"${options.provinceName}\"\n          ) {\n            edges{\n              node {\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality\") {\n        var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n\n        return client.query({\n          query: gql`\n          {\n            allMunicipalBallots( \n              province:\"${options.provinceName}\", \n              municipalCode: \"${muniCode}\"\n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          `\n        })\n    } else if (options.regionType === \"municipality-vd\") {\n        return client.query({\n          query: gql`\n          {\n            allVotingDistrictBallots(\n              iecId:\"${options.iecId}\" \n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          `\n        })\n      }\n  }","import gql from \"graphql-tag\"\nimport {client} from \"./config\"\n\n  export function getSpoiltData(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n      return;\n    if (options.regionType === \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allBallots(\n            event:\"${eventDescription}\"\n          ){\n            edges{\n              node{\n                spoiltVotes\n                totalVotesCast\n                totalValidVotes\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            event:\"${eventDescription}\",\n            province:\"${options.provinceName}\"\n          ) {\n            edges{\n              node {\n                spoiltVotes\n                totalVotesCast\n                totalValidVotes\n                location {\n                    id\n                    name\n                }\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType === \"municipality\") {\n        var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n\n        return client.query({\n          query: gql`\n          {\n            allMunicipalBallots( \n                event:\"${eventDescription}\",\n                province:\"${options.provinceName}\", \n                municipalCode: \"${muniCode}\"\n            ) {\n              edges{\n                node{\n                  location {\n                    code\n                    name\n                    longName\n                  }\n                  spoiltVotes\n                  totalVotesCast\n                  totalValidVotes\n                }\n              }\n            }\n          }\n          `\n        })\n    } else if (options.regionType === \"municipality-vd\") {\n        return client.query({\n          query: gql`\n          {\n            allVotingDistrictBallots(\n              event:\"${eventDescription}\",\n              iecId:\"${options.iecId}\"\n            ) {\n              edges{\n                node{\n                  location {\n                    iecId\n                  }\n                  spoiltVotes\n                  totalVotesCast\n                  totalValidVotes\n                }\n              }\n            }\n          }\n          `\n        })\n      }\n  }\n  ","import gql from \"graphql-tag\"\nimport {client} from \"./config\"\n\nexport function getProgressVotesCount(options) {\n    var eventDescription = options.eventDescription;\n    if (!eventDescription)\n    return;\n    if (options.regionType == \"national\") {\n      return client.query({\n        query: gql`\n        {\n          allBallots(\n            event:\"${eventDescription}\"\n          ){\n            edges{\n              node{\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType == \"province\") {\n      return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n            event:\"${eventDescription}\",\n            province:\"${options.provinceName}\"\n          ){\n            edges{\n              node{\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType == \"municipality\") {\n      var muniCode = options.muniCode || options.muniName.split(\" - \")[0];\n  \n      return client.query({\n        query: gql`\n        {\n          allMunicipalBallots(\n            event:\"${eventDescription}\",\n            province:\"${options.provinceName}\", \n            municipalCode: \"${muniCode}\"\n          ) {\n            edges{\n              node {\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        `\n      })\n    } else if (options.regionType == \"municipality-vd\") {\n      return client.query({\n        query: gql`\n        {\n          allVotingDistrictBallots(\n            event:\"${eventDescription}\",\n            iecId:\"${options.iecId}\"\n          ) {\n            edges{\n              node{\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        `\n      })\n    }\n  }","import gql from \"graphql-tag\"\nimport {client} from \"./config\"\n\nexport {getSeatsData, getSeatsDataForComparison} from \"./race-for-seats\"\nexport {getVotesPredictionData, getVotesDataM, getVotesDataForAllEvents, getVotesDataForComparison, getMainParties} from \"./race-for-votes\"\nexport {getTurnoutData, getTurnoutDataForOneEvent, getTurnoutDataForAllEvents} from \"./turnout\"\nexport {getSpoiltData} from \"./spoilt\"\nexport {getProgressVotesCount} from \"./prog-votescount\"\n\nexport function getElectionEvents() {\n  return client.query({\n    query: gql`\n    {\n      allEvents {\n        description\n        eventType {\n          description\n        }\n      }\n    }\n    `\n  })\n}\n\nexport function getPartyColors() {\n  return client.query({\n    query: gql`\n    {\n      allParties {\n        edges{\n          node{\n            name\n            abbreviation\n            colour\n            iecId\n          }\n        }\n      }\n    }\n    `\n  })\n}\n\nexport function getProvincesData() {\n  var provincesData = [\n      {\n          \"name\": \"Limpopo\",\n          \"abbreviation\": \"LIM\",\n          \"munis\": [{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM331 - Greater Giyani [Giyani]\",\"muniCode\":\"LIM331\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM332 - Greater Letaba [Duiwelskloof]\",\"muniCode\":\"LIM332\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM333 - Greater Tzaneen [Tzaneen]\",\"muniCode\":\"LIM333\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM334 - Ba-Phalaborwa [Phalaborwa]\",\"muniCode\":\"LIM334\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM335 - Maruleng [Hoedspruit]\",\"muniCode\":\"LIM335\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM341 - Musina [Messina]\",\"muniCode\":\"LIM341\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM342 - Mutale [Mutale-Masisi]\",\"muniCode\":\"LIM342\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM343 - Thulamela [Thohoyandou]\",\"muniCode\":\"LIM343\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM344 - Makhado [Louis Trichardt]\",\"muniCode\":\"LIM344\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM351 - Blouberg [Bochum/My Darling]\",\"muniCode\":\"LIM351\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM352 - Aganang [Moletji/Matlala]\",\"muniCode\":\"LIM352\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM353 - Molemole [Dendron/Dikgale]\",\"muniCode\":\"LIM353\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM354 - Polokwane [Pietersburg]\",\"muniCode\":\"LIM354\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM355 - Lepele-Nkumpi [Lebowakgomo]\",\"muniCode\":\"LIM355\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM361 - Thabazimbi [Thabazimbi]\",\"muniCode\":\"LIM361\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM362 - Lephalale [Ellisras]\",\"muniCode\":\"LIM362\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM364 - Mookgopong [Naboomspruit]\",\"muniCode\":\"LIM364\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM365 - Modimolle [Nylstroom]\",\"muniCode\":\"LIM365\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM366 - Bela-Bela [Warmbad]\",\"muniCode\":\"LIM366\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM367 - Mogalakwena [Potgietersrus]\",\"muniCode\":\"LIM367\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM471 - Ephraim Mogale [Marble Hall]\",\"muniCode\":\"LIM471\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM472 - Elias Motsoaledi [Groblersdal]\",\"muniCode\":\"LIM472\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM473 - Makhuduthamaga [Ngwaritsi]\",\"muniCode\":\"LIM473\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM474 - Fetakgomo [Fetakgomo ]\",\"muniCode\":\"LIM474\"},{\"provinceName\":\"Limpopo\",\"muniName\":\"LIM475 - Greater Tubatse [Burgersfort/Ohrigstad/Eastern Tubatse]\",\"muniCode\":\"LIM475\"}]\n      },\n      {\n          \"name\": \"Mpumalanga\",\n          \"abbreviation\": \"MP\",\n          \"munis\": [{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP301 - Albert Luthuli [Elukwatini/Carolina]\",\"muniCode\":\"MP301\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP302 - Msukaligwa [Ermelo]\",\"muniCode\":\"MP302\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP303 - Mkhondo [Piet Retief]\",\"muniCode\":\"MP303\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP304 - Pixley Ka Seme [Volksrust]\",\"muniCode\":\"MP304\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP305 - Lekwa [Standerton]\",\"muniCode\":\"MP305\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP306 - Dipaleseng [Balfour]\",\"muniCode\":\"MP306\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP307 - Govan Mbeki [Highveld Ridge]\",\"muniCode\":\"MP307\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP311 - Delmas [Delmas]\",\"muniCode\":\"MP311\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP312 - Emalahleni [Witbank]\",\"muniCode\":\"MP312\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP313 - Steve Tshwete [Middelburg]\",\"muniCode\":\"MP313\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP314 - Emakhazeni [Belfast]\",\"muniCode\":\"MP314\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP315 - Thembisile [KwaMhlanga]\",\"muniCode\":\"MP315\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP316 - Dr JS Moroka [Mdutjana]\",\"muniCode\":\"MP316\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP321 - Thaba Chweu [Sabie]\",\"muniCode\":\"MP321\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP322 - Mbombela [Nelspruit]\",\"muniCode\":\"MP322\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP323 - Umjindi [Barberton]\",\"muniCode\":\"MP323\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP324 - Nkomazi [Nkomazi]\",\"muniCode\":\"MP324\"},{\"provinceName\":\"Mpumalanga\",\"muniName\":\"MP325 - Bushbuckridge [Bushbuckridge]\",\"muniCode\":\"MP325\"}]\n      },\n      {\n          \"name\": \"Gauteng\",\n          \"abbreviation\": \"GT\",\n          \"munis\": [{\"provinceName\":\"Gauteng\",\"muniName\":\"EKU - Ekurhuleni [East Rand]\",\"muniCode\":\"EKU\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT421 - Emfuleni [Vereeniging]\",\"muniCode\":\"GT421\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT422 - Midvaal [Meyerton]\",\"muniCode\":\"GT422\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT423 - Lesedi [Heidelberg]\",\"muniCode\":\"GT423\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT481 - Mogale City [Krugersdorp]\",\"muniCode\":\"GT481\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT482 - Randfontein [Randfontein]\",\"muniCode\":\"GT482\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT483 - Westonaria [Westonaria]\",\"muniCode\":\"GT483\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"GT484 - Merafong City [Carletonville]\",\"muniCode\":\"GT484\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"JHB - City of Johannesburg [Johannesburg]\",\"muniCode\":\"JHB\"},{\"provinceName\":\"Gauteng\",\"muniName\":\"TSH - Tshwane Metro [Pretoria]\",\"muniCode\":\"TSH\"}]\n      },\n      {\n          \"name\": \"KwaZulu-Natal\",\n          \"abbreviation\": \"KZN\",\n          \"munis\": [{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"ETH - eThekwini [Durban Metro]\",\"muniCode\":\"ETH\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN211 - Vulamehlo [Dududu]\",\"muniCode\":\"KZN211\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN212 - Umdoni [Scottburgh]\",\"muniCode\":\"KZN212\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN213 - Umzumbe [Umzumbe]\",\"muniCode\":\"KZN213\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN214 - UMuziwabantu [Harding]\",\"muniCode\":\"KZN214\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN215 - Ezinqoleni [Izinqolweni]\",\"muniCode\":\"KZN215\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN216 - Hibiscus Coast [Port Shepstone]\",\"muniCode\":\"KZN216\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN221 - uMshwathi [Wartburg]\",\"muniCode\":\"KZN221\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN222 - uMngeni [Howick]\",\"muniCode\":\"KZN222\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN223 - Mooi Mpofana [Mooirivier]\",\"muniCode\":\"KZN223\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN224 - Impendle [Impendle]\",\"muniCode\":\"KZN224\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN225 - Msunduzi [Pietermaritzburg]\",\"muniCode\":\"KZN225\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN226 - Mkhambathini [Camperdown]\",\"muniCode\":\"KZN226\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN227 - Richmond [Richmond]\",\"muniCode\":\"KZN227\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN232 - Emnambithi/Ladysmith [Ladysmith]\",\"muniCode\":\"KZN232\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN233 - Indaka [Waaihoek]\",\"muniCode\":\"KZN233\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN234 - Umtshezi [Estcourt]\",\"muniCode\":\"KZN234\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN235 - Okhahlamba [Bergville]\",\"muniCode\":\"KZN235\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN236 - Imbabazane [Loskop]\",\"muniCode\":\"KZN236\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN241 - Endumeni [Dundee]\",\"muniCode\":\"KZN241\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN242 - Nqutu [Nqutu]\",\"muniCode\":\"KZN242\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN244 - Msinga [Pomeroy]\",\"muniCode\":\"KZN244\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN245 - Umvoti [Greytown]\",\"muniCode\":\"KZN245\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN252 - Newcastle [Newcastle]\",\"muniCode\":\"KZN252\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN253 - eMadlangeni [Utrecht]\",\"muniCode\":\"KZN253\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN254 - Dannhauser [Durnacol]\",\"muniCode\":\"KZN254\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN261 - eDumbe [Paulpietersburg]\",\"muniCode\":\"KZN261\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN262 - UPhongolo [Pongola]\",\"muniCode\":\"KZN262\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN263 - Abaqulusi [Vryheid]\",\"muniCode\":\"KZN263\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN265 - Nongoma [Nongoma]\",\"muniCode\":\"KZN265\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN266 - Ulundi [Ulundi]\",\"muniCode\":\"KZN266\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN271 - Umhlabuyalingana [Emangusi]\",\"muniCode\":\"KZN271\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN272 - Jozini [Mkuze]\",\"muniCode\":\"KZN272\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN273 - The Big 5 False Bay [Hluhluwe]\",\"muniCode\":\"KZN273\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN274 - Hlabisa [Somkele]\",\"muniCode\":\"KZN274\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN275 - Mtubatuba [Mtubatuba]\",\"muniCode\":\"KZN275\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN281 - Mfolozi [KwaMbonambi]\",\"muniCode\":\"KZN281\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN282 - uMhlathuze [Richards Bay]\",\"muniCode\":\"KZN282\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN283 - Ntambana [Ntambana]\",\"muniCode\":\"KZN283\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN284 - uMlalazi [Eshowe]\",\"muniCode\":\"KZN284\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN285 - Mthonjaneni [Melmoth]\",\"muniCode\":\"KZN285\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN286 - Nkandla [Nkandla]\",\"muniCode\":\"KZN286\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN291 - Mandeni [Mandeni]\",\"muniCode\":\"KZN291\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN292 - KwaDukuza [Stanger]\",\"muniCode\":\"KZN292\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN293 - Ndwedwe [Ndwedwe]\",\"muniCode\":\"KZN293\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN294 - Maphumulo [Maphumulo]\",\"muniCode\":\"KZN294\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN431 - Ingwe [Creighton]\",\"muniCode\":\"KZN431\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN432 - Kwa Sani [Underberg]\",\"muniCode\":\"KZN432\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN433 - Greater Kokstad [Kokstad]\",\"muniCode\":\"KZN433\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN434 - Ubuhlebezwe [Ixopo]\",\"muniCode\":\"KZN434\"},{\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"KZN435 - Umzimkhulu [Umzimkulu]\",\"muniCode\":\"KZN435\"}]\n      },\n      {\n          \"name\": \"North West\",\n          \"abbreviation\": \"NW\",\n          \"munis\": [{\"provinceName\":\"North West\",\"muniName\":\"NW371 - Moretele [Makapanstad]\",\"muniCode\":\"NW371\"},{\"provinceName\":\"North West\",\"muniName\":\"NW372 - Madibeng [Brits]\",\"muniCode\":\"NW372\"},{\"provinceName\":\"North West\",\"muniName\":\"NW373 - Rustenburg [Rustenburg]\",\"muniCode\":\"NW373\"},{\"provinceName\":\"North West\",\"muniName\":\"NW374 - Kgetlengrivier [Koster]\",\"muniCode\":\"NW374\"},{\"provinceName\":\"North West\",\"muniName\":\"NW375 - Moses Kotane [Mogwase]\",\"muniCode\":\"NW375\"},{\"provinceName\":\"North West\",\"muniName\":\"NW381 - Ratlou [Setlagole]\",\"muniCode\":\"NW381\"},{\"provinceName\":\"North West\",\"muniName\":\"NW382 - Tswaing [Delareyville]\",\"muniCode\":\"NW382\"},{\"provinceName\":\"North West\",\"muniName\":\"NW383 - Mafikeng [Mafikeng]\",\"muniCode\":\"NW383\"},{\"provinceName\":\"North West\",\"muniName\":\"NW384 - Ditsobotla [Lichtenburg]\",\"muniCode\":\"NW384\"},{\"provinceName\":\"North West\",\"muniName\":\"NW385 - Ramotshere Moiloa [Zeerust]\",\"muniCode\":\"NW385\"},{\"provinceName\":\"North West\",\"muniName\":\"NW392 - Naledi [Vryburg]\",\"muniCode\":\"NW392\"},{\"provinceName\":\"North West\",\"muniName\":\"NW393 - Mamusa [Schweizer-Reneke]\",\"muniCode\":\"NW393\"},{\"provinceName\":\"North West\",\"muniName\":\"NW394 - Greater Taung [Reivilo]\",\"muniCode\":\"NW394\"},{\"provinceName\":\"North West\",\"muniName\":\"NW396 - Lekwa-Teemane [Christiana]\",\"muniCode\":\"NW396\"},{\"provinceName\":\"North West\",\"muniName\":\"NW397 - NW397 Local Municipality [Ganyesa/Pomfret]\",\"muniCode\":\"NW397\"},{\"provinceName\":\"North West\",\"muniName\":\"NW401 - Ventersdorp [Ventersdorp]\",\"muniCode\":\"NW401\"},{\"provinceName\":\"North West\",\"muniName\":\"NW402 - Tlokwe [Potchefstroom]\",\"muniCode\":\"NW402\"},{\"provinceName\":\"North West\",\"muniName\":\"NW403 - Matlosana [Klerksdorp]\",\"muniCode\":\"NW403\"},{\"provinceName\":\"North West\",\"muniName\":\"NW404 - Maquassi Hills [Wolmaransstad]\",\"muniCode\":\"NW404\"}]\n      },\n      {\n          \"name\": \"Free State\",\n          \"abbreviation\": \"FS\",\n          \"munis\": [{\"provinceName\":\"Free State\",\"muniName\":\"FS161 - Letsemeng [Koffiefontein]\",\"muniCode\":\"FS161\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS162 - Kopanong [Trompsburg]\",\"muniCode\":\"FS162\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS163 - Mohokare [Zastron]\",\"muniCode\":\"FS163\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS164 - Naledi [Dewetsdorp]\",\"muniCode\":\"FS164\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS181 - Masilonyana [Theunissen]\",\"muniCode\":\"FS181\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS182 - Tokologo [Dealesville]\",\"muniCode\":\"FS182\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS183 - Tswelopele [Hoopstad]\",\"muniCode\":\"FS183\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS184 - Matjhabeng [Welkom]\",\"muniCode\":\"FS184\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS185 - Nala [Bothaville]\",\"muniCode\":\"FS185\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS191 - Setsoto [Senekal]\",\"muniCode\":\"FS191\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS192 - Dihlabeng [Bethlehem]\",\"muniCode\":\"FS192\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS193 - Nketoana [Reitz]\",\"muniCode\":\"FS193\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS194 - Maluti a Phofung [Qwa-Qwa]\",\"muniCode\":\"FS194\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS195 - Phumelela [Vrede]\",\"muniCode\":\"FS195\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS196 - Mantsopa [Ladybrand]\",\"muniCode\":\"FS196\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS201 - Moqhaka [Kroonstad]\",\"muniCode\":\"FS201\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS203 - Ngwathe [Parys]\",\"muniCode\":\"FS203\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS204 - Metsimaholo [Sasolburg]\",\"muniCode\":\"FS204\"},{\"provinceName\":\"Free State\",\"muniName\":\"FS205 - Mafube [Frankfort]\",\"muniCode\":\"FS205\"},{\"provinceName\":\"Free State\",\"muniName\":\"MAN - Mangaung [Bloemfontein]\",\"muniCode\":\"MAN\"}]\n      },\n      {\n          \"name\": \"Eastern Cape\",\n          \"abbreviation\": \"EC\",\n          \"munis\": [{\"provinceName\":\"Eastern Cape\",\"muniName\":\"BUF - Buffalo City [East London]\",\"muniCode\":\"BUF\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC101 - Camdeboo [Graaff-Reinet]\",\"muniCode\":\"EC101\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC102 - Blue Crane Route [Somerset East]\",\"muniCode\":\"EC102\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC103 - Ikwezi [Jansenville]\",\"muniCode\":\"EC103\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC104 - Makana [Grahamstown]\",\"muniCode\":\"EC104\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC105 - Ndlambe [Port Alfred]\",\"muniCode\":\"EC105\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC106 - Sundays River Valley [Kirkwood]\",\"muniCode\":\"EC106\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC107 - Baviaans [Willowmore]\",\"muniCode\":\"EC107\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC108 - Kouga [Humansdorp]\",\"muniCode\":\"EC108\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC109 - Kou-Kamma [Kareedouw]\",\"muniCode\":\"EC109\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC121 - Mbhashe [Idutywa]\",\"muniCode\":\"EC121\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC122 - Mnquma [Butterworth]\",\"muniCode\":\"EC122\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC123 - Great Kei [Komga]\",\"muniCode\":\"EC123\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC124 - Amahlathi [Stutterheim]\",\"muniCode\":\"EC124\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC126 - Ngqushwa [Peddie]\",\"muniCode\":\"EC126\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC127 - Nkonkobe [Alice]\",\"muniCode\":\"EC127\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC128 - Nxuba [Adelaide]\",\"muniCode\":\"EC128\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC131 - Inxuba Yethemba [Cradock]\",\"muniCode\":\"EC131\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC132 - Tsolwana [Tarkastad]\",\"muniCode\":\"EC132\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC133 - Inkwanca [Molteno]\",\"muniCode\":\"EC133\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC134 - Lukhanji [Queenstown]\",\"muniCode\":\"EC134\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC135 - Intsika Yethu [Cofimvaba]\",\"muniCode\":\"EC135\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC136 - Emalahleni [Lady Frere]\",\"muniCode\":\"EC136\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC137 - Engcobo [Engcobo]\",\"muniCode\":\"EC137\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC138 - Sakhisizwe [Elliot]\",\"muniCode\":\"EC138\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC141 - Elundini [Mount Fletcher]\",\"muniCode\":\"EC141\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC142 - Senqu [Lady Grey]\",\"muniCode\":\"EC142\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC143 - Maletswai [Aliwal North]\",\"muniCode\":\"EC143\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC144 - Gariep [Burgersdorp]\",\"muniCode\":\"EC144\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC153 - Ngquza Hill [Flagstaff]\",\"muniCode\":\"EC153\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC154 - Port St Johns [Port St Johns]\",\"muniCode\":\"EC154\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC155 - Nyandeni [Libode]\",\"muniCode\":\"EC155\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC156 - Mhlontlo [Qumbu]\",\"muniCode\":\"EC156\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC157 - King Sabata Dalindyebo [Umtata]\",\"muniCode\":\"EC157\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC441 - Matatiele [Matatiele]\",\"muniCode\":\"EC441\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC442 - Umzimvubu [Mount Ayliff]\",\"muniCode\":\"EC442\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC443 - Mbizana [Bizana]\",\"muniCode\":\"EC443\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"EC444 - Ntabankulu [Ntabankulu]\",\"muniCode\":\"EC444\"},{\"provinceName\":\"Eastern Cape\",\"muniName\":\"NMA - Nelson Mandela Bay [Port Elizabeth]\",\"muniCode\":\"NMA\"}]\n      },\n      {\n          \"name\": \"Northern Cape\",\n          \"abbreviation\": \"NC\",\n          \"munis\": [{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC061 - RICHTERSVELD [Port Nolloth]\",\"muniCode\":\"NC061\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC062 - NAMA KHOI [Springbok]\",\"muniCode\":\"NC062\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC064 - KAMIESBERG [Garies]\",\"muniCode\":\"NC064\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC065 - HANTAM [Calvinia]\",\"muniCode\":\"NC065\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC066 - KAROO HOOGLAND [Fraserburg]\",\"muniCode\":\"NC066\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC067 - KHI-MA [Pofadder]\",\"muniCode\":\"NC067\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC071 - UBUNTU [Victoria West]\",\"muniCode\":\"NC071\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC072 - UMSOBOMVU [Colesberg]\",\"muniCode\":\"NC072\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC073 - EMTHANJENI [De Aar]\",\"muniCode\":\"NC073\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC074 - KAREEBERG [Carnarvon]\",\"muniCode\":\"NC074\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC075 - RENOSTERBERG [Phillipstown]\",\"muniCode\":\"NC075\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC076 - THEMBELIHLE [Hopetown]\",\"muniCode\":\"NC076\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC077 - SIYATHEMBA [Prieska]\",\"muniCode\":\"NC077\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC078 - SIYANCUMA [Griekwastad]\",\"muniCode\":\"NC078\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC081 - MIER [Mier]\",\"muniCode\":\"NC081\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC082 - KAI !GARIB [Keimoes]\",\"muniCode\":\"NC082\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC083 - KHARA HAIS [Upington]\",\"muniCode\":\"NC083\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC084 - !KHEIS [Groblershoop]\",\"muniCode\":\"NC084\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC085 - TSANTSABANE [Postmasburg]\",\"muniCode\":\"NC085\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC086 - KGATELOPELE [Danielskuil]\",\"muniCode\":\"NC086\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC091 - Sol Plaatje [Kimberley]\",\"muniCode\":\"NC091\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC092 - Dikgatlong [Barkley West]\",\"muniCode\":\"NC092\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC093 - Magareng [Warrenton]\",\"muniCode\":\"NC093\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC094 - Phokwane [Hartswater]\",\"muniCode\":\"NC094\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC451 - Joe Morolong [Kgalagadi]\",\"muniCode\":\"NC451\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC452 - GA-SEGONYANA [Kuruman]\",\"muniCode\":\"NC452\"},{\"provinceName\":\"Northern Cape\",\"muniName\":\"NC453 - GAMAGARA [Kathu]\",\"muniCode\":\"NC453\"}]\n      },\n      {\n          \"name\": \"Western Cape\",\n          \"abbreviation\": \"WC\",\n          \"munis\": [{\"provinceName\":\"Western Cape\",\"muniName\":\"CPT - City of Cape Town [Cape Town]\",\"muniCode\":\"CPT\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC011 - Matzikama [Vredendal]\",\"muniCode\":\"WC011\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC012 - Cederberg [Citrusdal]\",\"muniCode\":\"WC012\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC013 - Bergrivier [Velddrif]\",\"muniCode\":\"WC013\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC014 - Saldanha Bay [West Coast Peninsula]\",\"muniCode\":\"WC014\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC015 - Swartland [Malmesbury]\",\"muniCode\":\"WC015\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC022 - Witzenberg [Ceres]\",\"muniCode\":\"WC022\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC023 - Drakenstein [Paarl]\",\"muniCode\":\"WC023\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC024 - Stellenbosch [Stellenbosch]\",\"muniCode\":\"WC024\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC025 - Breede Valley [Worcester]\",\"muniCode\":\"WC025\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC026 - Langeberg [Robertson]\",\"muniCode\":\"WC026\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC031 - Theewaterskloof [Caledon]\",\"muniCode\":\"WC031\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC032 - Overstrand [Greater Hermanus]\",\"muniCode\":\"WC032\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC033 - Cape Agulhas [Bredasdorp]\",\"muniCode\":\"WC033\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC034 - Swellendam [Barrydale/Swellendam ]\",\"muniCode\":\"WC034\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC041 - Kannaland [Ladismith]\",\"muniCode\":\"WC041\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC042 - Hessequa [Heidelberg/Riversdale]\",\"muniCode\":\"WC042\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC043 - Mossel Bay [Mossel Bay]\",\"muniCode\":\"WC043\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC044 - George [George]\",\"muniCode\":\"WC044\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC045 - Oudtshoorn [Oudtshoorn]\",\"muniCode\":\"WC045\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC047 - Bitou [Greater Plettenberg Bay]\",\"muniCode\":\"WC047\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC048 - Knysna [Knysna]\",\"muniCode\":\"WC048\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC051 - Laingsburg [Laingsburg]\",\"muniCode\":\"WC051\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC052 - Prince Albert [Prins Albert]\",\"muniCode\":\"WC052\"},{\"provinceName\":\"Western Cape\",\"muniName\":\"WC053 - Beaufort West [Beaufort West]\",\"muniCode\":\"WC053\"}]\n      }\n  ]\n  provincesData.sort(function(a, b) {\n    return ('' + a.name).localeCompare(b.name);\n  })\n  return provincesData;\n}\n\nexport function getMetrosData() {\n  var metrosData = [\n    {\"provinceName\":\"Eastern Cape\",\"muniName\":\"BUF - Buffalo City [East London]\",\"muniCode\":\"BUF\"},\n    {\"provinceName\":\"Western Cape\",\"muniName\":\"CPT - City of Cape Town [Cape Town]\",\"muniCode\":\"CPT\"},\n    {\"provinceName\":\"Gauteng\",\"muniName\":\"JHB - City of Johannesburg [Johannesburg]\",\"muniCode\":\"JHB\"},\n    {\"provinceName\":\"Gauteng\",\"muniName\":\"TSH - Tshwane Metro [Pretoria]\",\"muniCode\":\"TSH\"},\n    {\"provinceName\":\"Gauteng\",\"muniName\":\"EKU - Ekurhuleni [East Rand]\",\"muniCode\":\"EKU\"},\n    {\"provinceName\":\"KwaZulu-Natal\",\"muniName\":\"ETH - eThekwini [Durban Metro]\",\"muniCode\":\"ETH\"},\n    {\"provinceName\":\"Free State\",\"muniName\":\"MAN - Mangaung [Bloemfontein]\",\"muniCode\":\"MAN\"},\n    {\"provinceName\":\"Eastern Cape\",\"muniName\":\"NMA - Nelson Mandela Bay [Port Elizabeth]\",\"muniCode\":\"NMA\"}\n  ]\n  return metrosData;\n}","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../BarChart/d3barchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getVotesDataM,\n  getPartyColors\n} from \"../../api\";\nimport {\n  parseVotesData,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange,\n  triggerCustomEvent,\n  fetchLocationTrackFromVDdata\n} from \"../../utils\";\n\nvar dataRefreshTime = 30 * 1000;\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nvar chartOptions = {\n  chartType: \"Race For Votes\",\n  yAxisLabel: \"PERCENTAGE VOTES\",\n  dynamicYAxisFromValues: true,\n  customizeDynamicMaxValue: (maxVal) => Math.min(100, maxVal * 1.5),\n  yValue: d => d.percOfVotes,\n  yValueFormat: value => value + '%',\n}\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        comp: \"votes-default\",\n        numParties: 5,\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 1\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      if (this.chart) {\n        this.chart.destroy();\n        this.chart = null;\n      }\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID !== this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-votes-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n        console.log(d3);\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n\n      return (\n          <div className={cn(\"barchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n              componentID !== -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var votesDataLoader = getVotesDataM(props);\n      var dataLoaders = [votesDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var votesData = values[0];\n        partyColorsData = partyColorsData || values[1];          \n        self.drawGraph(container, props, votesData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseVotesData(data, props);\n\n        if (props.comp === \"votes-myvd\") {\n          var newState;\n          if (chartData) {\n            newState = fetchLocationTrackFromVDdata(data);\n          } else {\n            newState = {iecId: \"\"}\n          }\n          var needUpdate = false;\n          Object.keys(newState).forEach(key => {\n            if (props[key] !== newState[key]) {\n              needUpdate = true;\n            }\n          })\n          if (needUpdate) {\n            triggerCustomEvent(events.REGION_CHANGE, newState);\n          }\n        }\n       \n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../BarChart/d3barchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getSeatsData,\n  getPartyColors\n} from \"../../api\";\nimport {\n  parseSeatsData,\n  getNationOrProvinceName2,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Race For Seats',\n  yAxisLabel: 'Seats Count',\n  dynamicYAxisFromValues: true,\n  yValue: function(d) {\n    return d.seats;\n  },\n  yValueFormat: function(seats) {\n    return seats;\n  } \n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        numParties: 5,\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 6\n      }\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-barchart(${getNationOrProvinceName2(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n        \n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={cn(\"barchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n                componentID != -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName2(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var seatsDataLoader = getSeatsData(props);\n      var dataLoaders = [seatsDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var seatsData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, seatsData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseSeatsData(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../BarChart/d3barchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getSpoiltData\n} from \"../../api\";\nimport {\n  parseSpoiltVotesData,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Spoilt vs Valid Votes',\n  yAxisLabel: 'PERCENTAGE VOTES',\n  noXaxisByParty: true,\n  yValue: d => d.percent,\n  yValueFormat: value => value + '%'\n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      var self = this;\n      this.state = {\n        numParties: 5,\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 9\n      }\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID !== this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `spoilt-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={cn(\"barchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n                componentID !== -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var spoiltDataLoader = getSpoiltData(props);\n      var dataLoaders = [spoiltDataLoader];\n\n      Promise.all(dataLoaders).then(function(values){ \n        var spoiltData = values[0];\n        self.drawGraph(container, props, spoiltData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data) {\n        var chartData = parseSpoiltVotesData(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, {\n          \"Valid\": \"rgb(0,255,0)\",\n          \"Spoilt\": \"rgb(255,0,0)\"\n        });\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson-client\";\nimport config from \"../../config\";\nimport polylabel from \"polylabel\";\nimport styles from \"../Map/map.css\";\nimport events from \"../../events\";\nimport ReactLoading from \"react-loading\";\nimport {\n    getMainParties,\n    getPartyColors,\n} from \"../../api\";\nimport {\n  parseMainPartyData,\n  getRegionName,\n  getSubRegionName,\n  createTooltip,\n  getMunicipalityCode,\n  fixMapLabelIntersect,\n  triggerCustomEvent,\n  getMunicipalityiecId,\n  getRegionFileName,\n  fetchDataFromOBJ,\n  getYear\n} from \"../../utils\";\n\nvar dataRefreshTime = 30 * 1000;\n\nvar regionColor = \"#9c9c9c\";\nvar regionBorderColor = \"#eeeeee\";\nvar partyColorsData;\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nclass Map extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            eventDescription: \"2019 National Election\",\n            regionType: \"national\",\n            provinceName: \"\",\n            muniName: \"\",\n            muniCode: \"\",\n            iecId: \"\",\n            disableNavigation: false,\n            stylesheetFor: \"web\",\n            componentID: 3\n        }\n\n        fetchDataFromOBJ(this.state, props);\n\n        this.refreshIntervalID = 0;\n        this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n        this.exportAsPNG = this.exportAsPNG.bind(this);\n        this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n\n    draw(container, props) {\n        this.drawGraph(container, props);\n    }\n\n    componentDidMount() {\n        var self = this;\n        this.draw(this.getContainer(), this.state);\n        this.refreshIntervalID = setInterval(() => {\n          self.draw(self.getContainer(), self.state)\n        }, dataRefreshTime);\n\n        document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n        document.addEventListener(events.MAP_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentWillUnmount() {\n      this.getContainer().selectAll(\"svg\").remove();\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.MAP_PREVIEW, this.handlePreviewEvent);\n    }\n\n    // componentWillReceiveProps(newProps) {\n    //     var newState = JSON.parse(JSON.stringify(this.state));\n    //     fetchDataFromOBJ(newState, newProps);\n    //     this.setState(newState);\n    // }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (JSON.stringify(prevState) !== JSON.stringify(this.state))\n            this.draw(this.getContainer(), this.state)\n    }\n\n    exportAsPNGUri() {\n        var self = this;\n        return new Promise(function(resolve, reject) {\n            var rect = {width: 950, height: 890};\n            var rendercanvas = document.createElement('canvas');\n            rendercanvas.setAttribute(\"width\", rect.width);\n            rendercanvas.setAttribute(\"height\", rect.height);\n\n            window.canvg(rendercanvas, self.refs.vizcontainer.innerHTML, {\n                ignoreDimensions: true,\n                scaleWidth: rect.width,\n                scaleHeight: rect.height\n            });\n            resolve(rendercanvas.toDataURL(\"image/png;base64\").split(',')[1])\n        });\n    }\n\n    exportAsPNG(event) {\n        var targetState = event.detail;\n        if (targetState.componentID !== this.state.componentID)\n          return;\n        var rect = {width: 950, height: 890};\n        var rendercanvas = document.createElement('canvas');\n        rendercanvas.setAttribute(\"width\", rect.width);\n        rendercanvas.setAttribute(\"height\", rect.height);\n\n        if (!window.canvg) {\n            return console.error(\"canvg module not available\");\n        }\n        window.canvg(rendercanvas, this.refs.vizcontainer.innerHTML, {\n            ignoreDimensions: true,\n            scaleWidth: rect.width,\n            scaleHeight: rect.height\n        });\n\n\n        var canvas = rendercanvas, filename = `race-for-votes-map(${getRegionName(this.state)}).png`;\n        var lnk = document.createElement(\"a\"), e;\n\n        lnk.download = filename;\n        lnk.href = canvas.toDataURL(\"image/png;base64\");\n\n        if (document.createEvent) {\n            e = document.createEvent(\"MouseEvents\");\n            e.initMouseEvent(\"click\", true, true, window,\n                            0, 0, 0, 0, 0, false, false, false,\n                            false, 0, null);\n            lnk.dispatchEvent(e);\n        } else if (lnk.fireEvent) {\n            lnk.fireEvent(\"onclick\");\n        }\n    }\n\n    handlePreviewEvent(event) {\n        if (!this.state.disableNavigation) {\n            var newState = event.detail;\n            this.setState(newState)\n        }\n    }\n\n    getContainer() {\n        return d3.select(this.refs.vizcontainer)\n    }\n\n    getLoadingSpinner() {\n        return d3.select(this.refs.loading)\n    }\n      \n    render () {\n        var {\n            stylesheetFor,\n            componentID\n        } = this.state;\n        return (\n            <div className={className(\"map-widget\")+\" \"+cn(`stylesheet-${stylesheetFor}`)}>\n                {\n                    componentID !== -1000 && <div className={cn(\"map-title\")}>{getRegionName(this.state)}</div>\n                }\n\n                <div ref=\"vizcontainer\" className={className(\"map\")}></div>\n                <div className={cn(\"loading-spinner\")} ref=\"loading\">\n                    <ReactLoading type={\"spin\"} color={\"#777\"} height={100} width={100} />\n                </div>\n            </div>\n        )\n    }\n\n    drawGraph(container, props) {\n        var self = this;\n\n        var fullRouteGeoJsonFile = config.DOMAIN + \"/mapdata/\" + getRegionFileName(self.state);\n\n        self.getLoadingSpinner()\n            .style(\"display\", \"block\")\n            .transition()\n            .duration(200)\n            .style(\"opacity\", 1);\n\n        var tooltipDiv = createTooltip(className);\n\n        var w = 900;\n        var h = 800;\n        var bottomMargin = 90;// for legend\n        var rightMargin = 50;\n\n        container.selectAll(\"svg\").remove();\n        var svg = container.append(\"svg\")\n            .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n            .attr(\"viewBox\", \"0 0 \" + (w+rightMargin) + \" \" + (h+bottomMargin))\n            .classed(\"svg-content\", true);\n\n        var geoJsonLoader = d3.json(fullRouteGeoJsonFile);\n        var mainPartiesDataLoader = getMainParties(props);\n        // var dataLoaders = [geoJsonLoader, mainPartiesDataLoader];\n        var dataLoaders = [mainPartiesDataLoader];\n\n        if (!partyColorsData) {\n          var partyColorsLoader = getPartyColors();\n          dataLoaders.push(partyColorsLoader);\n        }\n\n        geoJsonLoader.then(function(value) {\n            var geoJsonData = value;\n            Promise.all(dataLoaders).then(function(values){ \n                var locationToMainParty = parseMainPartyData(values[0], props);\n                partyColorsData = partyColorsData || values[1];  \n    \n                var partyColorByName = {};\n                var partyAbbrByName = {};\n                if (partyColorsData && partyColorsData[\"data\"][\"allParties\"][\"edges\"]) {\n                  partyColorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n                    partyColorByName[edge.node.name] = edge.node.colour;\n                    partyAbbrByName[edge.node.name] = edge.node.abbreviation;\n                  })\n                }            \n    \n                function getFillColorFromPartyName(partyName) {\n                  if (!partyName)\n                    return regionColor;\n                  return partyColorByName[partyName.split(\"/\")[0]] || regionColor;\n                }\n    \n                function getMainPartyName(d, i) {\n                    var partyName;\n                    var regionType = self.state.regionType;\n                    if (regionType === \"national\") {\n                        var provinceName = d.properties.SPROVINCE;\n                        partyName = locationToMainParty[provinceName];\n                    } else if (regionType === \"province\") {\n                        var muniCode = getMunicipalityCode(d.properties);\n                        partyName = locationToMainParty[muniCode];\n                    } else if (regionType === \"municipality\"){// \"municipality\"\n                        var iecId = getMunicipalityiecId(d.properties);\n                        partyName = locationToMainParty[iecId];\n                    } else {// \"municipality-vd\"\n                        var iecId = getMunicipalityiecId(d.properties);\n                        partyName = locationToMainParty[iecId];\n                    }\n                    return partyName;\n                }\n                function getMainPartyColorFromRegion(d, i) {\n                    var partyName = getMainPartyName(d, i);\n                    var partyColor = getFillColorFromPartyName(partyName);\n                    return partyColor;\n                }\n    \n                var jsonDataFeatures;\n                if (fullRouteGeoJsonFile.indexOf(\".topojson\") !== -1) {//topojson is used for munis and muni-vds\n                    var regionType = self.state.regionType\n                    if (regionType == \"municipality\") {\n                        if (!geoJsonData.objects[self.state.muniCode])\n                            return;\n                        geoJsonData = topojson.feature(geoJsonData, geoJsonData.objects[self.state.muniCode]);\n                    } else { // \"municipality-vd\"\n                        if (!geoJsonData.objects[self.state.iecId])\n                            return;\n                        geoJsonData = topojson.feature(geoJsonData, geoJsonData.objects[self.state.iecId]);\n                    }\n                }\n    \n                jsonDataFeatures = geoJsonData.features;\n    \n                var projection = d3.geoMercator().fitSize([w, h], geoJsonData);\n                var path = d3.geoPath().projection(projection);\n    \n                // fill region with regionColor\n                svg.selectAll(`.${className(\"region\")}`)\n                    .data(jsonDataFeatures)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"class\", className(\"region\"))\n                    .attr(\"stroke\", regionBorderColor)\n                    .attr(\"fill\", getMainPartyColorFromRegion)\n                    .attr(\"id\", function(d, i) {\n                        return `region-${i}`;\n                    })\n                    .attr(\"d\", path);\n                \n                var parties = [];\n                var availableCnt = [];\n                jsonDataFeatures.forEach((d, i) => {\n                    var party = getMainPartyName(d, i);\n                    if (!party) {\n                        party = \"\";\n                    }\n                    if (parties.indexOf(party) == -1) {\n                        parties.push(party);\n                        availableCnt.push(1);\n                    } else {\n                        availableCnt[parties.indexOf(party)] ++;\n                    }\n                })\n\n                console.log(\"parties\", parties);\n                console.log(\"availableCnt\", availableCnt);\n    \n                parties.sort(function(a, b){\n                    if (!a || !a.length) {\n                        return 1;\n                    }\n                    if (!b || !b.length) {\n                        return -1;\n                    }\n                    return availableCnt[parties.indexOf(b)] - availableCnt[parties.indexOf(a)];\n                })\n    \n                function getLegendXY(i) {\n                    return [(i%5)*150, h + 10 + parseInt(i/5) * 40];\n                }\n                var legends = svg.selectAll(`.${className(\"legend\")}`)\n                    .data(parties)\n                    .enter()\n                    .append('g')\n                    .attr(\"class\", className(\"legend\"))\n                    .attr('transform', (d, i) => \"translate(\" + getLegendXY(i) + \")\")\n                legends\n                    .append(\"rect\")\n                    .attr('width', 20)\n                    .attr('height', 20)\n                    .attr('x', 0)\n                    .attr('y', 0)\n                    .attr(\"fill\", (party, i) => {\n                        return getFillColorFromPartyName(party);\n                    })\n                legends.append('text')\n                    .attr('x', 30)\n                    .attr('y', 16)\n                    .text(party => partyAbbrByName[party] || \"No results available\")\n                \n                if (self.state.regionType.indexOf(\"municipality\") == -1) {\n                    svg.selectAll(\".place-label\")\n                        .data(jsonDataFeatures)\n                    .enter().append(\"text\")\n                        .attr(\"class\", \"place-label\")\n                        .attr(\"font-size\", \"12px\")\n                        .attr(\"transform\", function(d) { \n                            var center, projectionCenter;\n                            if (d.geometry.type === \"Polygon\") {\n                                center = polylabel(d.geometry.coordinates);\n                                projectionCenter = projection(center);\n                                projectionCenter[1] -= 12;\n                                return \"translate(\" + projectionCenter + \")\"; \n                            } else { //\"MultiPolygon\"\n                                center = polylabel(d.geometry.coordinates[0]);\n                                projectionCenter = projection(center);\n                                projectionCenter[1] -= 5;\n                                return \"translate(\" + projectionCenter + \")\"; \n                            }\n                        })\n                        .attr(\"dy\", \".35em\")\n                        .style(\"text-anchor\", \"middle\")\n                        .text(d => getSubRegionName(d.properties, self.state))\n                }\n    \n                if (self.state.regionType.indexOf(\"municipality\") == -1) {\n                    fixMapLabelIntersect();\n                }\n    \n                //hidden area for catching events\n                svg.selectAll(\".eventLayer\")\n                    .data(jsonDataFeatures)\n                .enter()\n                    .append(\"path\")\n                    .attr(\"d\", path)\n                    .attr(\"class\", \"eventLayer\")\n                    .attr(\"id\", function(d, i) {\n                        return `eventLayer-${i}`;\n                    })\n                    .attr(\"fill\", \"transparent\")\n                    .on(\"mouseover\", function(d, i) {\n                        d3.select(`#region-${i}`)\n                            .attr(\"stroke-width\", 3)\n                            .style(\"fill-opacity\", 0.8);\n                    })\n                    .on(\"mousemove\", function(d, i) {\t\n                        // if (self.state.regionType === \"municipality\") return;\n                        tooltipDiv.transition()\t\t\n                            .duration(200)\t\t\n                            .style(\"opacity\", 1);\n    \n                        var undefinedText;\n                        if (getYear(self.state.eventDescription) == 2019)\n                            undefinedText = \"no results available\"\n                        else \n                            undefinedText = \"no previous results available\"\n                        var mainPartyName = getMainPartyName(d, i);\n                        var subRegionName = getSubRegionName(d.properties, self.state);\n                        if (getYear(self.state.eventDescription) != 2019 && !mainPartyName) {\n                            if (self.state.regionType === \"province\") {\n                                subRegionName = \"New municipality\"\n                            } else {\n                                subRegionName = \"New voting district\"\n                            }\n                        }\n                        var tooltipText = (typeof mainPartyName !== \"undefined\" && mainPartyName)? \n                                    (subRegionName + \" : \" + mainPartyName) : (subRegionName + \" : \" + undefinedText);\n    \n                        tooltipDiv.html(tooltipText)\t\n                            .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                            .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n                    })\n                    .on(\"mouseout\", function(d, i) {\n                        d3.select(`#region-${i}`)\n                            .attr(\"stroke-width\", 1)\n                            .style(\"fill-opacity\", 1);\n                        \n                        if (self.state.regionType === \"municipality\") return;\n    \n                        tooltipDiv.transition()\t\t\n                            .duration(200)\t\t\n                            .style(\"opacity\", 0);\t\n                    })\n                    .on(\"click\", function(d, i) {                  \n                        tooltipDiv.transition()\t\t\n                            .duration(200)\t\t\n                            .style(\"opacity\", 0);\t\n                        \n                        var regionType = self.state.regionType;\n                        var newState, event;\n                        if (regionType === \"national\") {\n                            newState = {\n                                regionType: \"province\",\n                                provinceName: d.properties.SPROVINCE\n                            }\n                        } else if (regionType === \"province\") {\n                            newState = {\n                                regionType: \"municipality\", \n                                provinceName: self.state.provinceName,\n                                muniName: d.properties.smunicipal,\n                                muniCode: getMunicipalityCode(d.properties),\n                            }\n                        } else if (regionType === \"municipality\"){ // \"municipality\"\n                            var newState = {\n                                regionType: \"municipality-vd\", \n                                provinceName: self.state.provinceName,\n                                muniName: self.state.muniName,\n                                muniCode: self.state.muniCode,\n                                iecId: getMunicipalityiecId(d.properties),\n                            }\n                        } else { // \"municipality-vd\"\n                            return;\n                        }\n                        var mainPartyName = getMainPartyName(d, i);\n                        if (!mainPartyName && regionType === \"municipality\") {\n                            return;\n                        }\n                        triggerCustomEvent(events.REGION_CHANGE, newState);\n                        if (self.state.disableNavigation) {\n                            return;\n                        }\n                        self.setState(newState);\n                    })\n                if (!self.state.disableNavigation) {\n                    var fo = svg.append(\"foreignObject\")\n                        .attr(\"x\", 0)\n                        .attr(\"y\", 10)\n                        .attr(\"width\", 500)\n                        .attr(\"height\", 30)\n                        .attr(\"class\", className(\"map-controls\"))\n                    \n                    function setRegionType(regionType) {\n                        var newState;\n                        var newState = {\n                            regionType: self.state.regionType, \n                            provinceName: self.state.provinceName,\n                            muniName: self.state.muniName,\n                            muniCode: self.state.muniCode,\n                            iecId: self.state.iecId,\n                        }\n                        newState.regionType = regionType;\n                        triggerCustomEvent(events.REGION_CHANGE, newState);\n                        self.setState(newState);\n                    }\n    \n                    function appendSpan(foDiv, regionName, addSub) {\n                        if (addSub) foDiv.append(\"span\").html(\" > \");\n                        foDiv.append(\"span\")\n                            .style(\"height\", \"30px\")\n                            .style(\"cursor\", \"default\")\n                            .html(regionName);\n                    }\n    \n                    function appendLink(foDiv, regionName, regionType, addSub) {\n                        if (addSub) foDiv.append(\"span\").html(\" > \");\n                        foDiv.append(\"a\")\n                            .style(\"height\", \"30px\")\n                            .style(\"cursor\", \"pointer\")\n                            .html(regionName)\n                            .on(\"click\", function() {\n                                setRegionType(regionType);\n                            });\n                    }\n                    \n                    var foDiv = fo.append(\"xhtml:div\");\n                    var regionType = self.state.regionType;\n                    if (regionType == \"national\") {\n                        appendSpan(foDiv, \"South Africa\", false);\n                    } else {\n                        appendLink(foDiv, \"South Africa\", \"national\", false);\n                        if (regionType == \"province\") {\n                            appendSpan(foDiv, self.state.provinceName, true);\n                        } else {\n                            appendLink(foDiv, self.state.provinceName, \"province\", true);\n                            if (regionType == \"municipality\") {\n                                appendSpan(foDiv, self.state.muniCode, true);\n                            } else {\n                                appendLink(foDiv, self.state.muniCode, \"municipality\", true);\n                                appendSpan(foDiv, self.state.iecId, true);\n                            }\n                        }\n                    }\n                }\n                self.getLoadingSpinner()\n                    .style(\"display\", \"none\");\n            }).catch(error => {\n                console.error(error);\n                console.log(`failed to get data from server`);\n            })\n        }).catch(error => {\n            console.error(error);\n\n            self.getLoadingSpinner()\n                .style(\"display\", \"none\");\n            \n            if (self.state.disableNavigation) {\n                return;\n            }\n\n            var currentRegionName = getRegionName(this.state);\n            var regionType = self.state.regionType;\n            var newState, event;\n\n            var newState = {\n                regionType: self.state.regionType, \n                provinceName: self.state.provinceName,\n                muniName: self.state.muniName,\n                muniCode: self.state.muniCode,\n                iecId: self.state.iecId,\n            }\n            \n            if (regionType === \"province\") {\n                newState.regionType = \"national\";\n            } else if (regionType === \"municipality\") {\n                newState.regionType = \"province\";\n            } else if (regionType === \"municipality-vd\") {\n                newState.regionType = \"municipality\";\n            }\n\n            triggerCustomEvent(events.REGION_CHANGE, newState);\n            self.setState(newState);\n            setTimeout(() => {\n                if (regionType == \"national\" || regionType == \"province\") {\n                  console.log(`Can't get map data for $currentRegionName`)\n                } else {\n                    alert(`${currentRegionName} has been disestablished`); \n                }\n            }, 300);    \n        })\n    }\n}\n\nexport default Map;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson-client\";\n\nimport config from \"../../config\";\nimport polylabel from \"polylabel\";\nimport styles from \"../Map/map.css\";\nimport events from \"../../events\";\nimport ReactLoading from \"react-loading\";\nimport {\n    getTurnoutData,\n    getProvincesData\n} from \"../../api\";\nimport {\n  parseTurnoutData,\n  parseCountingProgressDataForMap,\n  getRegionName,\n  getSubRegionName,\n  createTooltip,\n  getMunicipalityCode,\n  fixMapLabelIntersect,\n  triggerCustomEvent,\n  getMunicipalityiecId,\n  getRegionFileName,\n  fetchDataFromOBJ\n} from \"../../utils\";\n\nvar dataRefreshTime = 30 * 1000;\n\nvar regionColor = \"#9c9c9c\";\nvar regionBorderColor = \"#eeeeee\";\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar provincesData = getProvincesData();\n\nclass Map extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            isTurnout: true,\n            disableNavigation: false,\n            eventDescription: \"2019 National Election\",\n            regionType: \"national\",\n            provinceName: \"\",\n            muniName: \"\",\n            muniCode: \"\",\n            iecId: \"\",\n            stylesheetFor: \"web\",\n            componentID: 11\n        }\n\n        fetchDataFromOBJ(this.state, props);\n        console.log(\"updatedState\", this.state, props);\n\n        this.refreshIntervalID = 0;\n        this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n        this.exportAsPNG = this.exportAsPNG.bind(this);\n        this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n\n    draw(container, props) {\n        this.drawGraph(container, props);\n    }\n\n    componentDidMount() {\n        var self = this;\n        this.draw(this.getContainer(), this.state);\n        this.refreshIntervalID = setInterval(() => {\n          self.draw(self.getContainer(), self.state)\n        }, dataRefreshTime);\n\n        document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n        document.addEventListener(events.MAP_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentWillUnmount() {\n        this.getContainer().selectAll(\"svg\").remove();\n        document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n        document.removeEventListener(events.MAP_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (JSON.stringify(prevState) !== JSON.stringify(this.state))\n            this.draw(this.getContainer(), this.state)\n    }\n\n\n    exportAsPNGUri() {\n        var self = this;\n        return new Promise(function(resolve, reject) {\n            var rect = {width: 950, height: 890};\n            var rendercanvas = document.createElement('canvas');\n            rendercanvas.setAttribute(\"width\", rect.width);\n            rendercanvas.setAttribute(\"height\", rect.height);\n\n            if (!window.canvg) {\n                return reject(\"canvg module not available\");\n            }\n\n            window.canvg(rendercanvas, self.refs.vizcontainer.innerHTML, {\n                ignoreDimensions: true,\n                scaleWidth: rect.width,\n                scaleHeight: rect.height\n            });\n            resolve(rendercanvas.toDataURL(\"image/png;base64\").split(',')[1])\n        });\n    }\n\n    exportAsPNG(event) {\n        var targetState = event.detail;\n        if (targetState.componentID != this.state.componentID)\n          return;\n        var rect = {width: 950, height: 890};\n        var rendercanvas = document.createElement('canvas');\n        rendercanvas.setAttribute(\"width\", rect.width);\n        rendercanvas.setAttribute(\"height\", rect.height);\n\n        if (!window.canvg) {\n            return console.error(\"canvg module not available\");\n        }\n\n        window.canvg(rendercanvas, this.refs.vizcontainer.innerHTML, {\n            ignoreDimensions: true,\n            scaleWidth: rect.width,\n            scaleHeight: rect.height\n        });\n\n        var canvas = rendercanvas, filename = `turnout-map(${getRegionName(this.state)}).png`;\n        if (!this.state.isTurnout) {\n            filename = `counting-progress-map(${getRegionName(this.state)}).png`\n        }\n        var lnk = document.createElement(\"a\"), e;\n\n        lnk.download = filename;\n        lnk.href = canvas.toDataURL(\"image/png;base64\");\n\n        if (document.createEvent) {\n            e = document.createEvent(\"MouseEvents\");\n            e.initMouseEvent(\"click\", true, true, window,\n                            0, 0, 0, 0, 0, false, false, false,\n                            false, 0, null);\n            lnk.dispatchEvent(e);\n        } else if (lnk.fireEvent) {\n            lnk.fireEvent(\"onclick\");\n        }\n    }\n\n    handlePreviewEvent(event) {\n        var newState = event.detail;\n        this.setState(newState)\n    }\n\n    getContainer() {\n        return d3.select(this.refs.vizcontainer)\n    }\n\n    getLoadingSpinner() {\n        return d3.select(this.refs.loading)\n    }\n      \n    render () {\n        var {\n            disableNavigation,\n            stylesheetFor,\n            componentID\n        } = this.state;\n        return (\n            <div className={className(\"map-widget\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n                {\n                    componentID != -1000 && <div className={cn(\"map-title\")}>{getRegionName(this.state)}</div>\n                }\n                <div ref=\"vizcontainer\" className={className(\"map\")}></div>\n                <div className={cn(\"loading-spinner\")} ref=\"loading\">\n                    <ReactLoading type={\"spin\"} color={\"#777\"} height={100} width={100} />\n                </div>\n            </div>\n        )\n    }\n \n    drawGraph(container, props) {\n        var self = this;\n\n        var fullRouteGeoJsonFile = config.DOMAIN + \"/mapdata/\" + getRegionFileName(self.state);\n\n        self.getLoadingSpinner()\n            .style(\"display\", \"block\")\n            .transition()\n            .duration(200)\n            .style(\"opacity\", 1);\n\n        var tooltipDiv = createTooltip(className);\n\n        var w = 900;\n        var h = 800;\n        var bottomMargin = 90;// for legend\n        var rightMargin = 50;\n\n        container.selectAll(\"svg\").remove();\n        var svg = container.append(\"svg\")\n            .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n            .attr(\"viewBox\", \"0 0 \" + (w+rightMargin) + \" \" + (h+bottomMargin))\n            .classed(\"svg-content\", true);\n\n        var geoJsonLoader = d3.json(fullRouteGeoJsonFile);\n        var mainDataLoader = getTurnoutData(props);\n        var dataLoaders = [mainDataLoader];\n\n        geoJsonLoader.then(function(value) {\n            var geoJsonData = value;\n            Promise.all(dataLoaders).then(function(values){ \n                var locationToMainData;\n                if (self.state.isTurnout) {\n                    locationToMainData = parseTurnoutData(values[0], props);\n                } else {\n                    locationToMainData = parseCountingProgressDataForMap(values[0], props);\n                }\n                       \n    \n                function getMergedColorWithWhite(percent) {\n                    var originRGB = {\n                        R: 0,\n                        G: 255,\n                        B: 0\n                    }\n                    var mixedR = (originRGB.R * (percent) + 255 * (100-percent))/100;\n                    var mixedG = (originRGB.G * (percent) + 255 * (100-percent))/100;\n                    var mixedB = (originRGB.B * (percent) + 255 * (100-percent))/100;\n                    return `rgb(${mixedR},${mixedG},${mixedB})`;\n                }\n                function getFillColorFromTurnout(turnout) {\n                //   if (turnout > 65)\n                //     return \"#39711D\";//getMergedColorWithWhite(100);//\"rgb(0,165,138)\";\n                //   if (turnout >= 60)\n                //     return \"#458923\";//getMergedColorWithWhite(90);//\"rgb(4,68,95)\";\n                //   if (turnout >= 55)\n                //     return \"#53B025\";//getMergedColorWithWhite(80);//\"rgb(4,98,138)\";\n                //   if (turnout >= 50)\n                //     return \"#4BDC02\";//getMergedColorWithWhite(70);//\"rgb(4,117,164)\";\n                //   if (turnout >= 45)\n                //     return \"#7CE547\";//getMergedColorWithWhite(60);//\"rgb(4,136,191)\";\n                //   if (turnout >= 40)\n                //     return \"#93E968\";//getMergedColorWithWhite(50);//\"rgb(0,154,216)\";\n                //   if (turnout >= 35)\n                //     return \"#A6ED83\";//getMergedColorWithWhite(40);//\"rgb(77,174,224)\";\n                //   if (turnout >= 30)\n                //     return \"#C5F3AF\";//getMergedColorWithWhite(30);//\"rgb(124,194,231)\";\n                //   return \"#D3F6C3\";//regionColor;\n                    if (turnout > 90)\n                        return \"#39711D\";//getMergedColorWithWhite(100);//\"rgb(0,165,138)\";\n                    if (turnout >= 80)\n                        return \"#458923\";//getMergedColorWithWhite(90);//\"rgb(4,68,95)\";\n                    if (turnout >= 70)\n                        return \"#53B025\";//getMergedColorWithWhite(80);//\"rgb(4,98,138)\";\n                    if (turnout >= 60)\n                        return \"#7CE547\";//getMergedColorWithWhite(70);//\"rgb(4,117,164)\";\n                    if (turnout >= 50)\n                        return \"#C5F3AF\";//getMergedColorWithWhite(60);//\"rgb(4,136,191)\";\n                    return \"#D3F6C3\";//regionColor;\n                }\n\n                function getFillColorFromCountProg(countProg) {\n                    if (countProg >= 100)\n                      return \"#980043\";\n                    if (countProg >= 80)\n                      return \"#dd1c77\";\n                    if (countProg >= 60)\n                      return \"#df65b0\";\n                    if (countProg >= 40)\n                      return \"#c994c7\";\n                    if (countProg >= 20)\n                      return \"#d4b9da\";\n                    if (countProg <= 0)\n                      return \"#ffffff\";\n                    return \"#f1eef6\";\n                  }\n    \n                function getMainData(d, i) {\n                    var mainData;\n                    var regionType = self.state.regionType;\n                    if (regionType === \"national\") {\n                        var provinceName = d.properties.SPROVINCE;\n                        mainData = locationToMainData[provinceName];\n                    } else if (regionType === \"province\") {\n                        var muniCode = getMunicipalityCode(d.properties);\n                        mainData = locationToMainData[muniCode];\n                    } else if (regionType === \"municipality\"){// \"municipality\"\n                        var iecId = getMunicipalityiecId(d.properties);\n                        mainData = locationToMainData[iecId];\n                    } else {// \"municipality-vd\"\n                        var iecId = getMunicipalityiecId(d.properties);\n                        mainData = locationToMainData[iecId];\n                    }\n                    return mainData;\n                }\n                function getFillColorFromRegion(d, i) {\n                    if (self.state.isTurnout) {\n                        var turnout = getMainData(d, i);\n                        return getFillColorFromTurnout(turnout);\n                    } else {\n                        var countProg = getMainData(d, i);\n                        return getFillColorFromCountProg(countProg);\n                    }\n                }\n                var jsonDataFeatures;\n                if (fullRouteGeoJsonFile.indexOf(\".topojson\") !== -1) {//topojson is used for munis and muni-vds\n                    var regionType = self.state.regionType\n                    if (regionType == \"municipality\") {\n                        if (!geoJsonData.objects[self.state.muniCode])\n                            return;\n                        geoJsonData = topojson.feature(geoJsonData, geoJsonData.objects[self.state.muniCode]);\n                    } else { // \"municipality-vd\"\n                        if (!geoJsonData.objects[self.state.iecId])\n                            return;\n                        geoJsonData = topojson.feature(geoJsonData, geoJsonData.objects[self.state.iecId]);\n                    }\n                }\n    \n                jsonDataFeatures = geoJsonData.features;\n    \n                var projection = d3.geoMercator().fitSize([w, h], geoJsonData);\n                var path = d3.geoPath().projection(projection);\n    \n                // fill region with regionColor\n                svg.selectAll(`.${className(\"region\")}`)\n                    .data(jsonDataFeatures)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"class\", className(\"region\"))\n                    .attr(\"stroke\", regionBorderColor)\n                    .attr(\"fill\", getFillColorFromRegion)\n                    .attr(\"id\", function(d, i) {\n                        return `region-${i}`;\n                    })\n                    .attr(\"d\", path);\n\n                    \n                var turnoutColors = [{\n                    text: \"More than 90%\",\n                    turnout: 91\n                },{\n                    text: \"80% - 89%\",\n                    turnout: 81\n                },{\n                    text: \"70% - 79%\",\n                    turnout: 71\n                },{\n                    text: \"60% - 69%\",\n                    turnout: 61\n                },{\n                    text: \"50% - 59%\",\n                    turnout: 51\n                },{\n                    text: \"Less than 50%\",\n                    turnout: 40\n                }];\n\n                var countProgColors = [{\n                    text: \"100%\",\n                    countProg: 100\n                },{\n                    text: \"80% - 99%\",\n                    countProg: 81\n                },{\n                    text: \"60% - 79%\",\n                    countProg: 61\n                },{\n                    text: \"40% - 59%\",\n                    countProg: 41\n                },{\n                    text: \"20% - 39%\",\n                    countProg: 21\n                },{\n                    text: \"0.01% - 19%\",\n                    countProg: 1\n                },{\n                    text: \"0%\",\n                    countProg: 0\n                }];\n                \n                function getLegendXY(i) {\n                    return [(i%5)*170, h + 10 + parseInt(i/5) * 40];\n                }\n                var legends = svg.selectAll(`.${className(\"legend\")}`)\n                    .data(self.state.isTurnout? turnoutColors: countProgColors)\n                    .enter()\n                    .append('g')\n                    .attr(\"class\", className(\"legend\"))\n                    .attr('transform', (d, i) => \"translate(\" + getLegendXY(i) + \")\")\n                legends\n                    .append(\"rect\")\n                    .attr('width', 20)\n                    .attr('height', 20)\n                    .attr('x', 0)\n                    .attr('y', 0)\n                    .attr(\"fill\", (it) => {\n                        if (self.state.isTurnout)\n                            return getFillColorFromTurnout(it.turnout);\n                        return getFillColorFromCountProg(it.countProg);\n                    })\n                legends.append('text')\n                    .attr('x', 30)\n                    .attr('y', 16)\n                    .text(it => it.text)\n                \n                if (self.state.regionType !== \"municipality\") {\n                    svg.selectAll(\".place-label\")\n                        .data(jsonDataFeatures)\n                    .enter().append(\"text\")\n                        .attr(\"class\", \"place-label\")\n                        .attr(\"font-size\", \"12px\")\n                        .attr(\"transform\", function(d) { \n                            var center, projectionCenter;\n                            if (d.geometry.type === \"Polygon\") {\n                                center = polylabel(d.geometry.coordinates);\n                                projectionCenter = projection(center);\n                                projectionCenter[1] -= 12;\n                                return \"translate(\" + projectionCenter + \")\"; \n                            } else { //\"MultiPolygon\"\n                                center = polylabel(d.geometry.coordinates[0]);\n                                projectionCenter = projection(center);\n                                projectionCenter[1] -= 5;\n                                return \"translate(\" + projectionCenter + \")\"; \n                            }\n                        })\n                        .attr(\"dy\", \".35em\")\n                        .style(\"text-anchor\", \"middle\")\n                        .text(d => getSubRegionName(d.properties, self.state))\n                }\n    \n                if (self.state.regionType !== \"municipality\") {\n                    fixMapLabelIntersect();\n                }\n    \n                //hidden area for catching events\n                svg.selectAll(\".eventLayer\")\n                    .data(jsonDataFeatures)\n                .enter()\n                    .append(\"path\")\n                    .attr(\"d\", path)\n                    .attr(\"class\", \"eventLayer\")\n                    .attr(\"id\", function(d, i) {\n                        return `eventLayer-${i}`;\n                    })\n                    .attr(\"fill\", \"transparent\")\n                    .on(\"mouseover\", function(d, i) {\n                        d3.select(`#region-${i}`)\n                            .attr(\"stroke-width\", 3)\n                            .style(\"fill-opacity\", 0.8);\n                    })\n                    .on(\"mousemove\", function(d, i) {\n                        tooltipDiv.transition()\t\t\n                            .duration(200)\t\t\n                            .style(\"opacity\", 1);\n                        \n                        var undefinedText;\n                        if (self.state.eventDescription.indexOf(\"2019\") == -1) {\n                            if (self.state.regionType === \"province\") {\n                                undefinedText = \"New municipality - no previous results available\"\n                            } else {\n                                undefinedText = \"New voting district - no previous results available\"\n                            }\n                        } else {\n                            undefinedText = \"votes not counted yet\";\n                        }\n    \n                        var mainData = getMainData(d, i);\n                        var subRegionName = getSubRegionName(d.properties, self.state);\n                        var tooltipText = (typeof mainData !== \"undefined\")? \n                                    (subRegionName + \" : \" + mainData + \"%\") : undefinedText;\n    \n                        tooltipDiv.html(tooltipText)\t\n                            .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                            .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n                    })\n                    .on(\"mouseout\", function(d, i) {\n                        d3.select(`#region-${i}`)\n                            .attr(\"stroke-width\", 1)\n                            .style(\"fill-opacity\", 1);\n                        \n                        if (self.state.regionType === \"municipality\") return;\n    \n                        tooltipDiv.transition()\t\t\n                            .duration(200)\t\t\n                            .style(\"opacity\", 0);\t\n                    })\n                    .on(\"click\", function(d, i) {\n                        if (self.state.disableNavigation) {\n                            return;\n                        }\n                        tooltipDiv.transition()\t\t\n                            .duration(200)\t\t\n                            .style(\"opacity\", 0);\t\n                        \n                        var regionType = self.state.regionType;\n                        var newState;\n                        if (regionType === \"national\") {\n                            newState = {\n                                regionType: \"province\",\n                                provinceName: d.properties.SPROVINCE\n                            }\n                            triggerCustomEvent(events.REGION_CHANGE, newState);\n                            self.setState(newState);\n                        } else if (regionType === \"province\") {\n                            newState = {\n                                regionType: \"municipality\", \n                                provinceName: self.state.provinceName,\n                                muniName: d.properties.smunicipal,\n                                muniCode: getMunicipalityCode(d.properties),\n                            }\n                            triggerCustomEvent(events.REGION_CHANGE, newState);\n                            self.setState(newState);\n                        } else { // \"municipality\"\n                            var newState = {\n                                regionType: \"municipality-vd\", \n                                provinceName: self.state.provinceName,\n                                muniName: self.state.muniName,\n                                muniCode: self.state.muniCode,\n                                iecId: getMunicipalityiecId(d.properties),\n                            }\n                            triggerCustomEvent(events.REGION_CHANGE, newState);\n    \n                            self.setState(newState);\n                        }\n                    })\n                    if (!self.state.disableNavigation) {\n                        var fo = svg.append(\"foreignObject\")\n                            .attr(\"x\", 0)\n                            .attr(\"y\", 10)\n                            .attr(\"width\", 500)\n                            .attr(\"height\", 30)\n                            .attr(\"class\", \"map-controls\")\n                        \n                        function setRegionType(regionType) {\n                            var newState;\n                            var newState = {\n                                regionType: self.state.regionType, \n                                provinceName: self.state.provinceName,\n                                muniName: self.state.muniName,\n                                muniCode: self.state.muniCode,\n                                iecId: self.state.iecId,\n                            }\n                            newState.regionType = regionType;\n                            triggerCustomEvent(events.REGION_CHANGE, newState);\n                            self.setState(newState);\n                        }\n        \n                        function appendSpan(foDiv, regionName, addSub) {\n                            if (addSub) foDiv.append(\"span\").html(\" > \");\n                            foDiv.append(\"span\")\n                                .style(\"height\", \"30px\")\n                                .style(\"cursor\", \"default\")\n                                .html(regionName);\n                        }\n        \n                        function appendLink(foDiv, regionName, regionType, addSub) {\n                            if (addSub) foDiv.append(\"span\").html(\" > \");\n                            foDiv.append(\"a\")\n                                .style(\"height\", \"30px\")\n                                .style(\"cursor\", \"pointer\")\n                                .html(regionName)\n                                .on(\"click\", function() {\n                                    setRegionType(regionType);\n                                });\n                        }\n                        \n                        var foDiv = fo.append(\"xhtml:div\");\n                        var regionType = self.state.regionType;\n                        if (regionType == \"national\") {\n                            appendSpan(foDiv, \"South Africa\", false);\n                        } else {\n                            appendLink(foDiv, \"South Africa\", \"national\", false);\n                            if (regionType == \"province\") {\n                                appendSpan(foDiv, self.state.provinceName, true);\n                            } else {\n                                appendLink(foDiv, self.state.provinceName, \"province\", true);\n                                if (regionType == \"municipality\") {\n                                    appendSpan(foDiv, self.state.muniCode, true);\n                                } else {\n                                    appendLink(foDiv, self.state.muniCode, \"municipality\", true);\n                                    appendSpan(foDiv, self.state.iecId, true);\n                                }\n                            }\n                        }\n                        // foDiv\n                        //     .append(\"button\")\n                        //     .attr(\"class\", \"go-back\")\n                        //     .style(\"height\", \"30px\")\n                        //     .style(\"color\", \"black\")\n                        //     .html(\"go back\")\n                        //     .on(\"click\", function() {\n                        //         var regionType = self.state.regionType;\n                        //         var newState, event;\n            \n                        //         var newState = {\n                        //             regionType: self.state.regionType, \n                        //             provinceName: self.state.provinceName,\n                        //             muniName: self.state.muniName,\n                        //             muniCode: self.state.muniCode,\n                        //             iecId: self.state.iecId,\n                        //         }\n                                \n                        //         if (regionType === \"province\") {\n                        //             newState.regionType = \"national\";\n                        //         } else if (regionType === \"municipality\") {\n                        //             newState.regionType = \"province\";\n                        //         } else if (regionType === \"municipality-vd\") {\n                        //             newState.regionType = \"municipality\";\n                        //         }\n            \n                        //         triggerCustomEvent(events.REGION_CHANGE, newState);\n                        //         self.setState(newState);\n                        //     });\n                    }\n                self.getLoadingSpinner()\n                    .style(\"display\", \"none\");\n            }).catch(error => {\n                console.error(error);\n                console.log(`failed to get data from server`);\n            })\n        }).catch(error => {\n            console.error(error);       \n            self.getLoadingSpinner()\n                .style(\"display\", \"none\");\n            var currentRegionName = getRegionName(this.state);\n            var regionType = self.state.regionType;\n            var newState, event;\n\n            var newState = {\n                regionType: self.state.regionType, \n                provinceName: self.state.provinceName,\n                muniName: self.state.muniName,\n                muniCode: self.state.muniCode,\n                iecId: self.state.iecId,\n            }\n            \n            if (regionType === \"province\") {\n                newState.regionType = \"national\";\n            } else if (regionType === \"municipality\") {\n                newState.regionType = \"province\";\n            } else if (regionType === \"municipality-vd\") {\n                newState.regionType = \"municipality\";\n            }\n\n            triggerCustomEvent(events.REGION_CHANGE, newState);\n            self.setState(newState);\n            setTimeout(() => {\n                if (regionType == \"national\" || regionType == \"province\") {\n                  console.log(`Can't get map data for ${currentRegionName}`);\n                } else {\n                    alert(`${currentRegionName} has been disestablished`); \n                }\n            }, 300);    \n        })\n    }\n}\n\nexport default Map;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../BarChart/d3barchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getTurnoutDataForAllEvents,\n} from \"../../api\";\nimport {\n  parseTurnoutDataForAllEvents,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Turnout Barchart',\n  yAxisLabel: 'PERCENTAGE',\n  noXaxisByParty: true,\n  yValue: function(d) {\n    return d.percVoterTurnout;\n  },\n  yValueFormat: function(percVoterTurnout) {\n    return percVoterTurnout + '%';\n  } \n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      var self = this;\n      this.state = {\n        eventType: \"national\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 10\n      }\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n    \n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `turnout-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={cn(\"barchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n                componentID != -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var turnoutDataLoader = getTurnoutDataForAllEvents(props);\n      var dataLoaders = [turnoutDataLoader];\n\n      Promise.all(dataLoaders).then(function(values){ \n        var turnoutData = values[0];\n        self.drawGraph(container, props, turnoutData, 'rgb(157,51,55)');\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, colorsData) {\n        var chartData = parseTurnoutDataForAllEvents(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, colorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport styles from \"./barchartMap.css\";\nimport BarChart from '../BarChart/barchart';\nimport Map from '../Map/map';\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {saveAs} from \"file-saver\";\n\nimport {\n    getRegionName,\n    fetchDataFromOBJ\n} from \"../../utils\";\n\nfunction className(originName) {\n    return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nclass BarchartWithNavMap extends Component {    \n    constructor(props) {\n        super(props);\n        this.state = {\n            numParties: 5,\n            eventDescription: \"2019 National Election\",\n            regionType: \"national\",\n            provinceName: \"\",\n            muniName: \"\",\n            muniCode: \"\",\n            iecId: \"\",\n            stylesheetFor: \"web\",\n            componentID: 2\n        }      \n\n        fetchDataFromOBJ(this.state, props);\n\n        this.exportAsPNG = this.exportAsPNG.bind(this);\n    }\n\n    exportAsPNG(event) {\n        var targetState = event.detail;\n        if (targetState.componentID != this.state.componentID)\n          return;\n        var self = this;\n        Promise.all([\n            self.barchartInstance.exportAsPNGUri(),\n            self.mapInstance.exportAsPNGUri()\n        ]).then(values => {\n            var zip = new window.JSZip();\n\n            var imgs = zip.folder(\"export-images\");\n            imgs.file(\"barchart.png\", values[0], {base64: true});\n            imgs.file(\"map.png\", values[1], {base64: true});\n\n            zip.generateAsync({type:\"blob\"})\n            .then(function(content) {\n                saveAs(content, `race-for-votes-barchart-map(${getRegionName(self.state)}).zip`);\n            });\n        }).catch(error => {\n            console.error(\"export error\", error);\n        })\n    }\n\n    componentDidMount() {\n        document.addEventListener(events.EXPORT_SUPERWIDGET_PNG, this.exportAsPNG);\n    }\n  \n    componentWillUnmount() {\n        document.removeEventListener(events.EXPORT_SUPERWIDGET_PNG, this.exportAsPNG);\n    }\n\n    render() {\n      const {\n        stylesheetFor\n      } = this.state;\n\n        return (\n        <div ref=\"superwidget\" className={className(\"barchart-map\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            <div className={className(\"barchart-container\")} ref=\"barchart\">\n                <BarChart \n                    ref={instance => { this.barchartInstance = instance; }} \n                    {...this.state}\n                    componentID={-1000} />\n            </div>\n            <div className={className(\"map-container\")}>\n                <Map \n                    ref={instance => { this.mapInstance = instance; }} \n                    {...this.state}\n                    componentID={-1000} />\n            </div>\n        </div>\n        );\n    }\n}\n\nexport default BarchartWithNavMap;\n","import * as d3 from \"d3\";\nimport {createTooltip, createSvg, createErrorText} from \"../../utils\";\n\nexport function Chart(container, width, height, className, options) {\n    var data = [],\n        width = 700,\n        height = 300,\n        margin = {top: 10, right: 10, bottom: 10, left: 10},\n        variable = options.variable,\n        category = options.category,\n        padAngle = 0.015,\n        transTime = 750,\n        floatFormat = d3.format('.4r'),\n        cornerRadius = 3,\n        colorsData = null;\n\n\n        \n\n    function colour(key) {\n        if (colorsData && colorsData[key]) {\n            return colorsData[key];\n        }\n        return 'rgb(' + Math.random()*250 + ',' + Math.random()*250 + ',' + Math.random()*250 + ')';\n    }\n\n    var radius = Math.min(width, height) / 2;\n\n    var pie = d3.pie()\n        .value(function(d) { return floatFormat(d[variable]); })\n        .sort(null);\n\n    var arc = d3.arc()\n        .outerRadius(radius * 0.8)\n        .innerRadius(radius * 0.6)\n        .cornerRadius(cornerRadius)\n        .padAngle(padAngle);\n\n    var totalSvg = createSvg(container, width + margin.left + margin.right, height + margin.top + margin.bottom);\n    \n    \n    var transformX = height / 2, transformY = height / 2;\n    if (options.chartType === 'Progress on Votes Count') {\n    } else {\n        transformX = width / 2;\n    }\n    var svg = totalSvg\n        .append('g')\n        .attr('transform', 'translate(' + transformX + ',' + transformY + ')');\n    \n    var labelSvg = totalSvg\n        .append('g')\n        .attr('transform', 'translate(' + height * 6 / 5 + ',' + height / 2 + ')');\n\n    svg.append('g').attr('class', 'slices');\n    svg.append('g').attr('class', 'lines');\n\n    var path = svg.select('.slices')\n        .selectAll('path')\n        .data(pie(data))\n        .enter().append('path')\n        .attr('fill', function(d) { return colour(d.data[category]); })\n        .attr('d', arc);\n\n    var errorText = createErrorText(svg);\n\n    this.destroy = function() {\n        container.selectAll(\"svg\").remove();\n    }\n    this.draw = function(value, colorsDataP) {\n        if (!value) {\n            errorText.text(\"chart data is not available\");\n            return;\n        } else {\n            errorText.text(\"\");\n        }\n\n        if (options.chartType === 'Progress on Votes Count') {\n            colorsData = colorsDataP;\n        } else {\n            var partyColorByName = {};\n\n            var partyColorsData = colorsDataP;\n            if (partyColorsData && partyColorsData[\"data\"][\"allParties\"][\"edges\"]) {\n                partyColorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n                    partyColorByName[edge.node.abbreviation] = edge.node.colour;\n                })\n            }\n            colorsData = partyColorByName;\n        }\n        \n        data = value;\n\n        if (options.chartType === 'Progress on Votes Count') {\n            labelSvg.selectAll('text').remove();\n            labelSvg.append('text')\n                .attr('x', 0)\n                .attr('y', -15)\n                .style('font-size', '.7em')\n                .style('text-anchor', 'middle')\n                .text('Completed' + ': ' + data[0][\"percent\"] + '%');\n            labelSvg.append('text')\n                .attr('x', 0)\n                .attr('y', 0)\n                .text('Captured Votes' + ': ' + data[0][\"count\"])\n                .style('font-size', '.7em')\n                .style('text-anchor', 'middle');\n            labelSvg.append('text')\n                .attr('x', 0)\n                .attr('y', 15)\n                .text('Total' + ': ' + data[0][\"totalCount\"])\n                .style('font-size', '.7em')\n                .style('text-anchor', 'middle');\n        }\n\n        var updatePath = d3.select('.slices').selectAll('path');\n\n        var data0 = path.data(),\n            data1 = pie(data);\n\n        updatePath = updatePath.data(data1, key);\n\n        updatePath.enter().append('path')\n            .each(function(d, i) { this._current = findNeighborArc(i, data0, data1, key) || d; })\n            .attr('fill', function(d) {  return colour(d.data[category]); })\n            .attr('d', arc);\n\n        updatePath.exit()\n            .transition()\n            .duration(transTime)\n            .attrTween(\"d\", arcTween)\n            .remove();\n\n        updatePath.transition().duration(transTime)\n            .attrTween('d', arcTween);\n\n        d3.selectAll('.labelName text, .slices path').call(toolTip);\n\n    };\n\n    function toolTip(selection) {\n\n        if (options.hideTooltip)\n            return;\n\n        selection.on('mouseenter', function (data) {\n            svg.append('text')\n                .attr('class', 'toolCircle')\n                .attr('dy', -15)\n                .html(toolTipHTML(data))\n                .style('font-size', '.7em')\n                .style('text-anchor', 'middle');\n\n            svg.append('circle')\n                .attr('class', 'toolCircle')\n                .attr('r', radius * 0.55)\n                .style('fill', colour(data.data[category]))\n                .style('fill-opacity', 0.35);\n\n        });\n\n        selection.on('mouseout', function () {\n            d3.selectAll('.toolCircle').remove();\n        });\n    }\n\n    function toolTipHTML(data) {\n\n        if (options.chartType === 'Progress on Votes Count') {\n            var tip = '';\n            tip += '<tspan x=\"0\">' + 'Progress' + ': ' + data.data[\"percent\"] + '%' + '</tspan>';\n            tip += '<tspan x=\"0\" dy=\"1.2em\">' + 'Captured Votes' + ': ' + data.data[\"count\"] + '</tspan>';\n            tip += '<tspan x=\"0\" dy=\"1.2em\">' + 'Total' + ': ' + data.data[\"totalCount\"] + '</tspan>';\n        } else { //'Race for Seats Donut chart'\n            var tip = '';\n            tip += '<tspan x=\"0\">' + 'Seats' + ': ' + data.data[\"seats\"] + '</tspan>';\n            tip += '<tspan x=\"0\" dy=\"1.2em\">' + 'Party' + ': ' + data.data[\"name\"] + '</tspan>';\n        }\n        return tip;\n    }\n\n    function arcTween(d) {\n        var i = d3.interpolate(this._current, d);\n        this._current = i(0);\n        return function(t) { return arc(i(t)); };\n    }\n\n    function findNeighborArc(i, data0, data1, key) {\n        var d;\n        return (d = findPreceding(i, data0, data1, key)) ? {startAngle: d.endAngle, endAngle: d.endAngle}\n            : (d = findFollowing(i, data0, data1, key)) ? {startAngle: d.startAngle, endAngle: d.startAngle}\n                : null;\n    }\n\n    function findPreceding(i, data0, data1, key) {\n        var m = data0.length;\n        while (--i >= 0) {\n            var k = key(data1[i]);\n            for (var j = 0; j < m; ++j) {\n                if (key(data0[j]) === k) return data0[j];\n            }\n        }\n    }\n\n    function key(d) {\n        return d.data[category];\n    }\n\n    function findFollowing(i, data0, data1, key) {\n        var n = data1.length, m = data0.length;\n        while (++i < n) {\n            var k = key(data1[i]);\n            for (var j = 0; j < m; ++j) {\n                if (key(data0[j]) === k) return data0[j];\n            }\n        }\n    }\n}","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"./piechart.css\";\nimport {Chart} from \"./d3piechart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getProgressVotesCount\n} from \"../../api\";\nimport {\n  parseProgressVotesCount,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Progress on Votes Count',\n  variable: 'percent',\n  category: 'name',\n  hideTooltip: true\n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\n\nclass PieChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        numParties: 5,\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 4\n      }     \n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `progress-on-votes-piechart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n   \n    render () {\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={className(\"piechart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n              componentID != -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var progressVotesDataLoader = getProgressVotesCount(props);\n      var dataLoaders = [progressVotesDataLoader];\n\n      Promise.all(dataLoaders).then(function(values){ \n        var progressVotesData = values[0];\n        self.drawGraph(container, props, progressVotesData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data) {\n        var chartData = parseProgressVotesCount(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, {\n          \"Completed\": \"#15707C\",\n          \"Not Completed\": \"#CCCCCC\"\n        });\n    }\n}\n\nexport default PieChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"./piechart.css\";\nimport {Chart} from \"../ProgVotesCountPiechart/d3piechart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getSeatsData,\n  getPartyColors\n} from \"../../api\";\nimport {\n  parseSeatsData,\n  getNationOrProvinceName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Race For Seats Donut Chart',\n  variable: 'seats',\n  category: 'name',\n  viewBox: '170 0 360 320'\n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nclass DonutChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        numParties: 100,\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 17\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID !== this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-donutchart-chart(${getNationOrProvinceName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={className(\"donutchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n              componentID !== -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var seatsDataLoader = getSeatsData(props);\n      var dataLoaders = [seatsDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var seatsData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, seatsData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseSeatsData(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default DonutChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../BarChart/d3barchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getVotesDataForComparison,\n  getPartyColors,\n  getProvincesData\n} from \"../../api\";\nimport {\n  parseVotesComparisonData,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\nvar provincesData = getProvincesData();\n\nvar dataRefreshTime = 30 * 1000;\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nvar chartOptions = {\n  chartType: \"Race For Votes Comparison\",\n  yAxisLabel: \"PERCENTAGE VOTES\",\n  yValue: d => d.percOfVotes,\n  yValueFormat: value => value + '%',\n  showLegend: true\n}\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        partyAbbr: \"ANC\",\n        partyIecId: null,\n        eventDescriptions: [\n            \"National Elections 1999\",\n            // \"Provincial Elections 1999\",\n            \"14 Apr 2004 National Election\",\n            // \"14 Apr 2004 Provincial Election\",\n            \"22 Apr 2009 National Election\",\n            // \"22 Apr 2009 Provincial Election\",\n            \"2014 National Election\",\n            // \"2014 Provincial Election\",\n            \"2019 NATIONAL ELECTION\",\n            // \"2019 PROVINCIAL ELECTION\",\n        ],\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 16\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      if (this.chart) {\n        this.chart.destroy();\n        this.chart = null;\n      }\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-votes-comparison-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={cn(\"barchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n              componentID != -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var votesDataLoader = getVotesDataForComparison(props);\n      var dataLoaders = [votesDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var votesData = values[0];\n        partyColorsData = partyColorsData || values[1];          \n        self.drawGraph(container, props, votesData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseVotesComparisonData(data, props);\n        console.log(\"comparison data fetch\", data, chartData);\n\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../BarChart/d3barchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getPartyColors,\n  getSeatsDataForComparison\n} from \"../../api\";\nimport {\n  parseSeatsComparisonData,\n  getNationOrProvinceName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Race For Seats Comparison',\n  yAxisLabel: 'Seats Count',\n  dynamicYAxisFromValues: true,\n  yValue: function(d) {\n    return d.seats;\n  },\n  yValueFormat: function(seats) {\n    return seats;\n  },\n  showLegend: true\n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        partyAbbr: \"ANC\",\n        partyIecId: null,\n        eventDescriptions: [\n            \"National Elections 1999\",\n            \"Provincial Elections 1999\",\n            \"14 Apr 2004 National Election\",\n            \"14 Apr 2004 Provincial Election\",\n            \"22 Apr 2009 National Election\",\n            \"22 Apr 2009 Provincial Election\",\n            \"2014 National Election\",\n            \"2014 Provincial Election\",\n            \"2019 NATIONAL ELECTION\",\n            \"2019 PROVINCIAL ELECTION\",\n\n        ],\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 7\n      }\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-comparison-barchart(${getNationOrProvinceName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      \n      return (\n          <div className={cn(\"barchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n                componentID != -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var seatsDataLoader = getSeatsDataForComparison(props);\n      var dataLoaders = [seatsDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var seatsData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, seatsData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseSeatsComparisonData(data, props);\n        var seats = chartData\n          .map(function(el) {\n            return el.seats;\n          })\n          .reduce(function(seats1, seats2) {\n            return seats1 + seats2}, 0\n          )\n        if (seats > -10) {\n          if (!this.chart)\n          {\n            //this.chart = new Chart(container, null, null, className, chartOptions);\n            container.selectAll(\"*\").remove();\n            }\n\n          this.chart.draw(chartData, partyColorsData);\n        }\n    }\n}\n\nexport default BarChart;\n","import * as d3 from \"d3\";\nimport {createTooltip, createSvg, createErrorText} from \"../../utils\";\n\nexport function Chart(container, width, height, className, options) {\n  if (!options) {\n    options = {};\n  } \n\n  width = 520;\n  height = 180;\n\n    var predefColors = [\"blue\", \"yellow\", \"red\"];\n\n    var svg = createSvg(container, width, height);\n\n\n    var tooltipDiv = createTooltip(className);\n\n    var mainSvg = svg.append(\"g\");\n    var errorText = createErrorText(svg, width / 2, height / 2);\n\n    this.draw = function(originChartData, colorsData) {\n      var chartData = [];\n      if (!originChartData) {\n        errorText.text(\"chart data is not available\");\n        return;\n      } else {\n        errorText.text(\"\");\n      }\n\n      chartData = originChartData;\n      var largest = chartData[0];\n      var rest = chartData.slice(1);\n\n\n      rest.push(largest);\n      chartData = rest;\n\n      var partyColorByName = {};\n\n      var partyColorsData = colorsData;\n      if (partyColorsData && partyColorsData[\"data\"][\"allParties\"][\"edges\"]) {\n          partyColorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n          partyColorByName[edge.node.name] = edge.node.colour;\n          })\n      }\n\n      function getFillColorFromPartyName(partyName, i) {\n        return partyColorByName[partyName.split(\"/\")[0]] || predefColors[i%predefColors.length];\n      }\n\n      function getTooltipText(d, i) {\n          return d.name;\n      }\n\n      var totalSeats = 0;\n      for (var i = 0; i < chartData.length; i ++) {\n        totalSeats += chartData[i].seats;\n      }\n\n      function pythonConvertedCode(totalSeats, mainSvg) {\n        var Totals=[\n              3, 15, 33, 61, 95, 138, 189, 247, 313, 388, 469, 559, 657, 762, 876, 997,\n              1126, 1263, 1408, 1560, 1722, 1889, 2066, 2250, 2442, 2641, 2850, 3064, 3289, 3519,\n              3759, 4005, 4261, 4522, 4794, 5071, 5358, 5652, 5953, 6263, 6581, 6906, 7239, 7581,\n              7929, 8287, 8650, 9024, 9404, 9793, 10187, 10594, 11003, 11425, 11850, 12288, 12729,\n              13183, 13638, 14109, 14580, 15066, 15553, 16055, 16557, 17075, 17592, 18126, 18660,\n              19208, 19758, 20323, 20888, 21468, 22050, 22645, 23243, 23853, 24467, 25094, 25723,\n              26364, 27011, 27667, 28329, 29001, 29679, 30367, 31061\n        ]\n    \n        if (totalSeats > Totals[Totals.length-1]){\n            console.error(\"total seats >\", Totals[Totals.length-1]);\n        }\n    \n        if (totalSeats < 1) {\n          console.error(\"total seats < 1\");\n        }\n        var rows;\n        var radius;\n        var poslist;\n        var J, R, angle;\n          // Figure out how many rows are needed:\n          for (var i = 0; i < Totals.length; i++) {\n              if (Totals[i] >= totalSeats) {\n                  rows = i + 1;\n                  break\n              }\n          }\n          // Maximum radius of spot is 0.5/rows; leave a bit of space.\n          radius = 0.4/rows;\n    \n          // Create list of centre spots\n          poslist = []\n\n          for (var i = 1; i < rows; i ++) {\n            // Each row can contain pi/(2asin(2/(3n+4i-2))) spots, where n is the number of rows and i is the number of the current row.\n            J = parseInt((totalSeats)/Totals[rows-1]*Math.PI/(2*Math.asin(2.0/(3.0*rows+4.0*i-2.0))));\n            // The radius of the ith row in an N-row diagram (Ri) is (3*N+4*i-2)/(4*N)\n            R = (3.0*rows+4.0*i-2.0)/(4.0*rows);\n            if (J === 1) {\n              poslist.push({\n                angle: Math.PI/2.0,\n                x: 1.75*R,\n                y: R\n              })\n            } else {\n              for (var j = 0; j < J; j ++){\n                // The angle to a spot is n.(pi-2sin(r/Ri))/(Ni-1)+sin(r/Ri) where Ni is the number in the arc\n                // x=R.cos(theta) + 1.75\n                // y=R.sin(theta)\n                angle = (j)*(Math.PI-2.0*Math.sin(radius/R))/(J-1.0)+Math.sin(radius/R);\n                poslist.push({\n                  angle,\n                  x: R*Math.cos(angle)+1.75,\n                  y: R*Math.sin(angle)\n                });\n              }\n            }\n          }\n          J=totalSeats-poslist.length\n          R=(7.0*rows-2.0)/(4.0*rows)\n          if (J===1) {\n              poslist.push({\n                angle: Math.PI/2.0,\n                x: 1.75*R,\n                y: R\n              })\n          }\n          else {\n              for (var j = 0; j < J; j ++) {\n                  angle=(j)*(Math.PI-2.0*Math.sin(radius/R))/((J)-1.0)+Math.sin(radius/R)\n                  poslist.push({\n                    angle,\n                    x: R*Math.cos(angle)+1.75,\n                    y: R*Math.sin(angle)\n                  })\n              }\n          }\n\n          poslist.sort(function(a,b) {\n            function value(x) {\n              return x.angle - Math.PI/2;\n            }\n            return value(b) - value(a);\n          })\n\n          function onMouseMove(svg, i){\n            svg\n              .attr(\"opacity\", 0.8);\n            tooltipDiv.transition()\t\t\n                .duration(200)\t\t\n                .style(\"opacity\", .9);\t\t\n            tooltipDiv.html(getTooltipText(chartData[i], i))\n                .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n          }\n          function onMouseOut(svg) {\n            svg\n              .attr(\"opacity\", 1);\n            tooltipDiv.transition()\t\t\n                .duration(200)\t\t\n                .style(\"opacity\", 0);\t\n          }\n          \n          mainSvg.append('text')\n            .attr('x', 175)\n            .attr('y', 175)\n            .attr('style', \"font-size:36px;font-weight:bold;text-align:center;text-anchor:middle;font-family:sans-serif\")\n            .text(totalSeats);\n\n          var Counter=0 //How many spots have we drawn?\n          for (var i = 0; i < chartData.length; i ++){\n            //Make each party's blocks an svg group\n            var partySvg = mainSvg.append('g')\n              .attr(\"fill\", getFillColorFromPartyName(chartData[i].partyInfo.name, i))\n              .attr(\"id\", chartData[i].name);\n            \n            partySvg.on(\"mousemove\", onMouseMove.bind(this, partySvg, i))\t\t\t\t\t\n              .on(\"mouseout\", onMouseOut.bind(this, partySvg))\n            \n            for (var j = 0; j < chartData[i].seats; j++, Counter++) {\n              partySvg.append('circle')\n                .attr('cx', poslist[Counter].x*100.0+5.0)\n                .attr('cy', 100.0*(1.75-poslist[Counter].y)+5.0)\n                .attr('r', radius*100.0)\n            }\n          }\n      }\n      pythonConvertedCode(totalSeats, mainSvg);\n\n      var legendBoxWidth = 10;\n      var boxMargin = legendBoxWidth;\n      var boxX = 360;\n      var columnSpacing = legendBoxWidth * 8;\n      var threeColumnThreshold = 12;\n      var legendParams = {boxX: 360, columnSpacing: legendBoxWidth * 7, boxMargin: legendBoxWidth * 2}\n\n      var positionBoxes2 = function(idx, args) {\n            var args = args || {};\n            var boxWidth = args.boxWidth || 5;\n            var boxX = args.boxX || 380;\n            var columnSpacing = args.columnSpacing || boxWidth * 6\n            var boxMargin = args.boxMargin || boxWidth * 2;\n\n            var yPos = (idx % 2 == 0) ? idx / 2 : (idx - 1) / 2;\n            var y = yPos * (boxWidth + boxMargin) + 10;\n            var x;\n\n            if (idx % 2 == 0)\n              x = boxX;\n            else\n              x = boxX + columnSpacing;\n\n            return {x: x, y: y};\n      }\n\n      var positionBoxes3 = function(idx, args) {\n            var args = args || {};\n            var boxWidth = args.boxWidth || 5;\n            var boxX = args.boxX || 390;\n            var columnSpacing = args.columnSpacing || boxWidth * 6\n            var boxMargin = args.boxMargin || boxWidth * 2;\n            var yShift = args.yShift || 30;\n\n            var yPos;\n\n            if (idx % 3 == 0) {\n              yPos = idx / 3;\n            } else if (idx % 3 == 1) {\n              yPos = (idx - 1) / 3;\n            } else {\n              yPos = (idx - 2) / 3;\n            }\n\n            yPos = (idx - idx % 3) / 3;\n            var y = yPos * boxMargin + yShift;\n            var x = columnSpacing * (idx % 3) + boxX;\n\n            return {x: x, y: y};\n      }\n\n      var legendChart = chartData.slice()\n      legendChart.sort(function(el1, el2) {\n        return el2.seats - el1.seats;\n      })\n\n      var legendContainer = mainSvg.append(\"g\")\n        .classed(\"legend\", true)\n\n      var seatParties = legendChart.filter(function(el) { return el.seats > 0})\n\n      legendContainer\n        .selectAll(\".legend rect\")\n        .data(seatParties)\n        .enter()\n        .append(\"rect\")\n          .attr(\"transform\", function(el, idx) {\n            if (seatParties.length < threeColumnThreshold)\n              var pos = positionBoxes2(idx, legendParams);\n            else\n              var pos = positionBoxes3(idx, legendParams);\n            return \"translate(\" + pos.x +\", \" + pos.y + \")\";\n          })\n          .attr(\"width\", legendBoxWidth)\n          .attr(\"height\", legendBoxWidth)\n          .style(\"fill\", function(el) {\n            return getFillColorFromPartyName(el.partyInfo.name)\n          })\n      legendContainer\n        .selectAll(\".legend text\")\n        .data(seatParties)\n        .enter()\n         .append(\"text\").text(function(el) {\n           return el.name + \" (\" + el.seats + \")\";\n         })\n          .attr(\"transform\", function(el, idx) {\n            if (seatParties.length < threeColumnThreshold)\n              var pos = positionBoxes2(idx, legendParams);\n            else\n              var pos = positionBoxes3(idx, legendParams);\n\n            return \"translate(\" + (pos.x + legendBoxWidth * 1.5) +\", \" + (pos.y + 8) + \")\";\n          })\n          .classed(\"label\")\n\n\n    }\n    this.destroy = function() {\n      svg.remove();\n    }\n  }","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"./horseshoe.css\";\nimport {Chart} from \"../SeatHorseShoeChart/d3horseshoe\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getSeatsData,\n  getPartyColors\n} from \"../../api\";\nimport {\n  parseSeatsData,\n  getNationOrProvinceName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Race For Seats HorseShoe Chart',\n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nclass HorseShoeChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        numParties: 100,\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 8\n      }\n\n      fetchDataFromOBJ(this.state, props);\n      this.state[\"numParties\"] = 100;\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      if (this.has_drawn === undefined) {\n        this.draw(this.getContainer(), this.state)\n        this.has_drawn = true;\n      } else {\n        // Hack to prevent drawing horseshoe twice\n        this.has_drawn = undefined;\n      }\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID !== this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-horseshoe-chart(${getNationOrProvinceName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n      return (\n          <div className={className(\"horseshoechart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n                componentID !== -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName(this.state)}): </div>\n            }\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var seatsDataLoader = getSeatsData(props);\n      var dataLoaders = [seatsDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var seatsData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, seatsData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseSeatsData(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default HorseShoeChart;\n","import * as d3 from \"d3\";\nimport {createTooltip, createSvg, createErrorText, PartyColours} from \"../../utils\";\n\nexport function Chart(container, width, height, className, options) {\n  if (!options) {\n    options = {};\n  }\n\n  var showPoints = options.showPoints || true;\n  var pointRadius = options.pointRadius || 2;\n  var showPointLabels = options.showPointLabels || false;\n  var pointLabelOffset = options.pointLabelOffset || 4;\n  var showCurrentLine = options.showCurrentLine || true;\n\n  width = 600;\n  height = 400;\n\n  var margin = {\n      top: 20,\n      right: 20,\n      bottom: 50,\n      left: 40\n  }\n\n  var canvas = {\n    top : margin.top,\n    bottom : height - margin.bottom - margin.top,\n    left : margin.left,\n    right : width - margin.right - margin.left\n  }\n\n  //var predefColors = [\"blue\", \"yellow\", \"red\"];\n\n  var svg = createSvg(container, width, height);\n\n  var tooltipDiv = createTooltip(className);\n\n  var mainSvg = svg\n    .append(\"g\")\n\n  var errorText = createErrorText(svg, width / 2, height / 2);\n\n  this.draw = function(originChartData, colorsData, minMaxData) {\n    var chartData = [];\n    var getPartyColour = PartyColours(colorsData);\n\n    if (!originChartData) {\n      errorText.text(\"chart data is not available\");\n      return;\n    }\n\n    if (!minMaxData.minX) {\n      minMaxData.minX = 0;\n    }\n    if (!minMaxData.maxX) {\n      var maxValue = d3.max(originChartData.map(partyInfo => {\n        return d3.max(partyInfo.data.map(it => it.x));\n      }));\n\n      minMaxData.maxX = Math.min(100, maxValue * 1.5);\n    }\n\n    var x = d3.scaleLinear()\n      .domain([minMaxData.minX, minMaxData.maxX])\n      .range([canvas.left, canvas.right]);\n\n    var y = d3.scaleLinear()\n      .domain([0, 100])\n      .range([canvas.bottom, canvas.top]);\n\n    var radiusScale = d3.scaleLinear()\n      .domain([0, 100])\n      .range([0, 100]);\n    \n    mainSvg.selectAll(\"g\").remove();\n\n    var axisContainer = mainSvg\n      .append(\"g\")\n        .classed(\"axes\", true)\n\n    axisContainer.append(\"g\")\n      .attr(\"transform\", \"translate(0, \" + canvas.bottom + \")\")\n      .classed(\"x-axis\", true)\n      .call(d3.axisBottom(x));\n\n    axisContainer.append(\"g\")\n      .attr(\"transform\", \"translate(\" + canvas.left + \", 0)\")\n      .classed(\"y-axis\", true)\n      .call(d3.axisLeft(y));\n\n    axisContainer.append(\"text\")\n      .text(\"% VDs declared\")\n      .attr(\"transform\", \"translate(\" + x((minMaxData.minX + minMaxData.maxX)/2 ) + \", \" + y(-10) + \")\")\n      .style(\"fill\", \"white\")\n      .attr(\"text-anchor\", \"middle\")\n      .classed(\"x-axis-text\", \"true\")\n      .classed(\"axis-text\", \"true\")\n\n    axisContainer.append(\"text\")\n      .text(\"% Party support\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"transform\", \"rotate(-90) translate(-180, 10)\")\n      .style(\"fill\", \"white\")\n      .classed(\"y-axis-text\", \"true\")\n      .classed(\"axis-text\", \"true\")\n\n    var data = null;\n    var party = null;\n    var lineContainer = null;\n    var legendContainer = null;\n    var eventCaptureContainer = null;\n    var cleaned_party_name = null;\n    var valueline = null;\n\n    originChartData.map(function(party) {\n      valueline = d3.line()\n        .x(function(d) { return x(d.x); })\n        .y(function(d) { return y(d.y); });\n\n      data = party.data;\n      var colour = getPartyColour(party.name);\n\n      lineContainer = mainSvg.append(\"g\")\n        .classed(\"line-container\", true)\n        .classed(party.cleaned_name, true);\n      \n      legendContainer = mainSvg.append(\"g\")\n        .classed(\"ledgends\", true)\n\n      eventCaptureContainer = mainSvg.append(\"g\")\n        .classed(\"event-capture-container\", true)\n        .classed(party.cleaned_name, true);\n\n      lineContainer.append(\"path\")\n        .data([data])\n          .attr(\"class\", \"line\")\n          .attr(\"d\", valueline)\n          .style(\"stroke\", colour)\n\n      if (showPoints) {\n        lineContainer.selectAll(\"circle\")\n          .data(data)\n          .enter()\n          .append(\"circle\")\n            .attr(\"cx\", function(d) { return x(d.x) })\n            .attr(\"cy\", function(d) { return y(d.y) })\n            .attr(\"r\", function(d) { return radiusScale(pointRadius) })\n            .style(\"fill\", colour)\n            .classed(\"graph-points\", true)\n        \n        eventCaptureContainer.selectAll(\"circle\")\n          .data(data)\n          .enter()\n          .append(\"circle\")\n            .attr(\"cx\", function(d) { return x(d.x) })\n            .attr(\"cy\", function(d) { return y(d.y) })\n            .attr(\"r\", function(d) { return radiusScale(pointRadius) * 3 })\n            .style(\"fill\", \"transparent\")\n            .classed(\"graph-points\", true)\n            .on(\"mousemove\", function(d, i) {\t\t\n              console.log(\"tooltip mousemove\");\n              d3.select(this)\n                .attr(\"opacity\", 0.8);\n              tooltipDiv.transition()\t\t\n                  .duration(200)\t\t\n                  .style(\"opacity\", .9);\t\t\n              tooltipDiv.html(d.y.toFixed(2) + \"%\")\n                  .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n            })\t\t\t\t\t\n            .on(\"mouseout\", function(d) {\t\t\n              console.log(\"tooltip mouseout\");\n              d3.select(this)\n                .attr(\"opacity\", 1);\n              tooltipDiv.transition()\t\t\n                .duration(200)\t\t\n                .style(\"opacity\", 0);\t\n            })\n      }\n\n      if (showPointLabels) {\n        lineContainer.selectAll(\"text\")\n          .data(data)\n          .enter()\n          .append(\"text\")\n            .text(function(d) { return d.y})\n            .attr(\"transform\", function(d) {\n              return \"translate(\" +  x(d.x - radiusScale(pointRadius / 2)) + \", \" + y(d.y + pointLabelOffset) + \")\"\n            })\n            .classed(\"graph-labels\", true)\n      }\n\n      // if (options.showLegend) \n      {\n        var parties = [];\n        var partyAbbrs = [];\n        var partyIecIds = [];\n        originChartData.forEach((partyInfo) => {\n          var party = partyInfo.name;\n          if (partyIecIds.indexOf(partyInfo.iecId) === -1 && partyInfo.iecId) {\n              parties.push(party);\n              partyAbbrs.push(partyInfo.abbreviation)\n              partyIecIds.push(partyInfo.iecId);\n          }\n        })\n        \n        function getLegendXY(i) {\n          \n          var xydata = [30 + (i%5)*100, height - 30 + parseInt(i/5) * 40];\n          if (parties.length < 6) {\n            xydata[0] += 100 * ( 6 - parties.length) / 2;\n          }\n          return xydata;\n        }\n        legendContainer.selectAll(`.${className(\"legend\")}`).remove();\n        var legends = legendContainer.selectAll(`.${className(\"legend\")}`)\n            .data(parties)\n            .enter()\n            .append('g')\n            .attr(\"class\", className(\"legend\"))\n            .attr('transform', (d, i) => \"translate(\" + getLegendXY(i) + \")\")\n        legends\n            .append(\"rect\")\n            .attr('width', 10)\n            .attr('height', 10)\n            .attr('x', 0)\n            .attr('y', 0)\n            .attr(\"fill\", (party, i) => {\n                return getPartyColour(party);\n            })\n        legends.append('text')\n            .attr('x', 30)\n            .attr('y', 10)\n            .style('font-size', '12px')\n            .text((party, idx) => partyAbbrs[idx])\n      }\n\n    })\n\n\n\n\n\n     /*\n\n      function getTooltipText(d, i) {\n          return d.name;\n      }\n      */\n    }\n    this.destroy = function() {\n      svg.remove();\n    }\n  }","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"./voteprediction.css\";\nimport {Chart} from \"../VotePredictionLineChart/d3voteprediction\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getVotesPredictionData,\n  getPartyColors\n} from \"../../api\";\nimport {\n  parseVotesPredictionData,\n  parseCSIRTurnoutTimestamp,\n  parseCSIRMinMax,\n  getNationOrProvinceName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\nvar chartOptions = {\n  chartType: 'Votes prediction line charts',\n};\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nfunction formatDate(d) {\n  var hr = d.getHours();\n  var min = d.getMinutes();\n  if (min < 10) {\n      min = \"0\" + min;\n  }\n\n  var date = d.getDate();\n  var months = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n  var month = months[d.getMonth()];\n  var year = d.getFullYear();\n\n  var currentTimeText = hr + \":\" + min + \" on \" + date + \" \" + month + \" \" + year;\n  return currentTimeText;\n}\n\nvar partyColorsData;\n\nclass VotePredictionLineChart extends Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        numParties: 100,\n        electionType: \"national\",\n        eventDescription: \"2019 National Election\",\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 8\n      }\n      this._isMounted = false;\n\n      fetchDataFromOBJ(this.state, props);\n      this.state[\"numParties\"] = 100;\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      this._isMounted = true;\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n        this.draw(this.getContainer(), this.state);\n    }\n\n    componentWillUnmount() {\n      this._isMounted = false;\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n\n      // TODO not sure what to change race-for-seats-horseshoe.... to\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-horseshoe-chart(${getNationOrProvinceName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      if (this._isMounted) {\n        var newState = event.detail;\n        if (this.chart)\n          this.chart.destroy();\n        this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n        this.setState(newState)\n      }\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n\n      const {\n        stylesheetFor,\n        componentID\n      } = this.state;\n\n      var currentTimeText = formatDate(new Date());\n\n      return (\n          <div className={className(\"votepredictionlinechart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {\n                componentID != -1000 && <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName(this.state)}): </div>\n            }\n            <div className={cn(\"vote-prediction-title\")}>\n              <div className={cn(\"projected-turnout\")}> \n                Projected turnout: <span ref=\"projectedTurnout\">10%</span>\n              </div>\n              <div className={cn(\"prediction-time\")}> \n                Predictions at <span ref=\"lastTimestamp\">{currentTimeText}</span>\n              </div>\n            </div>\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n              <div className={cn(\"CSIR-bottom-label\")}><b>CSIR's election prediction  model</b><br/>The CSIR produces predictions of the final results of the election based on a statistical model. The model can provide scientific predictions even if only a small number of voting districts have been declared and therefore can give a reliable early indication of what the final percentages for each party and the voter turnout rates would be.</div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var predictionDataLoader = getVotesPredictionData(props);\n      var dataLoaders = [predictionDataLoader];\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var predictionData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, predictionData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var minMaxData = parseCSIRMinMax(data);\n        var chartData = parseVotesPredictionData(data, props);\n        var {\n          turnout,\n          timestamp\n        } = parseCSIRTurnoutTimestamp(data, props);\n        if (this.refs.projectedTurnout && this.refs.projectedTurnout.innerHTML) {\n          this.refs.projectedTurnout.innerHTML = turnout + \"%\";\n        }\n        if (this.refs.lastTimestamp && this.refs.lastTimestamp.innerHTML) {\n          var lastTimeStampText = formatDate(new Date(timestamp));\n          console.log(\"timestamp\", new Date(timestamp), timestamp, lastTimeStampText);\n          this.refs.lastTimestamp.innerHTML = lastTimeStampText;\n        }\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, partyColorsData, minMaxData);\n    }\n}\n\nexport default VotePredictionLineChart;\n","import * as d3 from \"d3\";\nimport {createTooltip, createSvg, formatPartyName, formatClassNameFromString} from \"../../utils\";\nimport config from \"../../config\"\n\nexport function Chart(container, width, height, className, options) {\n  if (!options) {\n      options = {};\n  }\n  width = 700;\n  height = 250;\n\n    var XaxisOffset = 70;\n    var YaxisOffset = 50;\n    var predefColors = [\"blue\", \"yellow\", \"red\"];\n\n    // TODO not sure what options.viewBox is below - don't see it being used anywhere\n    /*\n    var svg = container.append(\"svg\")\n        .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n        .attr(\"viewBox\", options.viewBox || (\"0 0 \" + (width+XaxisOffset) + \" \" + (height+YaxisOffset)))\n        .classed(\"svg-content\", true);\n    */\n\n    var svg = createSvg(container, width + XaxisOffset, height + YaxisOffset);\n        \n    var tooltipDiv = createTooltip(className);\n  \n    var x = d3.scaleBand()\n      .rangeRound([XaxisOffset, width])\n  \n    var y = d3.scaleLinear()\n      .rangeRound([height, YaxisOffset]);\n\n    svg.append(\"g\")\n      .attr(\"class\", \"x axis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n  \n    svg.append(\"g\")\n      .attr(\"class\", \"y axis\")\n      .attr(\"transform\", \"translate(\" + XaxisOffset +\", 0)\")\n  \n    var errorText = svg.append(\"g\")\n      .attr(\"transform\", \"translate(\"+(width/2)+\",\"+(height/2)+\")\")\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\");\n  \n    this.draw = function(groupChartData, colorsData) {\n\n    svg.selectAll(\".topLabel\").remove();\n    svg.append(\"text\")\n        .attr(\"class\", \"topLabel\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"x\", width/2)\n        .attr(\"y\", 20)\n        .text(options.topLabel);\n\n    if (!groupChartData) {\n        errorText.text(\"chart data is not available\");\n        return;\n    } else {\n        errorText.text(\"\");\n    }\n    var partyColorByName = {};\n    var partyAbbrByName = {};\n    if (colorsData && colorsData[\"data\"][\"allParties\"][\"edges\"]) {\n      colorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n        partyColorByName[edge.node.name] = edge.node.colour;\n        partyAbbrByName[edge.node.name] = edge.node.abbreviation;\n      })\n    }   \n\n      function getFillColorFromPartyName(partyName, i) {\n        return partyColorByName[partyName.split(\"/\")[0]] || predefColors[i%predefColors.length];\n      }\n\n      function getFillColor(d, i) {\n          return getFillColorFromPartyName(d.partyInfo.name, i);\n      }\n\n      function getTooltipText(d, i) {\n        if (options.noXaxisByParty) {\n          return d.name + \" : \" + options.yValueFormat(options.yValue(d));\n        } else {\n          return formatPartyName(d.partyInfo.name) + \" : \" + options.yValueFormat(options.yValue(d));\n        }\t\n      }\n\n      x.domain(groupChartData.map(item => item.eventDescription));\n\n      var minMaxY = [0, 100];\n      if (options.dynamicYAxisFromValues) {\n        minMaxY[1] = Math.min(100, d3.max(groupChartData.map(item => d3.max(item.data, function(d) { return parseFloat(options.yValue(d)); }))) * 1.5);\n      }\n      y.domain(minMaxY);\n\n      var availableParties = \n \n      svg.select(\".x.axis\").transition().duration(300).call(d3.axisBottom(x));\n      svg.select(\".y.axis\").transition().duration(300).call(d3.axisLeft(y)\n        .ticks(4)\n        .tickFormat(function(d) { return options.yValueFormat(d); })\n      )\n\n      svg.selectAll(`.bar-group`).remove();\n      var groupSvgs = svg.selectAll(`.bar-group`).data(groupChartData);\n      groupSvgs.exit()\n        .transition()\n        .duration(300)\n        .style(\"fill-opacity\", 1e-6)\n        .remove();\n    \n      var groupSvg = groupSvgs.enter()\n        .append(\"g\")\n        .attr(\"class\", d => `bar-group ${formatClassNameFromString(d.eventDescription)}`)\n        .attr(\"transform\", (d) => `translate(${x(d.eventDescription) + x.bandwidth()*1/20}, 0)`);\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"bar-container\");\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"bartext-container\");\n      \n      for (var i = 0; i < groupChartData.length; i ++) {\n        var eventDescription = groupChartData[i].eventDescription;\n        var chartData = groupChartData[i].data;\n\n        var subX = d3.scaleBand()\n          .rangeRound([0, x.bandwidth()*9/10])\n          .domain(chartData.map(function (d) {\n            return d.name;\n          }));\n\n        var groupSvg = svg.selectAll(`.bar-group.${formatClassNameFromString(eventDescription)}`);\n\n        var barSvg = groupSvg.select(\".bar-container\");\n        var barTextSvg = groupSvg.select(\".bartext-container\");\n\n        var bars = barSvg.selectAll(`.${className(\"bar\")}`).data(chartData);\n  \n        bars.exit()\n          .transition()\n          .duration(300)\n          .attr(\"y\", function(d) {\n            return y(0);\n          })\n          .attr(\"height\", 0)\n          .style(\"fill-opacity\", 1e-6)\n          .remove();\n        \n    \n        bars.enter()\n            .append(\"rect\")\n            .attr(\"class\", (d) => className(\"bar\") + \" bar_\" + d.name)\n            .attr(\"x\", function (d, i) {\n              return subX(d.name)+subX.bandwidth()/4;\n            })\n            .attr(\"width\", subX.bandwidth()*1/2)\n            .attr(\"fill\", (d,i) => getFillColor(d, i))\n            .on(\"mousemove\", function(d, i) {\t\t\n                d3.select(this)\n                  .attr(\"opacity\", 0.8);\n                tooltipDiv.transition()\t\t\n                    .duration(200)\t\t\n                    .style(\"opacity\", .9);\t\t\n                tooltipDiv.html(getTooltipText(d, i))\n                    .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n                })\t\t\t\t\t\n            .on(\"mouseout\", function(d) {\t\t\n                d3.select(this)\n                  .attr(\"opacity\", 1);\n                tooltipDiv.transition()\t\t\n                    .duration(200)\t\t\n                    .style(\"opacity\", 0);\t\n            })\n            .attr(\"y\", function(d) {\n              return y(0);\n            })\n            .attr(\"height\", 0)        \n    \n          barSvg.selectAll(`.${className(\"bar\")}`).data(chartData)\n            .attr(\"fill\", (d, i) => getFillColor(d, i))\n            .transition()\n            .duration(300)\n            .attr(\"y\", function (d) {\n              return y(Number(options.yValue(d)));\n            })\n            .attr(\"height\", function (d) {\n              return height - y(Number(options.yValue(d)));\n            })\n\n          var barTexts = barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData);\n          barTexts.exit()\n            .transition()\n            .duration(300)\n            .attr(\"y\", function(d) {\n              return y(0) - 5;\n            })\n            .style(\"fill-opacity\", 1e-6)\n            .remove();\n    \n          barTexts.enter().append(\"text\")\n            .attr(\"class\", className(\"bartext\"))\n            .attr(\"x\", function (d) {\n              return subX(d.name)+subX.bandwidth()/2;\n            })\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", \"7px\")\n            .attr(\"y\", function(d) {\n              return y(0) - 5;\n            })\n          barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData)\n            .text(function(d) {\n              return options.yValueFormat(options.yValue(d));\n            })\n            .transition()\n            .duration(300)\n            .attr(\"y\", function (d) {\n              return y(Number(options.yValue(d))) - 5;\n            })\n          \n          var parties = [];\n          var partyIecIds = [];\n          groupChartData.forEach(({data: chartData}) => {\n            chartData.forEach(({partyInfo}) => {\n              var party = partyInfo.name;\n              if (partyIecIds.indexOf(partyInfo.iecId) == -1) {\n                  parties.push(party);\n                  partyIecIds.push(partyInfo.iecId);\n              }\n            })\n          })\n          \n          function getLegendXY(i) {\n              return [XaxisOffset + (i%5)*100, height + 30 + parseInt(i/5) * 40];\n          }\n          svg.selectAll(`.${className(\"legend\")}`).remove();\n          var legends = svg.selectAll(`.${className(\"legend\")}`)\n              .data(parties)\n              .enter()\n              .append('g')\n              .attr(\"class\", className(\"legend\"))\n              .attr('transform', (d, i) => \"translate(\" + getLegendXY(i) + \")\")\n          legends\n              .append(\"rect\")\n              .attr('width', 10)\n              .attr('height', 10)\n              .attr('x', 0)\n              .attr('y', 0)\n              .attr(\"fill\", (party, i) => {\n                  return getFillColorFromPartyName(party);\n              })\n          legends.append('text')\n              .attr('x', 30)\n              .attr('y', 10)\n              .attr('fill', 'currentColor')\n              .style('font-size', '12px')\n              .text(party => partyAbbrByName[party])\n      }\n    }\n    this.destroy = function() {\n      svg.remove();\n    }\n  }","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../SplitNatProv/d3groupbarchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getVotesDataForAllEvents,\n  getPartyColors,\n  getProvincesData\n} from \"../../api\";\nimport {\n  parseVotesDataForAllEvents,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\nvar provincesData = getProvincesData();\n\nvar dataRefreshTime = 30 * 1000;\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nvar chartOptions = {\n  topLabel: \"NATIONAL ASSEMBLY: 2009, 2014, 2019\",\n  usedValue: \"% VDS COUNTED\",\n  yValue: d => d.percOfVotes,\n  yValueFormat: value => value + '%',\n  dynamicYAxisFromValues: false\n}\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        numPartiesSplitNatProv: 3,\n        eventDescriptionsSplitNatProv: [\n          // \"National Elections 1999\",\n          // \"Provincial Elections 1999\",\n          // \"14 Apr 2004 National Election\",\n          // \"14 Apr 2004 Provincial Election\",\n          // \"22 Apr 2009 National Election\",\n          // \"22 Apr 2009 Provincial Election\",\n          \"2014 National Election\",\n          \"2014 Provincial Election\",\n          \"2019 NATIONAL ELECTION\",\n          \"2019 PROVINCIAL ELECTION\",\n        ],\n        regionType: \"province\",\n        provinceName: \"Western Cape\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 18\n      }\n\n      console.log(\"SplitNatProv state and props\", this.state, props)\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      if (this.chart) {\n        this.chart.destroy();\n        this.chart = null;\n      }\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-votes-comparison-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor\n      } = this.state;\n      return (\n          <div className={cn(\"groupbarchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var votesDataLoader = getVotesDataForAllEvents(props);\n      var dataLoaders = [votesDataLoader];\n\n      chartOptions.topLabel = `${getRegionName(props)} Race for Votes - Split (Nat/Prov)`;\n      if (this.state.componentID == -1000) {\n        chartOptions.topLabel = ``;\n      }\n      \n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var votesData = values[0];\n        partyColorsData = partyColorsData || values[1];          \n        self.drawGraph(container, props, votesData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseVotesDataForAllEvents(data, props);\n        // console.log(\"SplitNatProvProps\", props);\n        // console.log(\"SplitNatProvData\", data);\n        // console.log(\"SplitNatProvParsed\", chartData);\n\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport MetisMenu from 'react-metismenu';\n\nimport config from '../../config'\nimport styles from \"./navbar.css\";\nimport events from \"../../events\";\nimport {\n    getProvincesData,\n    getMetrosData\n} from \"../../api\";\n\nimport {\n    triggerCustomEvent,\n    fetchDataFromOBJ\n} from \"../../utils\";\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cssPrefix(originName) {\n    return config.CSS_PREFIX+originName;\n}\n\nvar provincesData = getProvincesData();\nvar metrosData = getMetrosData();\n\nclass CustomLink extends React.Component {\n    constructor() {\n      super();\n  \n      this.onClick = this.onClick.bind(this);\n    }\n  \n    onClick(e) {\n      if (this.props.hasSubMenu) this.props.toggleSubMenu(e);\n      else {\n        this.props.activateMe({\n          newLocation: this.props.to,\n          selectedMenuLabel: this.props.label,\n        });\n      }\n    }\n  \n    render() {\n      if (this.props.hasSubMenu) {\n        return (\n          <div className=\"metismenu-link\" onClick={this.onClick}>\n            {this.props.children}\n          </div>\n      )} else {\n        return (\n          <div className=\"metismenu-link metismenu-end\" onClick={this.onClick}>\n            {this.props.children}\n          </div>\n        );\n      }\n    }\n  };\n\nclass NavBar extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            eventDescription: \"2019 National Election\",\n            nationalEventDescription: \"2019 National Election\",\n            provincialEventDescription: \"2019 Provincial Election\",\n            regionType: \"national\",\n            provinceName: \"\",\n            muniName: \"\",\n            muniCode: \"\",\n            iecId: \"\",\n            comp: \"Race for Votes\",\n            activeLinkId: ''\n        }\n\n        fetchDataFromOBJ(this.state, props);\n\n        if (props.regionType) {\n            this.state.regionType = props.regionType;\n        }\n        if (props.provinceName) {\n            this.state.provinceName = props.provinceName;\n        }\n        if (props.muniName) {\n            this.state.muniName = props.muniName;\n        }\n        this.handleNavBarSelection = this.handleNavBarSelection.bind(this);\n    }\n\n    componentDidMount() {\n        if(!document.getElementById('navbarcss')) {\n            var link = document.createElement('link');\n            link.id = 'navbarcss';\n            link.rel = 'stylesheet';\n            link.href = config.DOMAIN + '/navbar.css';\n            document.head.appendChild(link);\n        }\n\n        if(!document.getElementById('font-awesome')) {\n            var link = document.createElement('link');\n            link.id = 'font-awesome';\n            link.rel = 'stylesheet';\n            link.href = \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\";\n            document.head.appendChild(link);\n        }\n\n        this.refs.navbar.addEventListener(\"click\", this.handleNavBarSelection);\n    }\n\n    componentWillUnmount() {\n        this.refs.navbar.removeEventListener(\"click\", this.handleNavBarSelection);\n    }\n\n    componentDidUpdate() {\n    }\n\n    handleNavBarSelection(e) {\n        if (e.target.className.indexOf(\"metismenu-link\") == -1) {\n            return;\n        }\n        if (this.activeElement && this.activeElement.classList && this.activeElement.classList.remove) {\n            this.activeElement.classList.remove(\"active\");\n        }\n        e.target.classList.add(\"active\");\n        this.activeElement = e.target;\n\n        var iconClass = e.target.childNodes[0].className;\n        var classList = iconClass.split(' ');\n        var lastClass = classList[classList.length - 1];\n        console.log(\"handleNavBarSelection\", lastClass);\n        var passInfo = lastClass.split('-');\n        var enableMap = true;\n        var enableBarChart = true\n        var enableTurnoutProgressSpoilt = true;\n\n        var eventDescription, electionType, regionType, selectionData = {}, chartType = \"\";\n        var activeLinkId = passInfo.slice(1, passInfo.length).join('-');\n\n        console.log(\"activeLinkId\", activeLinkId);\n\n        if (passInfo[1] == '1') {\n            eventDescription = this.state.nationalEventDescription;\n            regionType = \"national\";\n            if (passInfo[2] == '1') {\n                switch (passInfo[3]) {\n                    case '1':\n                        chartType = \"votes-default\";\n                        break;\n                    case '2':\n                        chartType = \"votes-comparisons\";\n                        enableMap = false;\n                        break;\n                    case '3':\n                        chartType = \"votes-predictions\";\n                        enableMap = false;\n                        enableTurnoutProgressSpoilt = false;\n                        // if (passInfo[4] > 0) {\n                        //     regionType = \"province\";\n                        //     selectionData = provincesData[passInfo[4]-1];\n                        // }\n                        break;\n                    case '4':\n                        chartType = \"votes-progress\";\n                        break;\n                    case '5':\n                        chartType = \"votes-turnout\";\n                        break;\n                    case '6':\n                        chartType = \"votes-split\";\n                        enableMap = false;\n                        break;\n                    case '7':\n                        chartType = \"votes-myvd\";\n                        break;\n                    default:\n                        return;\n                }\n            } else if (passInfo[2] == '2') {\n                switch (passInfo[3]) {\n                    case '1':\n                        chartType = \"seats-default\";\n                        enableMap = false;\n                        break;\n                    case '2':\n                        chartType = \"seats-comparisons\";\n                        enableMap = false;\n                        break;\n                    case '3':\n                        chartType = \"seats-electeds\";\n                        break;\n                    case '4':\n                        chartType = \"seats-women\";\n                        break;\n                    case '5':\n                        chartType = \"seats-age\";\n                        break;\n                    default:\n                        return;\n                }\n            } else if (passInfo[3] == '4') {\n                // Main page for National Assembly\n                chartType = \"votes-default\";\n            } else {\n                return;\n            }\n        } else if (passInfo[1] == '2') {\n            eventDescription = this.state.provincialEventDescription;\n            regionType = \"province\";\n            selectionData = provincesData[passInfo[2]];\n            if (passInfo[3] == '1') {\n                switch (passInfo[4]) {\n                    case '1':\n                        chartType = \"votes-default\"; // done\n                        break;\n                    case '2':\n                        chartType = \"votes-comparisons\";\n                        enableMap = false;\n                        break;\n                    case '3':\n                        chartType = \"votes-progress\"; // done\n                        break;\n                    case '4':\n                        chartType = \"votes-turnout\";// done\n                        break;\n                    case '5':\n                        chartType = \"votes-split\";\n                        enableMap = false;\n                        break;\n                    case '6':\n                        chartType = \"votes-predictions\";\n                        enableMap = false;\n                        enableTurnoutProgressSpoilt = false;\n                        break;\n                    default:\n                        return;\n                }\n            } else if (passInfo[3] == '2') {\n                switch (passInfo[4]) {\n                    case '1':\n                        chartType = \"seats-default\"; // done\n                        enableMap = false;\n                        break;\n                    case '2':\n                        chartType = \"seats-comparisons\";\n                        enableMap = false;\n                        break;\n                    case '3':\n                        chartType = \"seats-electeds\";\n                        break;\n                    case '4':\n                        chartType = \"seats-women\";\n                        break;\n                    case '5':\n                        chartType = \"seats-age\";\n                        break;\n                    default:\n                        return;\n                }\n\n            } else if (passInfo[3] == '4') {\n                // Main page for National Legislature\n                regionType = \"national\";\n                chartType = \"votes-default\";\n                electionType = \"provincial\"\n                enableBarChart = false;\n            } else {\n                return;\n            }\n        } else if (passInfo[1] == '3') { // metros\n            eventDescription = this.state.nationalEventDescription;\n            regionType = \"municipality\"\n            selectionData = metrosData[passInfo[2]];\n            chartType = \"votes-default-metro\";\n        } else {\n            return;\n        }\n\n        if (!chartType)\n            return;\n\n        if (eventDescription)\n            if (eventDescription.toLowerCase().indexOf(\"provincial\") >= 0) {\n                electionType = \"provincial\"\n            }\n        else {\n            electionType = \"national\"\n        }\n\n        e.preventDefault();\n        var newState;\n        if (regionType == \"national\") {\n            newState = {\n                regionType: regionType\n            };\n            // if (this.state.regionType == newState.regionType \n            //     && this.state.comp == chartType)\n            //     return;\n        } else if (regionType == \"province\") {\n            newState = {\n                regionType: regionType,\n                provinceName: selectionData.name\n            };\n            // if (this.state.regionType == newState.regionType \n            //     && this.state.provinceName == newState.provinceName \n            //     && this.state.comp == chartType)\n            //     return;\n        } else if (regionType == \"municipality\") {\n            newState = {\n                regionType: regionType,\n                provinceName: selectionData.provinceName,\n                muniName: selectionData.muniName,\n                muniCode: selectionData.muniCode,\n            }; \n            // if (this.state.regionType == newState.regionType \n            //     && this.state.provinceName == newState.provinceName\n            //     && this.state.muniName == newState.muniName\n            //     && this.state.comp == chartType)\n            //     return;\n        }\n        newState.eventDescription = eventDescription;\n        newState.electionType = electionType\n        newState.comp = chartType;\n        newState.enableMap = enableMap;\n        newState.enableBarChart = enableBarChart;\n        newState.enableTurnoutProgressSpoilt = enableTurnoutProgressSpoilt;\n\n        console.log(\"newState\", newState);\n\n        if (newState.comp == \"votes-myvd\") {\n            newState.regionType = \"municipality-vd\";\n            newState.iecId = \"\";\n        }\n\n        if (newState.comp == \"seats-electeds\") {\n            window.open(\"http://elections.sabc.co.za/candidates/\");\n            return;\n        }\n        if (newState.comp == \"seats-electeds\" || newState.comp == \"seats-women\" || newState.comp == \"seats-age\") {\n            // triggerCustomEvent(events.SEATS_ELECTEDS_EVENT, newState);\n            return;\n        }\n\n        triggerCustomEvent(events.QUICK_RESULTS_PREVIEW, newState);\n        // triggerCustomEvent(events.REGION_CHANGE, newState);\n        // triggerCustomEvent(events.MAP_PREVIEW, newState);\n\n        newState.activeLinkId = activeLinkId;\n        console.log(\"newState\", newState);\n        this.setState(newState);\n    }\n      \n    render () {\n        var content = [\n            {\n                label: 'National Assembly',\n                content: [\n                    {\n                        label: \"Race for votes\",\n                        content: [\n                            {\n                                id: `1-1-1`,\n                                icon: `1-1-1`,\n                                label: `National assembly`,\n                                to: `1-1-1`,\n                            },\n                            {\n                                id: `1-1-2`,\n                                icon: `1-1-2`,\n                                label: `Comparisons`,\n                                to: `1-1-2`,\n                            },\n                            {\n                                icon: `1-1-3`,\n                                label: `CSIR predictions`,\n                                to: `1-1-3`,\n                                // content: [\n                                //     {\n                                //         icon: `1-1-3-0`,\n                                //         label: `National Assembly`,\n                                //         to: `1-1-3-0`,\n                                //     },\n                                //     ...provincesData.map((province, i) => {\n                                //         return {\n                                //             icon: `1-1-3-${i+1}`,\n                                //             label: province.name,\n                                //             to: `1-1-3-${i+1}`,\n                                //         }\n                                //     })\n                                // ]\n                            },\n                            {\n                                icon: `1-1-4`,\n                                label: `Counting progress`,\n                                to: `1-1-4`,\n                            },\n                            {\n                                icon: `1-1-5`,\n                                label: `Turnout`,\n                                to: `1-1-5`,\n                            },\n                            {\n                                icon: `1-1-7`,\n                                label: `My voting District`,\n                                to: `1-1-7`,\n                            },\n                            {\n                                label: `Metros`,\n                                icon: `3-2`, // Setting default metros view to JHB\n                                content: metrosData.map((metro, i) => {\n                                    return {\n                                        icon: `3-${i}`,\n                                        label: metro.muniName.split(\"-\")[1].split(\"[\")[0],\n                                        to: `3-${i}`,\n                                    }\n                                })\n                            },\n                        ]\n                    },\n                    {\n                        label: \"Race for seats\",\n                        content: [\n                            {\n                                icon: `1-2-1`,\n                                label: `National assembly`,\n                                to: `1-2-1`\n                            },\n                            {\n                                icon: `1-2-2`,\n                                label: `Comparisons`,\n                                to: `1-2-2`,\n                            },\n                            {\n                                icon: `1-2-3`,\n                                label: `Candidates`,\n                                to: `1-2-3`,\n                            },\n                            // {\n                            //     icon: `1-2-4`,\n                            //     label: `Women`,\n                            //     to: `1-2-4`,\n                            // },\n                            // {\n                            //     icon: `1-2-5`,\n                            //     label: `Age`,\n                            //     to: `1-2-5`,\n                            // }\n                        ]\n                    }\n                ]\n            },\n            {\n                label: 'Provincial Legislature',\n                content: provincesData.map((province, i) => {\n                    return {\n                        label: province.name,\n                        content: [\n                            {\n                                label: \"Race for votes\",\n                                content: [\n                                    {\n                                        icon: `2-${i}-1-1`,\n                                        label: `Provincial legislature`,\n                                        to: `2-${i}-1-1`,\n                                    },\n                                    {\n                                        icon: `2-${i}-1-2`,\n                                        label: `Comparisons`,\n                                        to: `2-${i}-1-2`,\n                                    },\n                                    {\n                                        icon: `2-${i}-1-3`,\n                                        label: `Counting progress`,\n                                        to: `2-${i}-1-3`,\n                                    },\n                                    {\n                                        icon: `2-${i}-1-4`,\n                                        label: `Turnout`,\n                                        to: `2-${i}-1-4`,\n                                    },\n                                    {\n                                        icon: `2-${i}-1-5`,\n                                        label: `Split (Nat/Prov)`,\n                                        to: `2-${i}-1-5`,\n                                    },\n                                    {\n                                        icon: `2-${i}-1-6`,\n                                        label: `CSIR Predictions`,\n                                        to: `2-${i}-1-6`,\n                                    },\n                                ]\n                            },\n                            {\n                                label: \"Race for seats\",\n                                content: [\n                                    {\n                                        icon: `2-${i}-2-1`,\n                                        label: `Provincial legislature`,\n                                        to: `2-${i}-2-1`,\n                                    },\n                                    {\n                                        icon: `2-${i}-2-2`,\n                                        label: `Comparisons`,\n                                        to: `2-${i}-2-2`,\n                                    },\n                                    {\n                                        icon: `2-${i}-2-3`,\n                                        label: `Candidates`,\n                                        to: `2-${i}-2-3`,\n                                    },\n                                    // {\n                                    //     icon: `2-${i}-2-4`,\n                                    //     label: `Women`,\n                                    //     to: `2-${i}-2-4`,\n                                    // },\n                                    // {\n                                    //     icon: `2-${i}-2-5`,\n                                    //     label: `Age`,\n                                    //     to: `2-${i}-2-5`,\n                                    // }\n                                ]\n                            }\n                        ]\n                    }\n                })\n            },\n            // {\n            //     icon: '',\n            //     label: 'Metros',\n                // content: metrosData.map((metro, i) => {\n                //     return {\n                //         icon: `4-${i}`,\n                //         label: metro.muniName.split(\"-\")[1].split(\"[\")[0],\n                //         to: `4-${i}`,\n                //         // content: toShowCharts.map((toshowchart, chartIdx) => {\n                //         //     return {\n                //         //         icon: `4-${i}-${chartIdx}`,\n                //         //         label: toshowchart,\n                //         //         to: `4-${i}-${chartIdx}`,\n                //         //     }\n                //         // })\n                //     }\n                // })\n            // }\n        ];\n        // this.state.activeLinkId\n        \n        return (\n            <div className={[className(cssPrefix(\"menu-widget\")), cssPrefix(\"menu-widget\")].join(\" \")} ref=\"navbar\">\n                <MetisMenu activeLinkTo={`1-2-1`} content={content} LinkComponent={CustomLink}/>\n            </div>\n        )\n    }\n}\n\nexport default NavBar;\n","import React, { Component } from \"react\";\nimport styles from \"./quickResultsWidget.css\";\n\nimport config from '../../config'\nimport events from \"../../events\";\n\nimport BarChart from '../BarChart/barchart';\n\nimport ProgressVotesPieChart from '../ProgVotesCountPiechart/piechart';\n\nimport RaceForSeatDonut from '../RaceForSeatDonut/piechart';\nimport VoteCompBarchart from '../VoteCompBarchart/barchart';\nimport SeatCompBarchart from '../SeatCompBarchart/barchart';\nimport SeatHorseShoeChart from \"../SeatHorseShoeChart/horseshoe\";\nimport VotePredictionLineChart from \"../VotePredictionLineChart/voteprediction\";\n\nimport SpoiltBarChart from '../SpoiltBarchart/barchart';\nimport SplitNatProvChart from '../SplitNatProv/barchart';\n\nimport TurnoutBarchart from '../TurnoutBarchart/barchart';\nimport TurnoutMap from '../TurnoutMap/map';\n\nimport NavBar from '../NavBar/navbar';\nimport Map from '../Map/map';\n\nimport {saveAs} from \"file-saver\";\n\nimport {\n    getSpoiltData,\n    getTurnoutDataForOneEvent,\n    getProgressVotesCount,\n    getVotesDataM,\n    getSeatsData\n} from \"../../api\";\n\nimport {\n    getRegionName,\n    getRegionName2,\n    getRegionName4,\n\n    getNationalProvincialStr,\n    getNationalProvincialStr2,\n    getNationalProvincialStr3,\n    getNationalProvincialStr4,\n\n    triggerCustomEvent,\n    fetchDataFromOBJ,\n    handleRegionChange,\n\n    parseSpoiltVotesData,\n    parseTurnoutDataForOneEvent,\n    parseProgressVotesCount,\n    parseVotesData,\n    parseSeatsData,\n\n    getSeatsCount\n} from \"../../utils\";\n\nvar dataRefreshTime = 30 * 1000;\n\nfunction className(originName) {\n    return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n    return className(config.CSS_PREFIX + originName);\n}\n\nclass QuickResultsWidget extends Component {\n    constructor(props) {\n        super(props);\n        this._isMounted = false;\n        this.state = {\n            numParties: 5,\n            electionType: \"national\",\n            eventDescription: \"2019 National Election\",\n            nationalEventDescription: \"2019 National Election\",\n            provincialEventDescription: \"2019 Provincial Election\",\n            regionType: \"national\",\n            provinceName: \"\",\n            muniName: \"\",\n            muniCode: \"\",\n            iecId: \"65010035\", // regionIecId\n            comp: \"votes-default\",\n            stylesheetFor: \"web\",\n            componentID: 5,\n            enableBarChart: true,\n            enableMap: true,\n            enableTurnoutProgressSpoilt: true,\n\n            partyAbbrs: [\"ANC\", \"DA\", \"EFF\", \"ID\"],\n            partyIecIds: [null, null, null, null],        \n            eventDescriptions: {\n                national : [\n                    \"2019 NATIONAL ELECTION\",\n                    \"2014 National Election\",\n                    \"22 Apr 2009 National Election\",\n                    \"14 Apr 2004 National Election\",\n                    //\"National Elections 1999\",\n                ],\n                provincial : [\n                    // \"Provincial Elections 1999\",\n                    \"2019 PROVINCIAL ELECTION\",\n                    \"2014 Provincial Election\",\n                    \"22 Apr 2009 Provincial Election\",\n                    \"14 Apr 2004 Provincial Election\",\n                ]\n            },\n            eventDescriptionsSplitNatProv: [\n                // \"National Elections 1999\",\n                // \"Provincial Elections 1999\",\n                // \"14 Apr 2004 National Election\",\n                // \"14 Apr 2004 Provincial Election\",\n                // \"22 Apr 2009 National Election\",\n                // \"22 Apr 2009 Provincial Election\",\n                \"2019 NATIONAL ELECTION\",\n                \"2019 PROVINCIAL ELECTION\",\n                \"2014 National Election\",\n                \"2014 Provincial Election\",\n            ],\n            currentTurnout: 0,\n            currentCountingProg: 0,\n            currentSpoiltVotes: 0\n        }\n        fetchDataFromOBJ(this.state, props);\n\n        this.refreshIntervalID = 0;\n        this.exportAsPNG = this.exportAsPNG.bind(this);\n        this.handleRegionChange = handleRegionChange.bind(this);\n        this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n        var self = this;\n        this.refreshIntervalID = setInterval(() => {\n            self.fetchCurrentResultData(false);\n        }, dataRefreshTime);\n\n        document.addEventListener(events.EXPORT_SUPERWIDGET_PNG, this.exportAsPNG);\n        document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n        document.addEventListener(events.QUICK_RESULTS_PREVIEW, this.handlePreviewEvent);\n\n        document.addEventListener(events.SEATS_ELECTEDS_EVENT, this.handleSeatsElectedsEvent); // \"seats-electeds-event\"\n\n        this.fetchCurrentResultData(false);\n    }\n  \n    componentWillUnmount() {\n        this._isMounted = false;\n        document.removeEventListener(events.EXPORT_SUPERWIDGET_PNG, this.exportAsPNG);\n        document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n        document.removeEventListener(events.QUICK_RESULTS_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n      this.fetchCurrentResultData(true)\n    }\n\n    handleSeatsElectedsEvent(event) {\n    }\n\n    fetchCurrentResultData(showLoadingIcon) {\n        var self = this;\n        var newProps = JSON.parse(JSON.stringify(this.state));\n        var {comp, iecId} = this.state;\n\n        if (showLoadingIcon) {\n            console.log(\"showLoadingIcon\");\n            if (self.refs.currentTurnout)\n                self.refs.currentTurnout.innerHTML = \"--\";\n            if (self.refs.currentCountingProg)\n                self.refs.currentCountingProg.innerHTML = \"--\";\n            if (self.refs.currentSpoiltVotes)\n                self.refs.currentSpoiltVotes.innerHTML = \"--\";\n        }\n\n        function dataLoadCallback(values) {\n            var spoiltData = values[0];\n            var turnoutData = values[1];\n            var progVotesData = values[2];\n\n            var parsedSpoiltData = parseSpoiltVotesData(spoiltData, newProps);\n            var parsedTurnoutData = parseTurnoutDataForOneEvent(turnoutData, newProps);\n            var parsedProgVotesData = parseProgressVotesCount(progVotesData, newProps);\n\n            var newState;\n            if (parsedTurnoutData[0] && parsedProgVotesData[0] && parsedSpoiltData[1]) {\n                newState = {            \n                    currentTurnout: parsedTurnoutData[0].percVoterTurnout,\n                    currentCountingProg: parsedProgVotesData[0].percent,\n                    currentSpoiltVotes: parsedSpoiltData[1].percent\n                };\n            } else {\n                newState = {            \n                    currentTurnout: 0,\n                    currentCountingProg: 0,\n                    currentSpoiltVotes: 0\n                };\n            }\n\n            if (comp == 'votes-comparisons') {\n                var votesData = values[3];\n                var parsedVotesData = parseVotesData(votesData, newProps);\n                newState.partyAbbrs = parsedVotesData.map(voteItem => voteItem.name);\n                newState.partyIecIds = parsedVotesData.map(voteItem => voteItem.iecId);\n            } else if (comp == 'seats-comparisons') {\n                var seatsData = values[3];\n                var parsedSeatsData = parseSeatsData(seatsData, newProps);\n                newState.partyAbbrs = parsedSeatsData.map(seatItem => seatItem.name);\n                newState.partyIecIds = parsedSeatsData.map(seatItem => seatItem.iecId);\n            }\n\n            if (newState.partyIecIds && newState.partyIecIds.join(\" \") != self.state.partyIecIds.join(\" \")) {\n                self.setState(newState);\n            } else {\n                if (self.refs.currentTurnout) {\n                    self.refs.currentTurnout.innerHTML = newState.currentTurnout + \"%\";\n                }\n                if(self.refs.currentCountingProg) {\n                    self.refs.currentCountingProg.innerHTML = newState.currentCountingProg + \"%\";\n                } \n                if (self.refs.curCountingProg && self.refs.curCountingProg.innerHTML  && self._isMounted) {\n                    console.log(\"self.refs.curCountingProg\", self.refs.curCountingProg, self._isMounted);\n                    self.refs.curCountingProg.innerHTML = newState.currentCountingProg + \"%\";\n                }\n                if (self.refs.currentSpoiltVotes) {\n                    self.refs.currentSpoiltVotes.innerHTML = newState.currentSpoiltVotes + \"%\";\n                }\n            }\n        }\n\n        if (newProps.regionType == \"municipality-vd\" && (!iecId || !iecId.length)) {\n            if (self.refs.currentTurnout)\n                self.refs.currentTurnout.innerHTML = \"--\";\n            if (self.refs.currentCountingProg)\n                self.refs.currentCountingProg.innerHTML = \"--\";\n            if (self.refs.currentSpoiltVotes)\n                self.refs.currentSpoiltVotes.innerHTML = \"--\";\n            return;\n        }\n\n        // newProps.eventDescription = \"2019_mock1\";\n        var dataLoaders = [\n            getSpoiltData(newProps), \n            getTurnoutDataForOneEvent(newProps),\n            getProgressVotesCount(newProps),\n        ];\n\n        if (comp == 'votes-comparisons') {\n            dataLoaders.push(getVotesDataM(newProps));\n        }\n        if (comp == 'seats-comparisons') {\n            dataLoaders.push(getSeatsData(newProps));\n        }\n\n        Promise.all(dataLoaders)\n            .then(dataLoadCallback)\n            .catch(error => console.error(\"catched error\", error));\n    }\n\n    exportAsPNG(event) {\n        var targetState = event.detail;\n        if (targetState.componentID != this.state.componentID)\n          return;\n        var {\n            comp\n        } = this.state;\n        var self = this;\n        var zipfileName = `quick-results-widget-${comp.replace(/\\s/gi, '-')}(${getRegionName(self.state)})`;\n        var imageLoadPromises = [];\n        if (comp == 'votes-comparisons' || comp == 'seats-comparisons') {\n            imageLoadPromises = [\n                ...this.barchartInstances.map(instance => instance.exportAsPNGUri()),\n                this.mapInstance.exportAsPNGUri()\n            ];\n        } else {\n            imageLoadPromises = [\n                this.barchartInstance.exportAsPNGUri(), \n                this.mapInstance.exportAsPNGUri()\n            ];\n        }\n        Promise.all(imageLoadPromises).then(values => {\n            var zip = new window.JSZip();\n\n            var imgs = zip.folder(zipfileName);\n            values.forEach((element, idx) => {\n                imgs.file(`image${idx+1}.png`, element, {base64: true});\n            });\n\n            zip.generateAsync({type:\"blob\"})\n            .then(function(content) {\n                saveAs(content, `${zipfileName}.zip`);\n            });\n        }).catch(error => {\n            console.error(\"export error\", error);\n        })\n    }\n\n    handlePreviewEvent(event) {\n\n      if (this._isMounted) {\n        var newState = event.detail;\n        if (newState.regionType == \"national\" && this.state.comp == \"votes-split\") {\n            newState.regionType = \"province\";\n            newState.provinceName = this.state.provinceName || \"Western Cape\";\n        }\n        this.setState(newState);\n\n        var triggerState = JSON.parse(JSON.stringify(newState));\n        triggerState.componentID = -1000;\n\n        triggerCustomEvent(events.CHART_PREVIEW, triggerState);\n        triggerCustomEvent(events.MAP_PREVIEW, triggerState);\n      }\n    };\n\n    renderTurnoutProgressSpoilt() {\n        var {\n            comp,\n            currentTurnout,\n            currentCountingProg,\n            currentSpoiltVotes,\n        } = this.state;\n\n        if (comp == 'votes-turnout' || comp == 'votes-progress') {\n            return null;\n        }\n\n        return (\n            <div className={cn(\"current-progress\")}>\n                <div className={cn(\"current-turnout\")}>\n                    <div>Turnout</div>\n                    <div ref=\"currentTurnout\">{currentTurnout}%</div>\n                </div>\n                <div className={cn(\"current-counting-progress\")}>\n                    <div>Counting Progress</div>\n                    <div ref=\"currentCountingProg\">{currentCountingProg}%</div>\n                </div>\n                <div className={cn(\"current-spoilt-votes\")}>\n                    <div>Spoilt Votes</div>\n                    <div ref=\"currentSpoiltVotes\">{currentSpoiltVotes}%</div>\n                </div>\n            </div>\n        )\n    }\n\n    renderQuickResultsTitle() {\n        var {\n            comp,\n            currentCountingProg\n        } = this.state;\n        var self = this;\n        if (comp == 'votes-default') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Race for Votes: {getNationalProvincialStr2(self.state)}\n                </div>\n            );\n        }\n        if (comp == 'votes-default-metro') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Race for Votes: {getNationalProvincialStr(self.state)} - <span className=\"regionName\">{getRegionName2(self.state)}</span>\n                </div>\n            );\n        }\n        if (comp == 'seats-default') {\n            return (\n                <div className={className(\"quick-results-title\")+\" \"+className(\"race-for-seats\")}>\n                    PREDICTED: Race for Seats: {getNationalProvincialStr2(self.state)} ({getSeatsCount(self.state)})\n                </div>\n            );\n        }\n        if (comp == 'votes-turnout') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Turnout: {getNationalProvincialStr4(self.state)}\n                </div>\n            );\n        }\n        if (comp == 'votes-progress') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Counting Progress{getNationalProvincialStr3(self.state)}\n                </div>\n            );\n        }\n        if (comp == 'votes-comparisons') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Comparisons: {getNationalProvincialStr2(self.state)}\n                </div>\n            );\n        }\n        if (comp == 'seats-comparisons') {\n            return (\n                <div className={className(\"quick-results-title\")+\" \"+className(\"race-for-seats\")}>\n                    Comparisons: {getNationalProvincialStr2(self.state)} ({getSeatsCount(self.state)})\n                </div>\n            );\n        }\n        if (comp == 'votes-myvd') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Voting District\n                </div>\n            );\n        }\n        if (comp == 'votes-split') {\n            return (\n                <div className={className(\"quick-results-title\")}>\n                    Split (Nat/Prov): National Assembly and {getNationalProvincialStr2(self.state)}\n                </div>\n            )\n        }\n        if (comp == 'votes-predictions') {\n            \n            return (\n                <div className={className(\"quick-results-title\")}>\n                     CSIR predictions for final results, with <span ref=\"curCountingProg\">{currentCountingProg}%</span> VDs counted: {getRegionName4(self.state)}\n                </div>\n            )\n        }\n        return null;\n    }\n\n    renderMap() {\n\n            var msgMapClick = \"Click on the map for detailed results\";\n        var {\n            comp,\n            iecId,\n            muniCode\n        } = this.state;\n        var mapState = JSON.parse(JSON.stringify(this.state));\n        if (comp == 'votes-myvd') {\n            if (iecId && iecId.length && muniCode && muniCode.length) {\n                mapState.disableNavigation = true;\n                return (\n                    <div className={className(\"map-container\")}>\n                        <div className={cn(\"leadingmap-title-container\")}>\n                            <div className={cn(\"leading-parties\")}>Leading Parties</div>\n                            <div className={cn(\"helper-text\")}>{ msgMapClick }</div>\n                        </div>\n                        <Map\n                            ref={instance => { this.mapInstance = instance; }}\n                            key={comp}\n                            {...mapState}\n                            componentID={-1000}\n                        />\n                    </div>\n                );\n            }\n            return null;\n        }\n        if (comp == 'votes-split') {\n            mapState.disableNavigation = true;\n            mapState.regionType = \"national\";\n            return (\n                <div className={className(\"map-container\")}>\n                    <div className={cn(\"leadingmap-title-container\")}>\n                        <div className={cn(\"leading-parties\")}>Leading Parties</div>\n                        <div className={cn(\"helper-text\")}>{ msgMapClick }</div>\n                    </div>\n                    <Map\n                        ref={instance => { this.mapInstance = instance; }}\n                        key={comp}\n                        {...mapState}\n                        componentID={-1000}\n                    />\n                </div>\n            );\n        } else if (comp == 'votes-turnout') {\n            return (\n                <div className={className(\"map-container\")}>\n                    <TurnoutMap\n                        ref={instance => { this.mapInstance = instance; }}\n                        key={comp}\n                        {...this.state}\n                        componentID={-1000} />\n                </div>\n            );\n        } else if (comp == 'votes-progress') {\n            console.log(\"votes-PROGRESS\");\n            return (\n                <div className={className(\"map-container\")}>\n                    <TurnoutMap\n                        ref={instance => { this.mapInstance = instance; }}\n                        key={comp}\n                        {...this.state}\n                        isTurnout={false}\n                        componentID={-1000} />\n                </div>\n            );\n        } else {\n            return (\n                <div className={className(\"map-container\")}>\n                    {\n                        (comp === 'votes-default' || comp === 'votes-default-metro') && \n                        <div className={cn(\"leadingmap-title-container\")}>\n                            <div className={cn(\"leading-parties\")}>Leading Parties</div>\n                            <div className={cn(\"helper-text\")}>{ msgMapClick }</div>\n                        </div>\n                    }\n                    <Map\n                        ref={instance => { this.mapInstance = instance; }}\n                        key={comp}\n                        {...this.state}\n                        componentID={-1000} />\n                </div>\n            );\n        }\n    }\n\n    renderBarchart() {\n        var {\n            comp,\n            partyIecIds,\n            partyAbbrs,\n            iecId\n        } = this.state;\n        if (comp == 'votes-default' || comp == 'votes-default-metro' || (comp == 'votes-myvd' && iecId && iecId.length)) {\n            return (\n                <div className={className(\"barchart-container\")}>\n                    <BarChart \n                        key={comp}\n                        ref={instance => { this.barchartInstance = instance; }} \n                        {...this.state} \n                        componentID={-1000}/>\n                </div>\n            );\n        }\n        if (comp == 'seats-default') {\n            return (\n                <div className={className(\"barchart-container\")}>\n                    <SeatHorseShoeChart\n                        ref={instance => { this.barchartInstance = instance; }} \n                        {...this.state}\n                        componentID={-1000} />\n                </div>\n            );\n        }\n        if (comp == 'votes-turnout') {\n            return (\n                <div className={className(\"barchart-container\")}>\n                    <TurnoutBarchart \n                        ref={instance => { this.barchartInstance = instance; }} \n                        {...this.state}\n                        componentID={-1000} />\n                </div>\n            );\n        }\n        if (comp == 'votes-progress') {\n            return (\n                <div className={className(\"barchart-container\")}>\n                    <ProgressVotesPieChart \n                        ref={instance => { this.barchartInstance = instance; }} \n                        {...this.state}\n                        componentID={-1000} />\n                </div>\n            );\n        }\n        if (comp == 'votes-predictions') {\n            return (\n                <div className={className(\"barchart-container\")}>\n                    <VotePredictionLineChart\n                        ref={instance => { this.barchartInstance = instance; }}\n                        {...this.state}\n                        componentID={-1000} />\n                </div>\n            );\n        }\n        if (comp == 'votes-comparisons') {\n            var {numParties} = this.state;\n            this.barchartInstances = new Array(numParties);\n            return (\n                <div className={className(\"barchart-container\")}>\n                    {\n                        partyIecIds.map((partyIecId, partyIdx) => {\n                            return <VoteCompBarchart \n                                ref={instance => { this.barchartInstances[partyIdx] = instance; }} \n                                key={partyIdx}\n                                {...this.state}\n                                partyAbbr={partyAbbrs[partyIdx]}\n                                partyIecId={partyIecId}\n                                componentID={-1000}\n                            />\n                        })\n                    }\n                </div>\n            );\n        }\n        if (comp == 'seats-comparisons') {\n            this.barchartInstances = new Array(numParties);\n            return (\n                <div className={className(\"barchart-container\")}>\n                    {\n                        partyIecIds.map((partyIecId, partyIdx) => {\n                            return <SeatCompBarchart \n                                ref={instance => { this.barchartInstances[partyIdx] = instance; }} \n                                key={partyIdx}\n                                {...this.state}\n                                partyAbbr={partyAbbrs[partyIdx]}\n                                partyIecId={partyIecId}\n                                componentID={-1000}\n                            />\n                        })\n                    }\n                </div>\n            );\n        }\n        if (comp == 'votes-split') {\n            return (\n                <div className={className(\"barchart-container\")}>\n                    <SplitNatProvChart \n                        ref={instance => { this.barchartInstance = instance; }} \n                        {...this.state}\n                        componentID={-1000}\n                    />\n                </div>\n                \n            )\n        }\n        return null;\n    }\n\n    renderMyVDEnterForm() {\n        var {comp} = this.state;\n        if (comp != 'votes-myvd') {\n            return null;\n        }\n        return (\n            <div className=\"voting-district-enter-form\">\n                <input ref=\"vdInput\" type=\"text\" placeholder=\"Enter your VD number\"/>\n                <button onClick={this.onShowVDResult.bind(this)}> Show Result</button>\n                <p className=\"iec-link\">Look up your voting district number at the <a href=\"http://maps.elections.org.za/vsfinder/\" target=\"_blank\">IEC</a>.</p>\n            </div>\n        )\n    }\n\n    onShowVDResult() {\n        if (this.refs.vdInput.value.length == 0) {\n            alert(\"please enter valid vd number\");\n            return;\n        }\n        var newState = {\n            regionType: \"municipality-vd\",\n            iecId: this.refs.vdInput.value,\n            muniCode: \"\"\n        }\n        triggerCustomEvent(events.REGION_CHANGE, newState);\n    }\n\n    render() {\n        var {\n            stylesheetFor,\n        } = this.state;\n\n        var components = [];\n        components.push(this.renderQuickResultsTitle())\n        if (this.state.enableTurnoutProgressSpoilt) {\n            components.push(this.renderTurnoutProgressSpoilt())\n        }\n        components.push(this.renderMyVDEnterForm())\n\n        if (this.state.enableBarChart)\n          components.push(this.renderBarchart())\n\n        if (this.state.enableMap)\n          components.push(this.renderMap())\n\n        return (\n            <div className={className(\"quickresultswidget\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n                <div className={cn(\"row\")}>\n                    <div className={cn(\"col-md-4\")+\" \"+className(\"main-left-part\")}>\n                        <NavBar {...this.state}/>\n                    </div>\n                    <div className={cn(\"col-md-8\")+\" \"+className(\"main-right-part\")}>\n                        {components}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default QuickResultsWidget;\n","import * as d3 from \"d3\";\nimport {createTooltip, formatPartyName, formatClassNameFromString} from \"../../utils\";\nimport config from \"../../config\"\n\nexport function Chart(container, width, height, className, options) {\n  if (!options) {\n      options = {};\n  }\n  width = 700;\n  height = 300;\n  container.selectAll(\"svg\").remove();\n\n    var XaxisOffset = 70;\n    var YaxisOffset = 120;\n    var predefColors = [\"blue\", \"yellow\", \"red\"];\n\n    var svg = container.append(\"svg\")\n        .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n        .attr(\"viewBox\", options.viewBox || (\"0 0 \" + (width+XaxisOffset) + \" \" + (height+YaxisOffset)))\n        .classed(\"svg-content\", true);\n        \n    var tooltipDiv = createTooltip(className);\n  \n    var x = d3.scaleBand()\n      .rangeRound([XaxisOffset, width])\n  \n    var y = d3.scaleLinear()\n      .rangeRound([height, YaxisOffset]);\n  \n    var errorText = svg.append(\"g\")\n      .attr(\"transform\", \"translate(\"+(width/2)+\",\"+(height/2)+\")\")\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\");\n  \n    this.draw = function(groupChartData, colorsData) {\n\n      svg.selectAll(\".topLabel\").remove();\n      svg.append(\"text\")\n        .attr(\"class\", \"topLabel\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"x\", width/2)\n        .attr(\"y\", 20)\n        .text(options.topLabel);\n\n      // svg.append(\"text\")\n      //   .attr(\"text-anchor\", \"end\")\n      //   .attr(\"x\", width)\n      //   .attr(\"y\", 40)\n      //   .text(options.usedValue);\n\n      if (!groupChartData) {\n        errorText.text(\"chart data is not available\");\n        return;\n      } else {\n        errorText.text(\"\");\n      }\n      var partyColorByName = {};\n\n        var partyColorsData = colorsData;\n        if (partyColorsData && partyColorsData[\"data\"][\"allParties\"][\"edges\"]) {\n            partyColorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n            partyColorByName[edge.node.name] = edge.node.colour;\n            })\n        }\n\n      function getFillColorFromPartyName(partyName, i) {\n        return partyColorByName[partyName.split(\"/\")[0]] || predefColors[i%predefColors.length];\n      }\n\n      function getFillColor(d, i) {\n          return getFillColorFromPartyName(d.partyInfo.name, i);\n      }\n\n      function getTooltipText(d, i) {\n        if (options.noXaxisByParty) {\n          return d.name + \" : \" + options.yValueFormat(options.yValue(d));\n        } else {\n          return formatPartyName(d.partyInfo.name) + \" : \" + options.yValueFormat(options.yValue(d));\n        }\t\n      }\n\n      x.domain(groupChartData.map(item => item.partyAbbr));\n\n      var minMaxY = [0, 100];\n      if (options.dynamicYAxisFromValues) {\n        minMaxY[1] = d3.max(groupChartData.map(item => d3.max(item.data, function(d) { return parseFloat(options.yValue(d)); }))) + 1\n      }\n      y.domain(minMaxY);\n\n      var groupSvgs = svg.selectAll(`.bar-group`).data(groupChartData);\n      groupSvgs.exit()\n        .transition()\n        .duration(300)\n        .style(\"fill-opacity\", 1e-6)\n        .remove();\n    \n      var groupSvg = groupSvgs.enter()\n        .append(\"g\")\n        .attr(\"class\", d => `bar-group ${formatClassNameFromString(d.partyAbbr)}`)\n        .attr(\"transform\", (d) => `translate(${x(d.partyAbbr)}, 0)`);\n\n      groupSvg.append('rect')\n        .attr('class', className(config.CSS_PREFIX + \"grouprect\"))\n        .attr('x', -x.bandwidth()*1/12)\n        .attr('y', YaxisOffset - 85)\n        .attr('width', x.bandwidth()*5/6)\n        .attr('height', 120 + height - YaxisOffset);\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"groupname-container\")\n        .attr(\"transform\", `translate(${x.bandwidth()*1/3}, ${YaxisOffset - 50})`)\n        .append(\"text\")\n          .attr(\"text-anchor\", \"middle\")\n          .text(d => d.partyAbbr)\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"bar-container\");\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"bartext-container\");\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"baraxistext-container\");\n      \n      for (var i = 0; i < groupChartData.length; i ++) {\n        var partyAbbr = groupChartData[i].partyAbbr;\n        var chartData = groupChartData[i].data;\n\n        var subX = d3.scaleBand()\n          .rangeRound([0, x.bandwidth()*2/3])\n          .domain(chartData.map(function (d) {\n            return d.name;\n          }));\n\n        var groupSvg = svg.selectAll(`.bar-group.${formatClassNameFromString(partyAbbr)}`);\n\n        var barSvg = groupSvg.select(\".bar-container\");\n        var barTextSvg = groupSvg.select(\".bartext-container\");\n        var barAxisTextSvg = groupSvg.select(\".baraxistext-container\");\n\n        var bars = barSvg.selectAll(`.${className(\"bar\")}`).data(chartData);\n  \n        bars.exit()\n          .transition()\n          .duration(300)\n          .attr(\"y\", function(d) {\n            return y(0);\n          })\n          .attr(\"height\", 0)\n          .style(\"fill-opacity\", 1e-6)\n          .remove();\n        \n    \n        bars.enter()\n            .append(\"rect\")\n            .attr(\"class\", (d) => className(\"bar\") + \" bar_\" + d.name)\n            .attr(\"x\", function (d, i) {\n              return subX(d.name)+subX.bandwidth()/4;\n            })\n            .attr(\"width\", subX.bandwidth()*1/2)\n            .attr(\"fill\", (d,i) => getFillColor(d, i))\n            .on(\"mousemove\", function(d, i) {\t\t\n                d3.select(this)\n                  .attr(\"opacity\", 0.8);\n                tooltipDiv.transition()\t\t\n                    .duration(200)\t\t\n                    .style(\"opacity\", .9);\t\t\n                tooltipDiv.html(getTooltipText(d, i))\n                    .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n                })\t\t\t\t\t\n            .on(\"mouseout\", function(d) {\t\t\n                d3.select(this)\n                  .attr(\"opacity\", 1);\n                tooltipDiv.transition()\t\t\n                    .duration(200)\t\t\n                    .style(\"opacity\", 0);\t\n            })\n            .attr(\"y\", function(d) {\n              return y(0);\n            })\n            .attr(\"height\", 0)        \n    \n          barSvg.selectAll(`.${className(\"bar\")}`).data(chartData)\n            .attr(\"fill\", (d, i) => getFillColor(d, i))\n            .transition()\n            .duration(300)\n            .attr(\"y\", function (d) {\n              return y(Number(options.yValue(d)));\n            })\n            .attr(\"height\", function (d) {\n              return height - y(Number(options.yValue(d)));\n            })\n            \n\n          var barAxisTexts = barAxisTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData);\n          barAxisTexts.exit()\n            .transition()\n            .duration(300)\n            .style(\"fill-opacity\", 1e-6)\n            .remove();\n    \n          barAxisTexts.enter().append(\"text\")\n            .attr(\"class\", className(\"bartext\"))\n            .attr(\"x\", function (d) {\n              return subX(d.name)+subX.bandwidth()/2;\n            })\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", \"7px\")\n            .attr(\"y\", function(d) {\n              return y(0) + 18;\n            })\n          barAxisTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData)\n            .text(function(d) {\n              return /(19|20)\\d{2}/g.exec(d.name)[0];\n            });\n            \n    \n          var barTexts = barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData);\n          barTexts.exit()\n            .transition()\n            .duration(300)\n            .attr(\"y\", function(d) {\n              return y(0) - 5;\n            })\n            .style(\"fill-opacity\", 1e-6)\n            .remove();\n    \n          barTexts.enter().append(\"text\")\n            .attr(\"class\", className(\"bartext\"))\n            .attr(\"x\", function (d) {\n              return subX(d.name)+subX.bandwidth()/2;\n            })\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", \"7px\")\n            .attr(\"y\", function(d) {\n              return y(0) - 5;\n            })\n          barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData)\n            .text(function(d) {\n              return options.yValueFormat(options.yValue(d));\n            })\n            .transition()\n            .duration(300)\n            .attr(\"y\", function (d) {\n              return y(Number(options.yValue(d))) - 5;\n            })\n      }\n    }\n    this.destroy = function() {\n      svg.remove();\n    }\n  }","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../TVVoteCompBarchart/d3groupbarchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getPartyColors,\n  getSeatsDataForComparison\n} from \"../../api\";\nimport {\n  parseSeatsComparisonDataMultipleParties,\n  getNationOrProvinceName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\n\nvar chartOptions = {\n  topLabel: \"NATIONAL ASSEMBLY: 2009, 2014, 2019\",\n  usedValue: \"SEATS COUNTED\",\n  yValue: d => d.seats,\n  yValueFormat: seats => seats,\n  dynamicYAxisFromValues: true,\n  viewBox: '45 0 655 340'\n}\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        partyAbbrs: [\"ANC\", \"DA\", \"EFF\", \"ID\"],\n        partyIecIds: [null, null, null, null],\n        eventDescriptions: [\n            // \"National Elections 1999\",\n            // \"Provincial Elections 1999\",\n            \"14 Apr 2004 National Election\",\n            // \"14 Apr 2004 Provincial Election\",\n            \"22 Apr 2009 National Election\",\n            // \"22 Apr 2009 Provincial Election\",\n            \"2014 National Election\",\n            // \"2014 Provincial Election\",\n            \"2019 NATIONAL ELECTION\",\n            // \"2019 PROVINCIAL ELECTION\",\n        ],\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 12\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-comparison-barchart(${getNationOrProvinceName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n\n      const {\n        stylesheetFor\n      } = this.state;\n      return (\n          <div className={cn(\"groupbarchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {/* <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName(this.state)}): </div> */}\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var seatsDataLoader = getSeatsDataForComparison(props);\n      var dataLoaders = [seatsDataLoader];\n      \n      chartOptions.topLabel = `${props.regionType.toUpperCase()} ASSEMBLY: ${props.eventDescriptions.map(desc => /(19|20)\\d{2}/g.exec(desc)[0]).join(\", \")}`\n\n      if (props.regionType == \"national\") {\n        chartOptions.topLabel = \"Race for Seats Comparison - National Assembly\";\n      } else {\n        chartOptions.topLabel = `Race for Seats Comparison - ${getNationOrProvinceName(props)}`;\n      }\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var seatsData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, seatsData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseSeatsComparisonDataMultipleParties(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import * as d3 from \"d3\";\nimport {createTooltip, formatPartyName, formatClassNameFromString} from \"../../utils\";\nexport function Chart(container, width, height, className, options) {\n  if (!options) {\n      options = {};\n  }\n  width = 700;\n  height = 300;\n  container.selectAll(\"svg\").remove();\n\n    var XaxisOffset = 70;\n    var YaxisOffset = 120;\n    var predefColors = [\"blue\", \"yellow\", \"red\"];\n\n    var svg = container.append(\"svg\")\n        .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n        .attr(\"viewBox\", \"0 0 \" + (width+XaxisOffset) + \" \" + (height+YaxisOffset))\n        .classed(\"svg-content\", true);\n        \n    var tooltipDiv = createTooltip(className);\n  \n    var x = d3.scaleBand()\n      .rangeRound([XaxisOffset, width])\n  \n    var y = d3.scaleLinear()\n      .rangeRound([height, YaxisOffset]);\n  \n    var errorText = svg.append(\"g\")\n      .attr(\"transform\", \"translate(\"+(width/2)+\",\"+(height/2)+\")\")\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\");\n  \n    this.draw = function(groupChartData, colorsData) {\n\n      svg.selectAll(\".topLabel\").remove();\n      svg.append(\"text\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"class\", \"topLabel\")\n        .attr(\"x\", width/2)\n        .attr(\"y\", 20)\n        .text(options.topLabel);\n\n      if (!groupChartData) {\n        errorText.text(\"chart data is not available\");\n        return;\n      } else {\n        errorText.text(\"\");\n      }\n      var partyColorByName = {};\n\n        var partyColorsData = colorsData;\n        if (partyColorsData && partyColorsData[\"data\"][\"allParties\"][\"edges\"]) {\n            partyColorsData[\"data\"][\"allParties\"][\"edges\"].forEach(edge => {\n            partyColorByName[edge.node.name] = edge.node.colour;\n            })\n        }\n\n      function getFillColorFromPartyName(partyName, i) {\n        return partyColorByName[partyName.split(\"/\")[0]] || predefColors[i%predefColors.length];\n      }\n\n      function getFillColor(d, i) {\n          return getFillColorFromPartyName(d.partyInfo.name, i);\n      }\n\n      function getTooltipText(d, i) {\n        if (options.noXaxisByParty) {\n          return d.name + \" : \" + options.yValueFormat(d.delta);\n        } else {\n          return formatPartyName(d.partyInfo.name) + \" : \" + options.yValueFormat(d.delta);\n        }\t\n      }\n\n      var newGroupChartData = groupChartData.map(item => {\n        var chartData = item.data;\n        return {\n          ...item,\n          data: [{\n            ...chartData[1],\n            delta: options.yValue(chartData[1]) - options.yValue(chartData[0])\n          }]\n        }\n      });\n\n      x.domain(groupChartData.map(item => item.partyAbbr));\n\n      var minMaxY = [-100, 100];\n      if (options.dynamicYAxisFromValues) {\n        minMaxY[1] = d3.max(newGroupChartData.map(item => parseFloat(item.data[0].delta))) + 1\n        minMaxY[0] = d3.min(newGroupChartData.map(item => parseFloat(item.data[0].delta))) - 1\n      }\n      y.domain(minMaxY);\n\n      var groupSvgs = svg.selectAll(`.bar-group`).data(newGroupChartData);\n      groupSvgs.exit()\n        .transition()\n        .duration(300)\n        .style(\"fill-opacity\", 1e-6)\n        .remove();\n    \n      var groupSvg = groupSvgs.enter()\n        .append(\"g\")\n        .attr(\"class\", d => `bar-group ${formatClassNameFromString(d.partyAbbr)}`)\n        .attr(\"transform\", (d) => `translate(${x(d.partyAbbr)}, 0)`);\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"groupname-container\")\n        .attr(\"transform\", `translate(${x.bandwidth()*1/3}, ${YaxisOffset - 50})`)\n        .append(\"text\")\n          .attr(\"text-anchor\", \"middle\")\n          .text(d => d.partyAbbr)\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"bar-container\");\n\n      groupSvg.append(\"g\")\n        .attr(\"class\", \"bartext-container\");\n      \n      for (var i = 0; i < newGroupChartData.length; i ++) {\n        var partyAbbr = newGroupChartData[i].partyAbbr;\n        var deltaData = newGroupChartData[i].data;\n\n        var groupSvg = svg.selectAll(`.bar-group.${formatClassNameFromString(partyAbbr)}`);\n\n        var barSvg = groupSvg.select(\".bar-container\");\n        var barTextSvg = groupSvg.select(\".bartext-container\");\n\n        var bars = barSvg.selectAll(`.${className(\"bar\")}`).data(deltaData);\n\n        bars.exit()\n          .transition()\n          .duration(300)\n          .attr(\"height\", 0)\n          .style(\"fill-opacity\", 1e-6)\n          .remove();\n        \n        bars.enter()\n            .append(\"rect\")\n            .attr(\"class\", (d) => className(\"bar\") + \" bar_\" + d.name)\n            .attr(\"x\", x.bandwidth()/6)\n            .attr(\"width\", x.bandwidth()*1/3)\n            .attr(\"fill\", (d,i) => getFillColor(d, i))\n            .on(\"mousemove\", function(d, i) {\t\t\n                d3.select(this)\n                  .attr(\"opacity\", 0.8);\n                tooltipDiv.transition()\t\t\n                    .duration(200)\t\t\n                    .style(\"opacity\", .9);\t\t\n                tooltipDiv.html(getTooltipText(d, i))\n                    .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n                })\t\t\t\t\t\n            .on(\"mouseout\", function(d) {\t\t\n                d3.select(this)\n                  .attr(\"opacity\", 1);\n                tooltipDiv.transition()\t\t\n                    .duration(200)\t\t\n                    .style(\"opacity\", 0);\t\n            })\n            .attr(\"y\", function(d) {\n              return y(0);\n            })\n            .attr(\"height\", 0)        \n    \n          barSvg.selectAll(`.${className(\"bar\")}`).data(deltaData)\n            .attr(\"fill\", (d, i) => getFillColor(d, i))\n            .transition()\n            .duration(300)\n            .attr(\"y\", function (d) {\n              return Math.min(y(Number(d.delta)), y(0));\n            })\n            .attr(\"height\", function (d) {\n              return Math.abs(y(Number(d.delta)) - y(0));\n            })\n    \n          var barTexts = barTextSvg.selectAll(`.${className(\"bartext\")}`).data(deltaData);\n          barTexts.exit()\n            .transition()\n            .duration(300)\n            .style(\"fill-opacity\", 1e-6)\n            .remove();\n    \n          barTexts.enter().append(\"text\")\n            .attr(\"class\", className(\"bartext\"))\n            .attr(\"x\", function (d) {\n              return x.bandwidth()/3;\n            })\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", \"12px\")\n            .attr(\"y\", function(d) {\n              if (d.delta > 0)\n                return y(0) - 5;\n              return y(0) + 5;\n            })\n          barTextSvg.selectAll(`.${className(\"bartext\")}`).data(deltaData)\n            .text(function(d) {\n              return options.yValueFormat(d.delta);\n            })\n            .transition()\n            .duration(300)\n            .attr(\"y\", function (d) {\n              var barTextYDelta = 0;\n              if (d.delta > 0) {\n                barTextYDelta = -5;\n              } else {\n                barTextYDelta = 15;\n              }\n              return y(Number(d.delta)) + barTextYDelta;\n            })\n      }\n\n      svg.selectAll(\".xAxisLine\").remove();\n      var axisThick = 2;\n      svg.append('line')\n        .attr('class', 'xAxisLine')\n        .attr('stroke-width', axisThick)\n        .attr('stroke', \"currentColor\")\n        .attr('x1', XaxisOffset)\n        .attr('y1', y(0)-axisThick/2)\n        .attr('x2', width)\n        .attr('y2', y(0)-axisThick/2)\n    }\n    this.destroy = function() {\n      svg.remove();\n    }\n  }","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../TVVoteSwingBarchart/d3deltabarchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getPartyColors,\n  getSeatsDataForComparison\n} from \"../../api\";\nimport {\n  parseSeatsComparisonDataMultipleParties,\n  getNationOrProvinceName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\n\nvar dataRefreshTime = 30 * 1000;\n\nvar chartOptions = {\n  topLabel: \"NATIONAL ASSEMBLY: 2009, 2014\",\n  usedValue: \"SEATS COUNTED\",\n  yValue: d => d.seats,\n  yValueFormat: seats => seats,\n  dynamicYAxisFromValues: true\n}\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        partyAbbrs: [\"ANC\", \"DA\", \"EFF\", \"ID\"],\n        partyIecIds: [null, null, null, null],\n        eventDescriptions: [\n            // \"National Elections 1999\",\n            // \"Provincial Elections 1999\",\n            // \"14 Apr 2004 National Election\",\n            // \"14 Apr 2004 Provincial Election\",\n            \"22 Apr 2009 National Election\",\n            // \"22 Apr 2009 Provincial Election\",\n            \"2014 National Election\",\n            // \"2014 Provincial Election\",\n            // \"2019 NATIONAL ELECTION\",\n            // \"2019 PROVINCIAL ELECTION\",\n        ],\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 13\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      this.chart = null;\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-seats-swing-barchart(${getNationOrProvinceName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n\n      const {\n        stylesheetFor\n      } = this.state;\n      return (\n          <div className={cn(\"deltabarchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {/* <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getNationOrProvinceName(this.state)}): </div> */}\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var seatsDataLoader = getSeatsDataForComparison(props);\n      var dataLoaders = [seatsDataLoader];\n\n      var years = props.eventDescriptions.map(desc => /(19|20)\\d{2}/g.exec(desc)[0]).join(\"/\");\n      if (props.regionType == \"national\") {\n        chartOptions.topLabel = `National Assembly: Swing ${years}`;\n      } else {\n        chartOptions.topLabel = `${getNationOrProvinceName(props)}: Swing ${years}`;\n      }\n\n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var seatsData = values[0];\n        partyColorsData = partyColorsData || values[1];         \n        self.drawGraph(container, props, seatsData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseSeatsComparisonDataMultipleParties(data, props);\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        \n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../TVVoteCompBarchart/d3groupbarchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getVotesDataForComparison,\n  getPartyColors,\n  getProvincesData\n} from \"../../api\";\nimport {\n  parseVotesComparisonDataMultipleParties,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\nvar provincesData = getProvincesData();\n\nvar dataRefreshTime = 30 * 1000;\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nvar chartOptions = {\n  topLabel: \"NATIONAL ASSEMBLY: 2009, 2014, 2019\",\n  usedValue: \"% VDS COUNTED\",\n  yValue: d => d.percOfVotes,\n  yValueFormat: value => value + '%',\n  dynamicYAxisFromValues: true\n}\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        partyAbbrs: [\"ANC\", \"DA\", \"EFF\", \"ID\"],\n        partyIecIds: [null, null, null, null],\n        eventDescriptions: [\n            // \"National Elections 1999\",\n            // \"Provincial Elections 1999\",\n            \"14 Apr 2004 National Election\",\n            // \"14 Apr 2004 Provincial Election\",\n            \"22 Apr 2009 National Election\",\n            // \"22 Apr 2009 Provincial Election\",\n            \"2014 National Election\",\n            // \"2014 Provincial Election\",\n            \"2019 NATIONAL ELECTION\",\n            // \"2019 PROVINCIAL ELECTION\",\n        ],\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 14\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      if (this.chart) {\n        this.chart.destroy();\n        this.chart = null;\n      }\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-votes-comparison-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor\n      } = this.state;\n      return (\n          <div className={cn(\"groupbarchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {/* <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div> */}\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var votesDataLoader = getVotesDataForComparison(props);\n      var dataLoaders = [votesDataLoader];\n      chartOptions.topLabel = `${props.regionType.toUpperCase()} ASSEMBLY: ${props.eventDescriptions.map(desc => /(19|20)\\d{2}/g.exec(desc)[0]).join(\", \")}`\n      \n      if (props.regionType == \"national\") {\n        chartOptions.topLabel = \"Race for Votes Comparison - National Assembly\";\n      } else {\n        chartOptions.topLabel = `Race for Votes Comparison - ${getRegionName(props)}`;\n      }\n      \n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var votesData = values[0];\n        partyColorsData = partyColorsData || values[1];          \n        self.drawGraph(container, props, votesData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseVotesComparisonDataMultipleParties(data, props);\n\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport * as d3 from \"d3\";\nimport styles from \"../BarChart/barchart.css\";\nimport {Chart} from \"../TVVoteSwingBarchart/d3deltabarchart\";\nimport svgToPng from \"save-svg-as-png\";\n\nimport events from \"../../events\";\nimport config from \"../../config\";\nimport {\n  getVotesDataForComparison,\n  getPartyColors,\n  getProvincesData\n} from \"../../api\";\nimport {\n  parseVotesComparisonDataMultipleParties,\n  getRegionName,\n  fetchDataFromOBJ,\n  handleRegionChange\n} from \"../../utils\";\n\nvar provincesData = getProvincesData();\n\nvar dataRefreshTime = 30 * 1000;\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction cn(originName) {\n  return className(config.CSS_PREFIX + originName);\n}\n\nvar partyColorsData;\n\nvar chartOptions = {\n  topLabel: \"NATIONAL ASSEMBLY: 2009, 2014, 2019\",\n  usedValue: \"% VDS COUNTED\",\n  yValue: d => d.percOfVotes,\n  yValueFormat: value => (value > 0? '+': '') + (value.toFixed(2)) + '%',\n  dynamicYAxisFromValues: true\n}\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        partyAbbrs: [\"ANC\", \"DA\", \"EFF\", \"ID\"],\n        partyIecIds: [null, null, null, null],\n        eventDescriptions: [\n            // \"National Elections 1999\",\n            // \"Provincial Elections 1999\",\n            // \"14 Apr 2004 National Election\",\n            // \"14 Apr 2004 Provincial Election\",\n            \"22 Apr 2009 National Election\",\n            // \"22 Apr 2009 Provincial Election\",\n            \"2014 National Election\",\n            // \"2014 Provincial Election\",\n            // \"2019 NATIONAL ELECTION\",\n            // \"2019 PROVINCIAL ELECTION\",\n        ],\n        regionType: \"national\",\n        provinceName: \"\",\n        muniName: \"\",\n        muniCode: \"\",\n        iecId: \"\",\n        stylesheetFor: \"web\",\n        componentID: 15\n      }\n\n      fetchDataFromOBJ(this.state, props);\n\n      this.chart = null;\n      this.refreshIntervalID = 0;\n      this.exportAsPNG = this.exportAsPNG.bind(this);\n      this.exportAsPNGUri = this.exportAsPNGUri.bind(this);\n      this.handleRegionChange = handleRegionChange.bind(this);\n      this.handlePreviewEvent = this.handlePreviewEvent.bind(this);\n    }\n  \n    componentDidMount() {\n\n      var self = this;\n      this.draw(this.getContainer(), this.state);\n      this.refreshIntervalID = setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      document.addEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.addEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      if (this.chart) {\n        this.chart.destroy();\n        this.chart = null;\n      }\n      document.removeEventListener(events.EXPORT_PNG, this.exportAsPNG);\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      document.removeEventListener(events.CHART_PREVIEW, this.handlePreviewEvent);\n      clearInterval(this.refreshIntervalID);\n    }\n\n    exportAsPNGUri() {\n      var self = this;\n      return new Promise(function(resolve, reject) {\n        svgToPng.svgAsPngUri(self.refs.vizcontainer.childNodes[0], {}, function(uri) {\n          resolve(uri.split(',')[1]);\n        });\n      });\n    }\n\n    exportAsPNG(event) {\n      var targetState = event.detail;\n      if (targetState.componentID != this.state.componentID)\n        return;\n      svgToPng.saveSvgAsPng(this.refs.vizcontainer.childNodes[0], `race-for-votes-swing-barchart(${getRegionName(this.state)}).png`);\n    }\n\n    handlePreviewEvent(event) {\n      var newState = event.detail;\n      if (this.chart)\n        this.chart.destroy();\n      this.chart = new Chart(this.getContainer(), null, null, className, chartOptions);\n      this.setState(newState)\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      const {\n        stylesheetFor\n      } = this.state;\n      return (\n          <div className={cn(\"deltabarchart\") + \" \" + cn(`stylesheet-${stylesheetFor}`)}>\n            {/* <div className={cn(\"chart-title\")}>{chartOptions.chartType} ({getRegionName(this.state)}): </div> */}\n            <div \n              ref=\"vizcontainer\" \n              className={cn(\"chart-body\")} \n              ></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      var votesDataLoader = getVotesDataForComparison(props);\n      var dataLoaders = [votesDataLoader];\n      \n      var years = props.eventDescriptions.map(desc => /(19|20)\\d{2}/g.exec(desc)[0]).join(\"/\");\n      if (props.regionType == \"national\") {\n        chartOptions.topLabel = `National Assembly: Swing ${years}`;\n      } else {\n        chartOptions.topLabel = `${getRegionName(props)}: Swing ${years}`;\n      }\n      \n      if (!partyColorsData) {\n        var partyColorsLoader = getPartyColors();\n        dataLoaders.push(partyColorsLoader);\n      }\n\n      Promise.all(dataLoaders).then(function(values){ \n        var votesData = values[0];\n        partyColorsData = partyColorsData || values[1];          \n        self.drawGraph(container, props, votesData, partyColorsData);\n      }).catch(error => console.error(error));\n    }\n\n    drawGraph(container, props, data, partyColorsData) {\n        var chartData = parseVotesComparisonDataMultipleParties(data, props);\n\n        if (!this.chart)\n          this.chart = new Chart(container, null, null, className, chartOptions);\n        this.chart.draw(chartData, partyColorsData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from \"react\";\nimport \"./App.css\";\nimport {\n  BarChart,\n  BarChartEmbed,\n  Map,\n  MapEmbed,\n  QuickResultsWidget,\n  QuickResultsWidgetEmbed\n} from \"./components\";\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <QuickResultsWidget stylesheetFor={\"tv\"} eventDescription={\"2019 NATIONAL ELECTION\"} nationalEventDescription={\"2019 NATIONAL ELECTION\"} provincialEventDescription={\"2019 PROVINCIAL ELECTION\"} />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}