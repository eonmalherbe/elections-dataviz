(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(45),o=n.n(i),s=(n(69),n(9)),c=n(10),u=n(12),l=n(11),m=n(13),d=(n(71),n(1)),p=n(2),v=n(14),h=n.n(v),f=n(16),N={DOMAIN:"https://sabc-eds.github.io/elections-dataviz",CSS_PREFIX:"ELVIZ_"};function y(e,t){return 0==t?0:(e/t*100).toFixed(2)}function g(e){return/(19|20)\d{2}/g.exec(e)[0]}function C(e,t){var n,a=t.regionType;if(!(n="national"==a?e.data.allBallots.edges[0]:"province"==a?e.data.allProvincialBallots.edges[0]:"municipality"==a?e.data.allMunicipalBallots.edges[0]:e.data.allVotingDistrictBallots.edges[0]))return console.error("party data is empty!!"),null;var r=n.node;return(r.partyResults||r.topResult).edges.sort(function(e,t){return t.node.percOfVotes-e.node.percOfVotes}).slice(0,t.numParties).map(function(e){var t=e.node;return{name:t.party.abbreviation,iecId:t.party.iecId,validVotes:t.validVotes.toFixed(2),percOfVotes:t.percOfVotes.toFixed(2),partyInfo:t.party}})}function b(e,t){var n=t.regionType,a=t.eventDescriptions.national;"provincial"===t.electionType&&(a=t.eventDescriptions.provincial);for(var r=("national"==n?e.data.allBallots.edges:"province"==n?e.data.allProvincialBallots.edges:"municipality"==n?e.data.allMunicipalBallots.edges:e.data.allVotingDistrictBallots.edges).map(function(e){var n=e.node,a=n.partyResults||n.topResult,i=(r=a.edges.filter(function(e){return t.partyIecId?e.node.party.iecId==t.partyIecId:e.node.party.abbreviation==t.partyAbbr}))[0];if(i){var o=i.node;return{name:n.event.description,percOfVotes:o.percOfVotes.toFixed(2),partyInfo:o.party}}return{name:n.event.description,percOfVotes:0,partyInfo:{name:t.partyAbbr,abbreviation:t.partyAbbr}}}).filter(function(e){return-1!=a.indexOf(e.name)}),i=[],o=0;o<a.length;o++){for(var s=!1,c=0;c<r.length;c++)if(r[c].name==a[o]){s=!0;i.push(Object(f.a)({},r[c],{name:g(r[c].name)}));break}s||i.push({name:g(a[o]),percOfVotes:0,partyInfo:{name:t.partyAbbr,abbreviation:t.partyAbbr}})}return i}function E(e,t){return t.partyAbbrs.map(function(n,a){var r=Object(f.a)({},t);return r.partyAbbr=n,r.partyIecId=t.partyIecIds[a],{partyAbbr:n,data:b(e,r)}})}function I(e,t){var n,a=t.regionType;if(!(n="national"==a?e.data.allBallots.edges[0]:"province"==a?e.data.allProvincialBallots.edges[0]:"municipality"==a?e.data.allMunicipalBallots.edges[0]:e.data.allVotingDistrictBallots.edges[0]))return console.error("progress votes count data is empty!!"),null;var r=n.node;return[{name:"Completed",percent:y(r.vdWithResultsCaptured,r.vdCount),totalCount:r.vdCount,count:r.vdWithResultsCaptured},{name:"Not Completed",percent:100-y(r.vdWithResultsCaptured,r.vdCount),totalCount:r.vdCount,count:r.vdCount-r.vdWithResultsCaptured}]}function x(e){return e&&e.topParty&&e.topParty.party&&e.topParty.party.name?e.topParty.party.name:""}function P(e,t){if(!e)return null;var n=e.data.allSeatCalculations.edges,a=t.regionType;return n.map(function(e){var t=e.node;return{seats:"national"===a?t.nationalPr+t.regional:t.regional,name:t.party.abbreviation,iecId:t.party.iecId,partyInfo:t.party}}).slice(0,t.numParties)}function w(e,t){if(!e)return null;var n=e.data.allSeatCalculations.edges,a=t.regionType,r=t.eventDescriptions.national;"provincial"===t.electionType&&(r=t.eventDescriptions.provincial);for(var i=n.map(function(e){var t=e.node;return{seats:"national"===a?t.nationalPr+t.regional:t.regional,name:t.party.event.description,partyInfo:t.party}}).filter(function(e){return-1!=r.indexOf(e.name)}).filter(function(e){return t.partyIecId?e.partyInfo.iecId==t.partyIecId:e.partyInfo.abbreviation==t.partyAbbr}),o=[],s=0;s<r.length;s++){for(var c=!1,u=0;u<i.length;u++)if(i[u].name==r[s]){c=!0;o.push(Object(f.a)({},i[u],{name:g(i[u].name)}));break}c||o.push({name:g(r[s]),seats:0,partyInfo:{name:t.partyAbbr,abbreviation:t.partyAbbr}})}return o}function A(e,t){return t.partyAbbrs.map(function(n,a){var r=Object(f.a)({},t);return r.partyAbbr=n,r.partyIecId=t.partyIecIds[a],{partyAbbr:n,data:w(e,r)}})}function T(e,t){var n,a=t.regionType;if(!(n="national"==a?e.data.allBallots.edges[0]:"province"==a?e.data.allProvincialBallots.edges[0]:"municipality"==a?e.data.allMunicipalBallots.edges[0]:e.data.allVotingDistrictBallots.edges[0]))return console.error("spoilt data is empty!!"),null;var r=n.node;return[{name:"Valid",percent:y(r.totalValidVotes,r.totalVotesCast)},{name:"Spoilt",percent:y(r.spoiltVotes,r.totalVotesCast)}]}function M(e){function t(e){return-1!=e.indexOf(" - ")&&(e=e.split(" - ")[1]),-1!=e.indexOf("[")&&(e=e.split("[")[0]),e}return"national"==e.regionType?"South Africa":"province"==e.regionType?e.provinceName:"municipality"==e.regionType?t(e.muniName):"municipality-vd"==e.regionType?t(e.muniName)+"-"+e.iecId:void 0}function O(e){return e.eventDescription.toLocaleLowerCase().indexOf("national election")>=0?"National Assembly":e.provinceName+" Legislature"}function L(e){if("national"==e.regionType)return 400;return{"Eastern Cape":63,"Free State":30,Gauteng:73,"KwaZulu-Natal":80,Limpopo:49,Mpumalanga:30,"North West":33,"Northern Cape":30,"Western Cape":42}[e.provinceName]}function S(e){return"national"==e.regionType?"South Africa":e.provinceName}function k(e){return"national"==e.regionType?"National Assembly":e.provinceName}function V(e){var t=e(N.CSS_PREFIX+"tooltip");return document.getElementsByClassName(t)[0]?p.select(".".concat(t)):p.select("body").append("div").attr("class",t).style("opacity",0)}function j(){var e,t=document.getElementsByClassName("place-label"),n={},a={};for(e=0;e<t.length;e++)n[e]=t[e].getBoundingClientRect();for(e=0;e<t.length;e++){for(var r=0;r<e;r++){var i=n[e],o=n[r];!(i.right<o.left||i.left>o.right||i.bottom<o.top||i.top>o.bottom)&&(a[e]=a[e]?a[e]+1:1)}a[e]>2?t[e].setAttribute("opacity",0):a[e]>0&&(t[e].innerHTML=t[e].innerHTML.slice(0,3)+"...")}}function D(e,t){var n=new CustomEvent(e,{detail:t});document.dispatchEvent(n)}function K(e){return e.split("/")[0].toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})}function F(e,t){return"national"===t.regionType?e.SPROVINCE:"province"===t.regionType?e.smunicipal&&e.smunicipal.split(" - ")[1].split("[")[0]:W(e)}function R(e){return e.code||e.smunicipal&&e.smunicipal.split(" - ")[0].replace(/\s/g,"")}function W(e){return e.VDNumber||e.PKLVDNUMBE}function B(e){switch(e.regionType){case"national":return"province_lo-res.geojson";case"province":return{Limpopo:"lim_lo-res.geojson",Mpumalanga:"mp_lo-res.geojson",Gauteng:"gt_lo-res.geojson","KwaZulu-Natal":"kzn_lo-res.geojson","North West":"nw_lo-res.geojson","Free State":"fs_lo-res.geojson","Eastern Cape":"ec_lo-res.geojson","Northern Cape":"nc_lo-res.geojson","Western Cape":"wc_lo-res.geojson"}[e.provinceName];case"municipality":return e.muniCode+".topojson";case"municipality-vd":return"vd-data/"+e.muniCode+"-"+e.iecId+".topojson";default:return null}}function G(e){var t=JSON.parse(JSON.stringify(e.detail));delete t.componentID,this.setState(t)}function Z(e,t){Object.keys(e).forEach(function(n){"undefined"!=typeof t[n]&&(e[n]=t[n])})}function U(e){return"formedClass_"+e.replace(/[^a-zA-Z0-9]+/g,"")}function q(e,t,n){return e.selectAll("svg").remove(),e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t+" "+n).classed("svg-content",!0)}function z(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),e.append("g").attr("transform","translate("+t+","+n+")").append("text").attr("text-anchor","middle")}n(74);function H(e,t,n,a,r){r||(r={}),r.chartType||(r.chartType="Race For Votes"),r.yAxisLabel||(r.yAxisLabel="PERCENTAGE VOTES"),r.yValue||(r.yValue=function(e){return e.percOfVotes}),r.yValueFormat||(r.yValueFormat=function(e){return e+"%"});var i=70,o=20;var s=["blue","yellow","red"],c=q(e,700+i,200+o+(r.showLegend?50:0)),u=V(a),l=p.scaleBand().rangeRound([i,700]),m=p.scaleLinear().rangeRound([200,o]);c.append("g").attr("transform","translate(20,"+(100+o/2)+")").append("text").attr("class",a(N.CSS_PREFIX+"percentage-label")).attr("transform","rotate(-90)").text(r.yAxisLabel).attr("text-anchor","middle"),c.append("g").attr("class","x axis").attr("transform","translate(0,200)"),c.append("g").attr("class","y axis").attr("transform","translate("+i+", 0)");var d=c.append("g").attr("class",a("bar-container")),v=c.append("g").attr("class",a("bartext-container")),h=z(c,350,100);this.draw=function(e,t){if(!e)return h.text("chart data is not available"),d.selectAll("rect").remove(),void v.selectAll("text").remove();h.text("");var n={},o={};function f(e,t){return n[e.split("/")[0]]||s[t%s.length]}function N(e,n){return r.noXaxisByParty?"object"==typeof t?t[e.name]:"function"==typeof t?t(e,n):t:f(e.partyInfo.name,n)}r.noXaxisByParty||t&&t.data.allParties.edges&&t.data.allParties.edges.forEach(function(e){n[e.node.name]=e.node.colour,o[e.node.name]=e.node.abbreviation}),l.domain(e.map(function(e){return e.name}));var y=[0,100];if(r.dynamicYAxisFromValues){var g=p.max(e,function(e){return parseFloat(r.yValue(e))});r.customizeDynamicMaxValue?y[1]=r.customizeDynamicMaxValue(g):y[1]=g+1}m.domain(y),c.select(".x.axis").transition().duration(300).call(p.axisBottom(l)),c.select(".y.axis").transition().duration(300).call(p.axisLeft(m).ticks(6).tickFormat(function(e){return r.yValueFormat(e)}));var C=d.selectAll(".".concat(a("bar"))).data(e);C.exit().transition().duration(300).attr("y",function(e){return m(0)}).attr("height",0).style("fill-opacity",1e-6).remove(),C.enter().append("rect").attr("class",function(e){return a("bar")+" bar_"+e.name}).attr("x",function(e){return l(e.name)+l.bandwidth()/20}).attr("width",9*l.bandwidth()/10).attr("fill",function(e,t){return N(e,t)}).on("mousemove",function(e,t){p.select(this).attr("opacity",.8),u.transition().duration(200).style("opacity",.9),u.html(function(e,t){return r.noXaxisByParty?e.name+" : "+r.yValueFormat(r.yValue(e)):K(e.partyInfo.name)+" : "+r.yValueFormat(r.yValue(e))}(e)).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e){p.select(this).attr("opacity",1),u.transition().duration(200).style("opacity",0)}).attr("y",function(e){return m(0)}).attr("height",0),d.selectAll(".".concat(a("bar"))).data(e).attr("fill",function(e,t){return N(e,t)}).attr("x",function(e){return l(e.name)+l.bandwidth()/20}).attr("width",9*l.bandwidth()/10).transition().duration(300).attr("y",function(e){return m(Number(r.yValue(e)))}).attr("height",function(e){return 200-m(Number(r.yValue(e)))});var b=v.selectAll(".".concat(a("bartext"))).data(e);if(b.exit().transition().duration(300).attr("y",function(e){return m(0)-5}).style("fill-opacity",1e-6).remove(),b.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return l(e.name)+l.bandwidth()/2}).attr("text-anchor","middle").attr("font-size","12px").attr("y",function(e){return m(0)-5}),v.selectAll(".".concat(a("bartext"))).data(e).attr("x",function(e){return l(e.name)+l.bandwidth()/2}).text(function(e){return r.yValueFormat(r.yValue(e))}).transition().duration(300).attr("y",function(e){return m(Number(r.yValue(e)))-5}),r.showLegend){var E=[],I=[];e.forEach(function(e){var t=e.partyInfo,n=t.name;-1===I.indexOf(t.iecId)&&t.iecId&&(E.push(n),I.push(t.iecId))}),c.selectAll(".".concat(a("legend"))).remove();var x=c.selectAll(".".concat(a("legend"))).data(E).enter().append("g").attr("class",a("legend")).attr("transform",function(e,t){return"translate("+function(e){var t=[i+e%5*100,230+40*parseInt(e/5)];return E.length<6&&(t[0]+=100*(6-E.length)/2),t}(t)+")"});x.append("rect").attr("width",10).attr("height",10).attr("x",0).attr("y",0).attr("fill",function(e,t){return f(e)}),x.append("text").attr("x",30).attr("y",10).style("font-size","12px").text(function(e){return o[e]})}},this.destroy=function(){c.remove()}}var _=n(8),X=n.n(_),Y="region-change",J="chart-preview",Q="seats-electeds-event",$="map-preview",ee="quick-results-preview",te="export-png",ne="export-superwidget-png",ae=n(6),re=n(7),ie=n.n(re),oe=n(60),se=n(61),ce=n(62),ue=new oe.a({link:new se.a({uri:"https://eds.elections.sabc.co.za/graphql",useGETForQueries:!0,headers:{"Content-Type":"application/graphql"}}),cache:new ce.a});function le(){var e=Object(ae.a)(['\n        {\n            allSeatCalculations(\n              province:"','", \n              event:"','", \n              orderBy:["-seats"]\n            ) {\n              edges{\n                node\n                {\n                  nationalPr\n                  regional\n                  party{\n                    name\n                    abbreviation\n                    iecId\n                  }\n                  province{\n                    name\n                    country{\n                      event{\n                        description\n                      }\n                    }\n                  }\n                }\n              }\n            }\n        }\n        ']);return le=function(){return e},e}function me(){var e=Object(ae.a)(['\n        {\n            allSeatCalculations(\n              event:"','", \n              orderBy:["-seats"]\n            ) {\n              edges{\n                node\n                {\n                  nationalPr\n                  regional\n                  party{\n                    name\n                    abbreviation\n                    iecId\n                  }\n                  province{\n                    name\n                    country{\n                      event{\n                        description\n                      }\n                    }\n                  }\n                }\n              }\n            }\n        }\n        ']);return me=function(){return e},e}function de(){var e=Object(ae.a)(['\n      {\n          allSeatCalculations(\n            province:"','", \n            orderBy:["-seats"]\n          ) {\n            edges{\n              node\n              {\n                nationalPr\n                regional\n                party{\n                  event {\n                    description\n                  }\n                  name\n                  abbreviation\n                  iecId\n                }\n                province{\n                  name\n                }\n              }\n            }\n          }\n      }\n      ']);return de=function(){return e},e}function pe(){var e=Object(ae.a)(['\n      {\n          allSeatCalculations(\n            eventType:"National Election" \n            orderBy:["-seats"]){\n            edges{\n              node\n              {\n                nationalPr\n                regional\n                party{\n                  event {\n                    description\n                  }\n                  name\n                  abbreviation\n                  iecId\n                }\n                province{\n                  name\n                }\n              }\n            }\n          }\n      }\n      ']);return pe=function(){return e},e}function ve(e){return"national"===e.regionType?ue.query({query:ie()(pe())}):ue.query({query:ie()(de(),e.provinceName)})}function he(e){var t=e.eventDescription;if(t)return"national"===e.regionType?ue.query({query:ie()(me(),t)}):(t=(t=(t=t.replace("National","Provincial")).replace("NATIONAL","PROVINCIAL")).replace("national","provincial"),ue.query({query:ie()(le(),e.provinceName,t)}))}function fe(){var e=Object(ae.a)(['\n          {\n            topPartiesByVotingDistrict(\n              event:"','", \n              province:"','",\n              municipalCode: "','"\n            ) {\n              \n              edges {\n                node {\n                  location{\n                    iecId\n                  }\n                  topParty{\n                    party{\n                      name\n                      abbreviation\n                      iecId\n                    }\n                  }\n                }\n              }\n            }\n          }\n          ']);return fe=function(){return e},e}function Ne(){var e=Object(ae.a)(['\n        {\n          topPartiesByMunicipality(\n            event:"','", \n            province:"','") {\n            \n            edges {\n              node {\n                location{\n                    code\n                    name\n                    longName\n                }\n                totalVotesCast\n                topParty{\n                  party {               \n                    name\n                    abbreviation\n                    iecId\n                  }\n                  validVotes\n                  percOfVotes\n                }\n              }\n            }\n          }\n        }\n        ']);return Ne=function(){return e},e}function ye(){var e=Object(ae.a)(['\n        {\n          topPartiesByProvince(event:"','") {\n            edges {\n              node {\n                location{\n                  id\n                  name\n                }\n                totalVotesCast\n                topParty{\n                  validVotes\n                  percOfVotes\n                  party {\n                      id\n                      name\n                      abbreviation\n                      iecId\n                  }\n                }\n              }\n            }\n          }\n        }\n        ']);return ye=function(){return e},e}function ge(){var e=Object(ae.a)(['\n        {\n          allVotingDistrictBallots(\n            event:"','",\n            iecId:"','"\n          ) {\n            edges{\n              node{\n                location {\n                  iecId\n                  ward {\n                    municipality {\n                      code\n                      province {\n                        name\n                      }\n                    }\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party{\n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }  \n                }\n              }\n            }\n          }\n        }\n        ']);return ge=function(){return e},e}function Ce(){var e=Object(ae.a)(['\n        {\n          allMunicipalBallots(\n            event:"','",\n            province:"','", \n            municipalCode: "','"\n          ) {\n            edges{\n              node {\n                partyResults {\n                  edges{\n                    node{\n                      party {               \n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }\n                  \n                }\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        ']);return Ce=function(){return e},e}function be(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            event:"','",\n            province:"','"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return be=function(){return e},e}function Ee(){var e=Object(ae.a)(['\n        {\n          allBallots(\n            event:"','"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                  \n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return Ee=function(){return e},e}function Ie(){var e=Object(ae.a)(['\n        {\n          allVotingDistrictBallots(\n            iecId:"','"\n          ) {\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                location {\n                  iecId\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party{\n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }  \n                }\n              }\n            }\n          }\n        }\n        ']);return Ie=function(){return e},e}function xe(){var e=Object(ae.a)(['\n        {\n          allMunicipalBallots(\n            province:"','", \n            municipalCode: "','"\n          ) {\n            edges{\n              node {\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party {               \n                        name\n                        abbreviation\n                        iecId\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }\n                  \n                }\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        ']);return xe=function(){return e},e}function Pe(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            province:"','"\n          ){\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return Pe=function(){return e},e}function we(){var e=Object(ae.a)(["\n        {\n          allBallots{\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                        iecId\n                      }\n                    }\n                  }\n                  \n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        "]);return we=function(){return e},e}function Ae(){var e=Object(ae.a)(['\n      {\n        allVotingDistrictBallots(\n          iecId:"','", \n        ) {\n          edges{\n            node{\n              event {\n                description\n              }\n              location {\n                iecId\n              }\n              partyResults {\n                edges{\n                  node{\n                    party{\n                      name\n                    }\n                    percOfVotes\n                  }\n                }  \n              }\n            }\n          }\n        }\n      }\n      ']);return Ae=function(){return e},e}function Te(){var e=Object(ae.a)(['\n      {\n        allMunicipalBallots(\n          province:"','", \n          municipalCode: "','"\n        ) {\n          edges{\n            node {\n              event {\n                description\n              }\n              partyResults {\n                edges{\n                  node{\n                    party {               \n                      name\n                      abbreviation\n                      iecId\n                    }\n                    validVotes\n                    percOfVotes\n                  }\n                }\n                \n              }\n              location {\n                code\n                name\n                longName\n              }\n            }\n          }\n        }\n      }\n      ']);return Te=function(){return e},e}function Me(){var e=Object(ae.a)(['\n      {\n        allProvincialBallots(\n          province:"','"\n        ){\n          edges{\n            node{\n              event {\n                description\n              }\n              partyResults {\n                edges{\n                  node{\n                    percOfVotes\n                    party {\n                      name\n                      abbreviation\n                      iecId\n                    }\n                  }\n                }\n              }\n              location {\n                name\n              }\n            }\n          }\n        }\n      }\n      ']);return Me=function(){return e},e}function Oe(){var e=Object(ae.a)(["\n      {\n        allBallots{\n          edges{\n            node{\n              event {\n                description\n              }\n              partyResults {\n                edges{\n                  node{\n                    percOfVotes\n                    party {\n                      name\n                      abbreviation\n                      iecId\n                    }\n                  }\n                }\n              }\n              location {\n                name\n              }\n            }\n          }\n        }\n      }\n      "]);return Oe=function(){return e},e}function Le(){var e=Object(ae.a)(['\n        {\n          CSIRPrediction(eventType: "','", areaType:"Provincial", province: "','") {\n            turnout\n            timestamp\n            results{\n              edges{\n                node{\n                  percVds\n                  prediction{\n                    edges{\n                      node{\n                        party{\n                          name\n                          abbreviation\n                          iecId\n                        }\n                        actualPercent\n                        predictedPercent\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }']);return Le=function(){return e},e}function Se(){var e=Object(ae.a)(['\n        {\n          CSIRPrediction(eventType: "','", areaType:"National") {\n            turnout\n            timestamp\n            results{\n              edges{\n                node{\n                  percVds\n                  prediction{\n                    edges{\n                      node{\n                        party{\n                          name\n                          abbreviation\n                          iecId\n                        }\n                        actualPercent\n                        predictedPercent\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }']);return Se=function(){return e},e}function ke(e){if("national"===e.regionType)return ue.query({query:ie()(Oe())});if("province"===e.regionType)return ue.query({query:ie()(Me(),e.provinceName)});if("municipality"===e.regionType){var t=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()(Te(),e.provinceName,t)})}return"municipality-vd"===e.regionType?ue.query({query:ie()(Ae(),e.iecId)}):void 0}function Ve(e){var t=e.eventDescription;if(t){if("national"===e.regionType)return ue.query({query:ie()(Ee(),t)});if("province"===e.regionType)return ue.query({query:ie()(be(),t,e.provinceName)});if("municipality"===e.regionType){var n=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()(Ce(),t,e.provinceName,n)})}return"municipality-vd"===e.regionType?ue.query({query:ie()(ge(),t,e.iecId)}):void 0}}function je(){var e=Object(ae.a)(['\n          {\n            allVotingDistrictBallots(\n              iecId:"','" \n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          ']);return je=function(){return e},e}function De(){var e=Object(ae.a)(['\n          {\n            allMunicipalBallots( \n              province:"','", \n              municipalCode: "','"\n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          ']);return De=function(){return e},e}function Ke(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            province:"','"\n          ) {\n            edges{\n              node {\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        ']);return Ke=function(){return e},e}function Fe(){var e=Object(ae.a)(["\n        {\n          allBallots{\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        "]);return Fe=function(){return e},e}function Re(){var e=Object(ae.a)(['\n          {\n            allVotingDistrictBallots(\n              event:"','"\n              iecId:"','"\n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          ']);return Re=function(){return e},e}function We(){var e=Object(ae.a)(['\n          {\n            allMunicipalBallots( \n              event:"','"\n              province:"','", \n              municipalCode: "','"\n            ) {\n              edges{\n                node{\n                  event {\n                    description\n                    eventType {\n                      description\n                    }\n                  }\n                  percVoterTurnout\n                }\n              }\n            }\n          }\n          ']);return We=function(){return e},e}function Be(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            event:"','"\n            province:"','"\n          ) {\n            edges{\n              node {\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        ']);return Be=function(){return e},e}function Ge(){var e=Object(ae.a)(['\n        {\n          allBallots(\n            event:"','"\n          ) {\n            edges{\n              node{\n                event {\n                  description\n                  eventType {\n                    description\n                  }\n                }\n                percVoterTurnout\n              }\n            }\n          }\n        }\n        ']);return Ge=function(){return e},e}function Ze(){var e=Object(ae.a)(['\n          {\n            allVotingDistrictBallots( \n              event:"','",\n              municipalCode:"','"\n            ) {\n              edges{\n                node{\n                  location {\n                    iecId\n                  }\n                  percVoterTurnout\n                  vdCount\n                  vdWithResultsCaptured\n                }\n              }\n            }\n          }\n          ']);return Ze=function(){return e},e}function Ue(){var e=Object(ae.a)(['\n        {\n          allMunicipalBallots(\n            event:"','",\n            province:"','"\n          ) {\n            edges{\n              node {\n                percVoterTurnout\n                vdCount\n                vdWithResultsCaptured\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        ']);return Ue=function(){return e},e}function qe(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            event:"','"\n          ){\n            edges{\n              node{\n                percVoterTurnout\n                vdCount\n                vdWithResultsCaptured\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return qe=function(){return e},e}function ze(e){var t=e.eventDescription;if(t){if("national"===e.regionType)return ue.query({query:ie()(Ge(),t)});if("province"===e.regionType)return ue.query({query:ie()(Be(),t,e.provinceName)});if("municipality"===e.regionType){var n=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()(We(),t,e.provinceName,n)})}return"municipality-vd"===e.regionType?ue.query({query:ie()(Re(),t,e.iecId)}):void 0}}function He(){var e=Object(ae.a)(['\n          {\n            allVotingDistrictBallots(\n              event:"','",\n              iecId:"','"\n            ) {\n              edges{\n                node{\n                  location {\n                    iecId\n                  }\n                  spoiltVotes\n                  totalVotesCast\n                  totalValidVotes\n                }\n              }\n            }\n          }\n          ']);return He=function(){return e},e}function _e(){var e=Object(ae.a)(['\n          {\n            allMunicipalBallots( \n                event:"','",\n                province:"','", \n                municipalCode: "','"\n            ) {\n              edges{\n                node{\n                  location {\n                    code\n                    name\n                    longName\n                  }\n                  spoiltVotes\n                  totalVotesCast\n                  totalValidVotes\n                }\n              }\n            }\n          }\n          ']);return _e=function(){return e},e}function Xe(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            event:"','",\n            province:"','"\n          ) {\n            edges{\n              node {\n                spoiltVotes\n                totalVotesCast\n                totalValidVotes\n                location {\n                    id\n                    name\n                }\n              }\n            }\n          }\n        }\n        ']);return Xe=function(){return e},e}function Ye(){var e=Object(ae.a)(['\n        {\n          allBallots(\n            event:"','"\n          ){\n            edges{\n              node{\n                spoiltVotes\n                totalVotesCast\n                totalValidVotes\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return Ye=function(){return e},e}function Je(e){var t=e.eventDescription;if(t){if("national"===e.regionType)return ue.query({query:ie()(Ye(),t)});if("province"===e.regionType)return ue.query({query:ie()(Xe(),t,e.provinceName)});if("municipality"===e.regionType){var n=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()(_e(),t,e.provinceName,n)})}return"municipality-vd"===e.regionType?ue.query({query:ie()(He(),t,e.iecId)}):void 0}}function Qe(){var e=Object(ae.a)(['\n        {\n          allVotingDistrictBallots(\n            event:"','",\n            iecId:"','"\n          ) {\n            edges{\n              node{\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        ']);return Qe=function(){return e},e}function $e(){var e=Object(ae.a)(['\n        {\n          allMunicipalBallots(\n            event:"','",\n            province:"','", \n            municipalCode: "','"\n          ) {\n            edges{\n              node {\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        ']);return $e=function(){return e},e}function et(){var e=Object(ae.a)(['\n        {\n          allProvincialBallots(\n            event:"','",\n            province:"','"\n          ){\n            edges{\n              node{\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        ']);return et=function(){return e},e}function tt(){var e=Object(ae.a)(['\n        {\n          allBallots(\n            event:"','"\n          ){\n            edges{\n              node{\n                vdCount\n                vdWithResultsCaptured\n              }\n            }\n          }\n        }\n        ']);return tt=function(){return e},e}function nt(e){var t=e.eventDescription;if(t){if("national"==e.regionType)return ue.query({query:ie()(tt(),t)});if("province"==e.regionType)return ue.query({query:ie()(et(),t,e.provinceName)});if("municipality"==e.regionType){var n=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()($e(),t,e.provinceName,n)})}return"municipality-vd"==e.regionType?ue.query({query:ie()(Qe(),t,e.iecId)}):void 0}}function at(){var e=Object(ae.a)(["\n    {\n      allParties {\n        edges{\n          node{\n            name\n            abbreviation\n            colour\n            iecId\n          }\n        }\n      }\n    }\n    "]);return at=function(){return e},e}function rt(){return ue.query({query:ie()(at())})}function it(){var e=[{name:"Limpopo",abbreviation:"LIM",munis:[{provinceName:"Limpopo",muniName:"LIM331 - Greater Giyani [Giyani]",muniCode:"LIM331"},{provinceName:"Limpopo",muniName:"LIM332 - Greater Letaba [Duiwelskloof]",muniCode:"LIM332"},{provinceName:"Limpopo",muniName:"LIM333 - Greater Tzaneen [Tzaneen]",muniCode:"LIM333"},{provinceName:"Limpopo",muniName:"LIM334 - Ba-Phalaborwa [Phalaborwa]",muniCode:"LIM334"},{provinceName:"Limpopo",muniName:"LIM335 - Maruleng [Hoedspruit]",muniCode:"LIM335"},{provinceName:"Limpopo",muniName:"LIM341 - Musina [Messina]",muniCode:"LIM341"},{provinceName:"Limpopo",muniName:"LIM342 - Mutale [Mutale-Masisi]",muniCode:"LIM342"},{provinceName:"Limpopo",muniName:"LIM343 - Thulamela [Thohoyandou]",muniCode:"LIM343"},{provinceName:"Limpopo",muniName:"LIM344 - Makhado [Louis Trichardt]",muniCode:"LIM344"},{provinceName:"Limpopo",muniName:"LIM351 - Blouberg [Bochum/My Darling]",muniCode:"LIM351"},{provinceName:"Limpopo",muniName:"LIM352 - Aganang [Moletji/Matlala]",muniCode:"LIM352"},{provinceName:"Limpopo",muniName:"LIM353 - Molemole [Dendron/Dikgale]",muniCode:"LIM353"},{provinceName:"Limpopo",muniName:"LIM354 - Polokwane [Pietersburg]",muniCode:"LIM354"},{provinceName:"Limpopo",muniName:"LIM355 - Lepele-Nkumpi [Lebowakgomo]",muniCode:"LIM355"},{provinceName:"Limpopo",muniName:"LIM361 - Thabazimbi [Thabazimbi]",muniCode:"LIM361"},{provinceName:"Limpopo",muniName:"LIM362 - Lephalale [Ellisras]",muniCode:"LIM362"},{provinceName:"Limpopo",muniName:"LIM364 - Mookgopong [Naboomspruit]",muniCode:"LIM364"},{provinceName:"Limpopo",muniName:"LIM365 - Modimolle [Nylstroom]",muniCode:"LIM365"},{provinceName:"Limpopo",muniName:"LIM366 - Bela-Bela [Warmbad]",muniCode:"LIM366"},{provinceName:"Limpopo",muniName:"LIM367 - Mogalakwena [Potgietersrus]",muniCode:"LIM367"},{provinceName:"Limpopo",muniName:"LIM471 - Ephraim Mogale [Marble Hall]",muniCode:"LIM471"},{provinceName:"Limpopo",muniName:"LIM472 - Elias Motsoaledi [Groblersdal]",muniCode:"LIM472"},{provinceName:"Limpopo",muniName:"LIM473 - Makhuduthamaga [Ngwaritsi]",muniCode:"LIM473"},{provinceName:"Limpopo",muniName:"LIM474 - Fetakgomo [Fetakgomo ]",muniCode:"LIM474"},{provinceName:"Limpopo",muniName:"LIM475 - Greater Tubatse [Burgersfort/Ohrigstad/Eastern Tubatse]",muniCode:"LIM475"}]},{name:"Mpumalanga",abbreviation:"MP",munis:[{provinceName:"Mpumalanga",muniName:"MP301 - Albert Luthuli [Elukwatini/Carolina]",muniCode:"MP301"},{provinceName:"Mpumalanga",muniName:"MP302 - Msukaligwa [Ermelo]",muniCode:"MP302"},{provinceName:"Mpumalanga",muniName:"MP303 - Mkhondo [Piet Retief]",muniCode:"MP303"},{provinceName:"Mpumalanga",muniName:"MP304 - Pixley Ka Seme [Volksrust]",muniCode:"MP304"},{provinceName:"Mpumalanga",muniName:"MP305 - Lekwa [Standerton]",muniCode:"MP305"},{provinceName:"Mpumalanga",muniName:"MP306 - Dipaleseng [Balfour]",muniCode:"MP306"},{provinceName:"Mpumalanga",muniName:"MP307 - Govan Mbeki [Highveld Ridge]",muniCode:"MP307"},{provinceName:"Mpumalanga",muniName:"MP311 - Delmas [Delmas]",muniCode:"MP311"},{provinceName:"Mpumalanga",muniName:"MP312 - Emalahleni [Witbank]",muniCode:"MP312"},{provinceName:"Mpumalanga",muniName:"MP313 - Steve Tshwete [Middelburg]",muniCode:"MP313"},{provinceName:"Mpumalanga",muniName:"MP314 - Emakhazeni [Belfast]",muniCode:"MP314"},{provinceName:"Mpumalanga",muniName:"MP315 - Thembisile [KwaMhlanga]",muniCode:"MP315"},{provinceName:"Mpumalanga",muniName:"MP316 - Dr JS Moroka [Mdutjana]",muniCode:"MP316"},{provinceName:"Mpumalanga",muniName:"MP321 - Thaba Chweu [Sabie]",muniCode:"MP321"},{provinceName:"Mpumalanga",muniName:"MP322 - Mbombela [Nelspruit]",muniCode:"MP322"},{provinceName:"Mpumalanga",muniName:"MP323 - Umjindi [Barberton]",muniCode:"MP323"},{provinceName:"Mpumalanga",muniName:"MP324 - Nkomazi [Nkomazi]",muniCode:"MP324"},{provinceName:"Mpumalanga",muniName:"MP325 - Bushbuckridge [Bushbuckridge]",muniCode:"MP325"}]},{name:"Gauteng",abbreviation:"GT",munis:[{provinceName:"Gauteng",muniName:"EKU - Ekurhuleni [East Rand]",muniCode:"EKU"},{provinceName:"Gauteng",muniName:"GT421 - Emfuleni [Vereeniging]",muniCode:"GT421"},{provinceName:"Gauteng",muniName:"GT422 - Midvaal [Meyerton]",muniCode:"GT422"},{provinceName:"Gauteng",muniName:"GT423 - Lesedi [Heidelberg]",muniCode:"GT423"},{provinceName:"Gauteng",muniName:"GT481 - Mogale City [Krugersdorp]",muniCode:"GT481"},{provinceName:"Gauteng",muniName:"GT482 - Randfontein [Randfontein]",muniCode:"GT482"},{provinceName:"Gauteng",muniName:"GT483 - Westonaria [Westonaria]",muniCode:"GT483"},{provinceName:"Gauteng",muniName:"GT484 - Merafong City [Carletonville]",muniCode:"GT484"},{provinceName:"Gauteng",muniName:"JHB - City of Johannesburg [Johannesburg]",muniCode:"JHB"},{provinceName:"Gauteng",muniName:"TSH - Tshwane Metro [Pretoria]",muniCode:"TSH"}]},{name:"KwaZulu-Natal",abbreviation:"KZN",munis:[{provinceName:"KwaZulu-Natal",muniName:"ETH - eThekwini [Durban Metro]",muniCode:"ETH"},{provinceName:"KwaZulu-Natal",muniName:"KZN211 - Vulamehlo [Dududu]",muniCode:"KZN211"},{provinceName:"KwaZulu-Natal",muniName:"KZN212 - Umdoni [Scottburgh]",muniCode:"KZN212"},{provinceName:"KwaZulu-Natal",muniName:"KZN213 - Umzumbe [Umzumbe]",muniCode:"KZN213"},{provinceName:"KwaZulu-Natal",muniName:"KZN214 - UMuziwabantu [Harding]",muniCode:"KZN214"},{provinceName:"KwaZulu-Natal",muniName:"KZN215 - Ezinqoleni [Izinqolweni]",muniCode:"KZN215"},{provinceName:"KwaZulu-Natal",muniName:"KZN216 - Hibiscus Coast [Port Shepstone]",muniCode:"KZN216"},{provinceName:"KwaZulu-Natal",muniName:"KZN221 - uMshwathi [Wartburg]",muniCode:"KZN221"},{provinceName:"KwaZulu-Natal",muniName:"KZN222 - uMngeni [Howick]",muniCode:"KZN222"},{provinceName:"KwaZulu-Natal",muniName:"KZN223 - Mooi Mpofana [Mooirivier]",muniCode:"KZN223"},{provinceName:"KwaZulu-Natal",muniName:"KZN224 - Impendle [Impendle]",muniCode:"KZN224"},{provinceName:"KwaZulu-Natal",muniName:"KZN225 - Msunduzi [Pietermaritzburg]",muniCode:"KZN225"},{provinceName:"KwaZulu-Natal",muniName:"KZN226 - Mkhambathini [Camperdown]",muniCode:"KZN226"},{provinceName:"KwaZulu-Natal",muniName:"KZN227 - Richmond [Richmond]",muniCode:"KZN227"},{provinceName:"KwaZulu-Natal",muniName:"KZN232 - Emnambithi/Ladysmith [Ladysmith]",muniCode:"KZN232"},{provinceName:"KwaZulu-Natal",muniName:"KZN233 - Indaka [Waaihoek]",muniCode:"KZN233"},{provinceName:"KwaZulu-Natal",muniName:"KZN234 - Umtshezi [Estcourt]",muniCode:"KZN234"},{provinceName:"KwaZulu-Natal",muniName:"KZN235 - Okhahlamba [Bergville]",muniCode:"KZN235"},{provinceName:"KwaZulu-Natal",muniName:"KZN236 - Imbabazane [Loskop]",muniCode:"KZN236"},{provinceName:"KwaZulu-Natal",muniName:"KZN241 - Endumeni [Dundee]",muniCode:"KZN241"},{provinceName:"KwaZulu-Natal",muniName:"KZN242 - Nqutu [Nqutu]",muniCode:"KZN242"},{provinceName:"KwaZulu-Natal",muniName:"KZN244 - Msinga [Pomeroy]",muniCode:"KZN244"},{provinceName:"KwaZulu-Natal",muniName:"KZN245 - Umvoti [Greytown]",muniCode:"KZN245"},{provinceName:"KwaZulu-Natal",muniName:"KZN252 - Newcastle [Newcastle]",muniCode:"KZN252"},{provinceName:"KwaZulu-Natal",muniName:"KZN253 - eMadlangeni [Utrecht]",muniCode:"KZN253"},{provinceName:"KwaZulu-Natal",muniName:"KZN254 - Dannhauser [Durnacol]",muniCode:"KZN254"},{provinceName:"KwaZulu-Natal",muniName:"KZN261 - eDumbe [Paulpietersburg]",muniCode:"KZN261"},{provinceName:"KwaZulu-Natal",muniName:"KZN262 - UPhongolo [Pongola]",muniCode:"KZN262"},{provinceName:"KwaZulu-Natal",muniName:"KZN263 - Abaqulusi [Vryheid]",muniCode:"KZN263"},{provinceName:"KwaZulu-Natal",muniName:"KZN265 - Nongoma [Nongoma]",muniCode:"KZN265"},{provinceName:"KwaZulu-Natal",muniName:"KZN266 - Ulundi [Ulundi]",muniCode:"KZN266"},{provinceName:"KwaZulu-Natal",muniName:"KZN271 - Umhlabuyalingana [Emangusi]",muniCode:"KZN271"},{provinceName:"KwaZulu-Natal",muniName:"KZN272 - Jozini [Mkuze]",muniCode:"KZN272"},{provinceName:"KwaZulu-Natal",muniName:"KZN273 - The Big 5 False Bay [Hluhluwe]",muniCode:"KZN273"},{provinceName:"KwaZulu-Natal",muniName:"KZN274 - Hlabisa [Somkele]",muniCode:"KZN274"},{provinceName:"KwaZulu-Natal",muniName:"KZN275 - Mtubatuba [Mtubatuba]",muniCode:"KZN275"},{provinceName:"KwaZulu-Natal",muniName:"KZN281 - Mfolozi [KwaMbonambi]",muniCode:"KZN281"},{provinceName:"KwaZulu-Natal",muniName:"KZN282 - uMhlathuze [Richards Bay]",muniCode:"KZN282"},{provinceName:"KwaZulu-Natal",muniName:"KZN283 - Ntambana [Ntambana]",muniCode:"KZN283"},{provinceName:"KwaZulu-Natal",muniName:"KZN284 - uMlalazi [Eshowe]",muniCode:"KZN284"},{provinceName:"KwaZulu-Natal",muniName:"KZN285 - Mthonjaneni [Melmoth]",muniCode:"KZN285"},{provinceName:"KwaZulu-Natal",muniName:"KZN286 - Nkandla [Nkandla]",muniCode:"KZN286"},{provinceName:"KwaZulu-Natal",muniName:"KZN291 - Mandeni [Mandeni]",muniCode:"KZN291"},{provinceName:"KwaZulu-Natal",muniName:"KZN292 - KwaDukuza [Stanger]",muniCode:"KZN292"},{provinceName:"KwaZulu-Natal",muniName:"KZN293 - Ndwedwe [Ndwedwe]",muniCode:"KZN293"},{provinceName:"KwaZulu-Natal",muniName:"KZN294 - Maphumulo [Maphumulo]",muniCode:"KZN294"},{provinceName:"KwaZulu-Natal",muniName:"KZN431 - Ingwe [Creighton]",muniCode:"KZN431"},{provinceName:"KwaZulu-Natal",muniName:"KZN432 - Kwa Sani [Underberg]",muniCode:"KZN432"},{provinceName:"KwaZulu-Natal",muniName:"KZN433 - Greater Kokstad [Kokstad]",muniCode:"KZN433"},{provinceName:"KwaZulu-Natal",muniName:"KZN434 - Ubuhlebezwe [Ixopo]",muniCode:"KZN434"},{provinceName:"KwaZulu-Natal",muniName:"KZN435 - Umzimkhulu [Umzimkulu]",muniCode:"KZN435"}]},{name:"North West",abbreviation:"NW",munis:[{provinceName:"North West",muniName:"NW371 - Moretele [Makapanstad]",muniCode:"NW371"},{provinceName:"North West",muniName:"NW372 - Madibeng [Brits]",muniCode:"NW372"},{provinceName:"North West",muniName:"NW373 - Rustenburg [Rustenburg]",muniCode:"NW373"},{provinceName:"North West",muniName:"NW374 - Kgetlengrivier [Koster]",muniCode:"NW374"},{provinceName:"North West",muniName:"NW375 - Moses Kotane [Mogwase]",muniCode:"NW375"},{provinceName:"North West",muniName:"NW381 - Ratlou [Setlagole]",muniCode:"NW381"},{provinceName:"North West",muniName:"NW382 - Tswaing [Delareyville]",muniCode:"NW382"},{provinceName:"North West",muniName:"NW383 - Mafikeng [Mafikeng]",muniCode:"NW383"},{provinceName:"North West",muniName:"NW384 - Ditsobotla [Lichtenburg]",muniCode:"NW384"},{provinceName:"North West",muniName:"NW385 - Ramotshere Moiloa [Zeerust]",muniCode:"NW385"},{provinceName:"North West",muniName:"NW392 - Naledi [Vryburg]",muniCode:"NW392"},{provinceName:"North West",muniName:"NW393 - Mamusa [Schweizer-Reneke]",muniCode:"NW393"},{provinceName:"North West",muniName:"NW394 - Greater Taung [Reivilo]",muniCode:"NW394"},{provinceName:"North West",muniName:"NW396 - Lekwa-Teemane [Christiana]",muniCode:"NW396"},{provinceName:"North West",muniName:"NW397 - NW397 Local Municipality [Ganyesa/Pomfret]",muniCode:"NW397"},{provinceName:"North West",muniName:"NW401 - Ventersdorp [Ventersdorp]",muniCode:"NW401"},{provinceName:"North West",muniName:"NW402 - Tlokwe [Potchefstroom]",muniCode:"NW402"},{provinceName:"North West",muniName:"NW403 - Matlosana [Klerksdorp]",muniCode:"NW403"},{provinceName:"North West",muniName:"NW404 - Maquassi Hills [Wolmaransstad]",muniCode:"NW404"}]},{name:"Free State",abbreviation:"FS",munis:[{provinceName:"Free State",muniName:"FS161 - Letsemeng [Koffiefontein]",muniCode:"FS161"},{provinceName:"Free State",muniName:"FS162 - Kopanong [Trompsburg]",muniCode:"FS162"},{provinceName:"Free State",muniName:"FS163 - Mohokare [Zastron]",muniCode:"FS163"},{provinceName:"Free State",muniName:"FS164 - Naledi [Dewetsdorp]",muniCode:"FS164"},{provinceName:"Free State",muniName:"FS181 - Masilonyana [Theunissen]",muniCode:"FS181"},{provinceName:"Free State",muniName:"FS182 - Tokologo [Dealesville]",muniCode:"FS182"},{provinceName:"Free State",muniName:"FS183 - Tswelopele [Hoopstad]",muniCode:"FS183"},{provinceName:"Free State",muniName:"FS184 - Matjhabeng [Welkom]",muniCode:"FS184"},{provinceName:"Free State",muniName:"FS185 - Nala [Bothaville]",muniCode:"FS185"},{provinceName:"Free State",muniName:"FS191 - Setsoto [Senekal]",muniCode:"FS191"},{provinceName:"Free State",muniName:"FS192 - Dihlabeng [Bethlehem]",muniCode:"FS192"},{provinceName:"Free State",muniName:"FS193 - Nketoana [Reitz]",muniCode:"FS193"},{provinceName:"Free State",muniName:"FS194 - Maluti a Phofung [Qwa-Qwa]",muniCode:"FS194"},{provinceName:"Free State",muniName:"FS195 - Phumelela [Vrede]",muniCode:"FS195"},{provinceName:"Free State",muniName:"FS196 - Mantsopa [Ladybrand]",muniCode:"FS196"},{provinceName:"Free State",muniName:"FS201 - Moqhaka [Kroonstad]",muniCode:"FS201"},{provinceName:"Free State",muniName:"FS203 - Ngwathe [Parys]",muniCode:"FS203"},{provinceName:"Free State",muniName:"FS204 - Metsimaholo [Sasolburg]",muniCode:"FS204"},{provinceName:"Free State",muniName:"FS205 - Mafube [Frankfort]",muniCode:"FS205"},{provinceName:"Free State",muniName:"MAN - Mangaung [Bloemfontein]",muniCode:"MAN"}]},{name:"Eastern Cape",abbreviation:"EC",munis:[{provinceName:"Eastern Cape",muniName:"BUF - Buffalo City [East London]",muniCode:"BUF"},{provinceName:"Eastern Cape",muniName:"EC101 - Camdeboo [Graaff-Reinet]",muniCode:"EC101"},{provinceName:"Eastern Cape",muniName:"EC102 - Blue Crane Route [Somerset East]",muniCode:"EC102"},{provinceName:"Eastern Cape",muniName:"EC103 - Ikwezi [Jansenville]",muniCode:"EC103"},{provinceName:"Eastern Cape",muniName:"EC104 - Makana [Grahamstown]",muniCode:"EC104"},{provinceName:"Eastern Cape",muniName:"EC105 - Ndlambe [Port Alfred]",muniCode:"EC105"},{provinceName:"Eastern Cape",muniName:"EC106 - Sundays River Valley [Kirkwood]",muniCode:"EC106"},{provinceName:"Eastern Cape",muniName:"EC107 - Baviaans [Willowmore]",muniCode:"EC107"},{provinceName:"Eastern Cape",muniName:"EC108 - Kouga [Humansdorp]",muniCode:"EC108"},{provinceName:"Eastern Cape",muniName:"EC109 - Kou-Kamma [Kareedouw]",muniCode:"EC109"},{provinceName:"Eastern Cape",muniName:"EC121 - Mbhashe [Idutywa]",muniCode:"EC121"},{provinceName:"Eastern Cape",muniName:"EC122 - Mnquma [Butterworth]",muniCode:"EC122"},{provinceName:"Eastern Cape",muniName:"EC123 - Great Kei [Komga]",muniCode:"EC123"},{provinceName:"Eastern Cape",muniName:"EC124 - Amahlathi [Stutterheim]",muniCode:"EC124"},{provinceName:"Eastern Cape",muniName:"EC126 - Ngqushwa [Peddie]",muniCode:"EC126"},{provinceName:"Eastern Cape",muniName:"EC127 - Nkonkobe [Alice]",muniCode:"EC127"},{provinceName:"Eastern Cape",muniName:"EC128 - Nxuba [Adelaide]",muniCode:"EC128"},{provinceName:"Eastern Cape",muniName:"EC131 - Inxuba Yethemba [Cradock]",muniCode:"EC131"},{provinceName:"Eastern Cape",muniName:"EC132 - Tsolwana [Tarkastad]",muniCode:"EC132"},{provinceName:"Eastern Cape",muniName:"EC133 - Inkwanca [Molteno]",muniCode:"EC133"},{provinceName:"Eastern Cape",muniName:"EC134 - Lukhanji [Queenstown]",muniCode:"EC134"},{provinceName:"Eastern Cape",muniName:"EC135 - Intsika Yethu [Cofimvaba]",muniCode:"EC135"},{provinceName:"Eastern Cape",muniName:"EC136 - Emalahleni [Lady Frere]",muniCode:"EC136"},{provinceName:"Eastern Cape",muniName:"EC137 - Engcobo [Engcobo]",muniCode:"EC137"},{provinceName:"Eastern Cape",muniName:"EC138 - Sakhisizwe [Elliot]",muniCode:"EC138"},{provinceName:"Eastern Cape",muniName:"EC141 - Elundini [Mount Fletcher]",muniCode:"EC141"},{provinceName:"Eastern Cape",muniName:"EC142 - Senqu [Lady Grey]",muniCode:"EC142"},{provinceName:"Eastern Cape",muniName:"EC143 - Maletswai [Aliwal North]",muniCode:"EC143"},{provinceName:"Eastern Cape",muniName:"EC144 - Gariep [Burgersdorp]",muniCode:"EC144"},{provinceName:"Eastern Cape",muniName:"EC153 - Ngquza Hill [Flagstaff]",muniCode:"EC153"},{provinceName:"Eastern Cape",muniName:"EC154 - Port St Johns [Port St Johns]",muniCode:"EC154"},{provinceName:"Eastern Cape",muniName:"EC155 - Nyandeni [Libode]",muniCode:"EC155"},{provinceName:"Eastern Cape",muniName:"EC156 - Mhlontlo [Qumbu]",muniCode:"EC156"},{provinceName:"Eastern Cape",muniName:"EC157 - King Sabata Dalindyebo [Umtata]",muniCode:"EC157"},{provinceName:"Eastern Cape",muniName:"EC441 - Matatiele [Matatiele]",muniCode:"EC441"},{provinceName:"Eastern Cape",muniName:"EC442 - Umzimvubu [Mount Ayliff]",muniCode:"EC442"},{provinceName:"Eastern Cape",muniName:"EC443 - Mbizana [Bizana]",muniCode:"EC443"},{provinceName:"Eastern Cape",muniName:"EC444 - Ntabankulu [Ntabankulu]",muniCode:"EC444"},{provinceName:"Eastern Cape",muniName:"NMA - Nelson Mandela Bay [Port Elizabeth]",muniCode:"NMA"}]},{name:"Northern Cape",abbreviation:"NC",munis:[{provinceName:"Northern Cape",muniName:"NC061 - RICHTERSVELD [Port Nolloth]",muniCode:"NC061"},{provinceName:"Northern Cape",muniName:"NC062 - NAMA KHOI [Springbok]",muniCode:"NC062"},{provinceName:"Northern Cape",muniName:"NC064 - KAMIESBERG [Garies]",muniCode:"NC064"},{provinceName:"Northern Cape",muniName:"NC065 - HANTAM [Calvinia]",muniCode:"NC065"},{provinceName:"Northern Cape",muniName:"NC066 - KAROO HOOGLAND [Fraserburg]",muniCode:"NC066"},{provinceName:"Northern Cape",muniName:"NC067 - KH\xe2I-MA [Pofadder]",muniCode:"NC067"},{provinceName:"Northern Cape",muniName:"NC071 - UBUNTU [Victoria West]",muniCode:"NC071"},{provinceName:"Northern Cape",muniName:"NC072 - UMSOBOMVU [Colesberg]",muniCode:"NC072"},{provinceName:"Northern Cape",muniName:"NC073 - EMTHANJENI [De Aar]",muniCode:"NC073"},{provinceName:"Northern Cape",muniName:"NC074 - KAREEBERG [Carnarvon]",muniCode:"NC074"},{provinceName:"Northern Cape",muniName:"NC075 - RENOSTERBERG [Phillipstown]",muniCode:"NC075"},{provinceName:"Northern Cape",muniName:"NC076 - THEMBELIHLE [Hopetown]",muniCode:"NC076"},{provinceName:"Northern Cape",muniName:"NC077 - SIYATHEMBA [Prieska]",muniCode:"NC077"},{provinceName:"Northern Cape",muniName:"NC078 - SIYANCUMA [Griekwastad]",muniCode:"NC078"},{provinceName:"Northern Cape",muniName:"NC081 - MIER [Mier]",muniCode:"NC081"},{provinceName:"Northern Cape",muniName:"NC082 - KAI !GARIB [Keimoes]",muniCode:"NC082"},{provinceName:"Northern Cape",muniName:"NC083 - KHARA HAIS [Upington]",muniCode:"NC083"},{provinceName:"Northern Cape",muniName:"NC084 - !KHEIS [Groblershoop]",muniCode:"NC084"},{provinceName:"Northern Cape",muniName:"NC085 - TSANTSABANE [Postmasburg]",muniCode:"NC085"},{provinceName:"Northern Cape",muniName:"NC086 - KGATELOPELE [Danielskuil]",muniCode:"NC086"},{provinceName:"Northern Cape",muniName:"NC091 - Sol Plaatje [Kimberley]",muniCode:"NC091"},{provinceName:"Northern Cape",muniName:"NC092 - Dikgatlong [Barkley West]",muniCode:"NC092"},{provinceName:"Northern Cape",muniName:"NC093 - Magareng [Warrenton]",muniCode:"NC093"},{provinceName:"Northern Cape",muniName:"NC094 - Phokwane [Hartswater]",muniCode:"NC094"},{provinceName:"Northern Cape",muniName:"NC451 - Joe Morolong [Kgalagadi]",muniCode:"NC451"},{provinceName:"Northern Cape",muniName:"NC452 - GA-SEGONYANA [Kuruman]",muniCode:"NC452"},{provinceName:"Northern Cape",muniName:"NC453 - GAMAGARA [Kathu]",muniCode:"NC453"}]},{name:"Western Cape",abbreviation:"WC",munis:[{provinceName:"Western Cape",muniName:"CPT - City of Cape Town [Cape Town]",muniCode:"CPT"},{provinceName:"Western Cape",muniName:"WC011 - Matzikama [Vredendal]",muniCode:"WC011"},{provinceName:"Western Cape",muniName:"WC012 - Cederberg [Citrusdal]",muniCode:"WC012"},{provinceName:"Western Cape",muniName:"WC013 - Bergrivier [Velddrif]",muniCode:"WC013"},{provinceName:"Western Cape",muniName:"WC014 - Saldanha Bay [West Coast Peninsula]",muniCode:"WC014"},{provinceName:"Western Cape",muniName:"WC015 - Swartland [Malmesbury]",muniCode:"WC015"},{provinceName:"Western Cape",muniName:"WC022 - Witzenberg [Ceres]",muniCode:"WC022"},{provinceName:"Western Cape",muniName:"WC023 - Drakenstein [Paarl]",muniCode:"WC023"},{provinceName:"Western Cape",muniName:"WC024 - Stellenbosch [Stellenbosch]",muniCode:"WC024"},{provinceName:"Western Cape",muniName:"WC025 - Breede Valley [Worcester]",muniCode:"WC025"},{provinceName:"Western Cape",muniName:"WC026 - Langeberg [Robertson]",muniCode:"WC026"},{provinceName:"Western Cape",muniName:"WC031 - Theewaterskloof [Caledon]",muniCode:"WC031"},{provinceName:"Western Cape",muniName:"WC032 - Overstrand [Greater Hermanus]",muniCode:"WC032"},{provinceName:"Western Cape",muniName:"WC033 - Cape Agulhas [Bredasdorp]",muniCode:"WC033"},{provinceName:"Western Cape",muniName:"WC034 - Swellendam [Barrydale/Swellendam ]",muniCode:"WC034"},{provinceName:"Western Cape",muniName:"WC041 - Kannaland [Ladismith]",muniCode:"WC041"},{provinceName:"Western Cape",muniName:"WC042 - Hessequa [Heidelberg/Riversdale]",muniCode:"WC042"},{provinceName:"Western Cape",muniName:"WC043 - Mossel Bay [Mossel Bay]",muniCode:"WC043"},{provinceName:"Western Cape",muniName:"WC044 - George [George]",muniCode:"WC044"},{provinceName:"Western Cape",muniName:"WC045 - Oudtshoorn [Oudtshoorn]",muniCode:"WC045"},{provinceName:"Western Cape",muniName:"WC047 - Bitou [Greater Plettenberg Bay]",muniCode:"WC047"},{provinceName:"Western Cape",muniName:"WC048 - Knysna [Knysna]",muniCode:"WC048"},{provinceName:"Western Cape",muniName:"WC051 - Laingsburg [Laingsburg]",muniCode:"WC051"},{provinceName:"Western Cape",muniName:"WC052 - Prince Albert [Prins Albert]",muniCode:"WC052"},{provinceName:"Western Cape",muniName:"WC053 - Beaufort West [Beaufort West]",muniCode:"WC053"}]}];return e.sort(function(e,t){return(""+e.name).localeCompare(t.name)}),e}var ot;function st(e){return h.a[e]||e}function ct(e){return st(N.CSS_PREFIX+e)}var ut,lt={chartType:"Race For Votes",yAxisLabel:"PERCENTAGE VOTES",dynamicYAxisFromValues:!0,customizeDynamicMaxValue:function(e){return Math.min(100,1.5*e)},yValue:function(e){return e.percOfVotes},yValueFormat:function(e){return e+"%"}},mt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={comp:"votes-default",numParties:5,eventDescription:"2019 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:1},Z(n.state,e),n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this.chart&&(this.chart.destroy(),this.chart=null),document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNG",value:function(e){e.detail.componentID===this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"race-for-votes-barchart(".concat(M(this.state),").png"))}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new H(this.getContainer(),null,null,st,lt),this.setState(t)}},{key:"getContainer",value:function(){return console.log(p),p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:ct("barchart")+" "+ct("stylesheet-".concat(t))},-1e3!==n&&r.a.createElement("div",{className:ct("chart-title")},lt.chartType," (",M(this.state),"): "),r.a.createElement("div",{ref:"vizcontainer",className:ct("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[Ve(t)];if(!ot){var r=rt();a.push(r)}Promise.all(a).then(function(a){var r=a[0];ot=ot||a[1],n.drawGraph(e,t,r,ot)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=C(n,t);if("votes-myvd"===t.comp){var i;i=r?function(e){var t=e.data.allVotingDistrictBallots.edges[0].node.location;return{regionType:"municipality-vd",iecId:t.iecId,muniCode:t.ward.municipality.code,provinceName:t.ward.municipality.province.name}}(n):{iecId:""};var o=!1;Object.keys(i).forEach(function(e){t[e]!==i[e]&&(o=!0)}),o&&D(Y,i)}this.chart||(this.chart=new H(e,null,null,st,lt)),this.chart.draw(r,a)}}]),t}(a.Component),dt={chartType:"Race For Seats",yAxisLabel:"Seats Count",dynamicYAxisFromValues:!0,yValue:function(e){return e.seats},yValueFormat:function(e){return e}};function pt(e){return h.a[e]||e}function vt(e){return pt(N.CSS_PREFIX+e)}a.Component;var ht={chartType:"Spoilt vs Valid Votes",yAxisLabel:"PERCENTAGE VOTES",noXaxisByParty:!0,yValue:function(e){return e.percent},yValueFormat:function(e){return e+"%"}};function ft(e){return h.a[e]||e}function Nt(e){return ft(N.CSS_PREFIX+e)}a.Component;var yt,gt=n(18),Ct=n(17),bt=n.n(Ct),Et=n(32),It=n.n(Et),xt=n(33),Pt=n.n(xt),wt="#9c9c9c";function At(e){return It.a[e]||e}function Tt(e){return At(N.CSS_PREFIX+e)}var Mt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={eventDescription:"2019 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",disableNavigation:!1,stylesheetFor:"web",componentID:3},Z(n.state,e),n.refreshIntervalID=0,n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t){this.drawGraph(e,t)}},{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener($,this.handlePreviewEvent)}},{key:"componentWillUnmount",value:function(){this.getContainer().selectAll("svg").remove(),document.removeEventListener(te,this.exportAsPNG),document.removeEventListener($,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(e,t){JSON.stringify(t)!==JSON.stringify(this.state)&&this.draw(this.getContainer(),this.state)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){var a=950,r=890,i=document.createElement("canvas");i.setAttribute("width",a),i.setAttribute("height",r),window.canvg(i,e.refs.vizcontainer.innerHTML,{ignoreDimensions:!0,scaleWidth:a,scaleHeight:r}),t(i.toDataURL("image/png;base64").split(",")[1])})}},{key:"exportAsPNG",value:function(e){if(e.detail.componentID===this.state.componentID){var t=950,n=890,a=document.createElement("canvas");if(a.setAttribute("width",t),a.setAttribute("height",n),!window.canvg)return console.error("canvg module not available");window.canvg(a,this.refs.vizcontainer.innerHTML,{ignoreDimensions:!0,scaleWidth:t,scaleHeight:n});var r,i=a,o="race-for-votes-map(".concat(M(this.state),").png"),s=document.createElement("a");s.download=o,s.href=i.toDataURL("image/png;base64"),document.createEvent?((r=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(r)):s.fireEvent&&s.fireEvent("onclick")}}},{key:"handlePreviewEvent",value:function(e){if(!this.state.disableNavigation){var t=e.detail;this.setState(t)}}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"getLoadingSpinner",value:function(){return p.select(this.refs.loading)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:At("map-widget")+" "+Tt("stylesheet-".concat(t))},-1e3!==n&&r.a.createElement("div",{className:Tt("map-title")},M(this.state)),r.a.createElement("div",{ref:"vizcontainer",className:At("map")}),r.a.createElement("div",{className:Tt("loading-spinner"),ref:"loading"},r.a.createElement(Pt.a,{type:"spin",color:"#777",height:100,width:100})))}},{key:"drawGraph",value:function(e,t){var n=this,a=this,r=N.DOMAIN+"/mapdata/"+B(a.state);a.getLoadingSpinner().style("display","block").transition().duration(200).style("opacity",1);var i=V(At),o=800;e.selectAll("svg").remove();var s=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 950 "+(o+90)).classed("svg-content",!0),c=p.json(r),u=[function(e){var t=e.eventDescription;if(t)return"national"===e.regionType?ue.query({query:ie()(ye(),t)}):"province"===e.regionType?ue.query({query:ie()(Ne(),t,e.provinceName)}):ue.query({query:ie()(fe(),t,e.provinceName,e.muniCode)})}(t)];if(!yt){var l=rt();u.push(l)}c.then(function(e){var n=e;Promise.all(u).then(function(e){var c=function(e,t){if(!e)return null;var n={},a=t.regionType;return"national"===a?e.data.topPartiesByProvince.edges.forEach(function(e){var t=e.node,a=t.location.name;n[a]=x(t)}):"province"===a?e.data.topPartiesByMunicipality.edges.forEach(function(e){var t=e.node,a=t.location.code;n[a]=x(t)}):e.data.topPartiesByVotingDistrict.edges.forEach(function(e){var t=e.node,a=t.location.iecId;n[a]=x(t)}),n}(e[0],t);yt=yt||e[1];var u,l={},m={};function d(e){return e&&l[e.split("/")[0]]||wt}function v(e,t){var n,r=a.state.regionType;if("national"===r){var i=e.properties.SPROVINCE;n=c[i]}else if("province"===r){var o=R(e.properties);n=c[o]}else if("municipality"===r){var s=W(e.properties);n=c[s]}else{s=W(e.properties);n=c[s]}return n}if(yt&&yt.data.allParties.edges&&yt.data.allParties.edges.forEach(function(e){l[e.node.name]=e.node.colour,m[e.node.name]=e.node.abbreviation}),-1!==r.indexOf(".topojson"))if("municipality"==(b=a.state.regionType)){if(!n.objects[a.state.muniCode])return;n=gt.a(n,n.objects[a.state.muniCode])}else{if(!n.objects[a.state.iecId])return;n=gt.a(n,n.objects[a.state.iecId])}u=n.features;var h=p.geoMercator().fitSize([900,o],n),f=p.geoPath().projection(h);s.selectAll(".".concat(At("region"))).data(u).enter().append("path").attr("class",At("region")).attr("stroke","#eeeeee").attr("fill",function(e,t){return d(v(e))}).attr("id",function(e,t){return"region-".concat(t)}).attr("d",f);var N=[],y=[];u.forEach(function(e,t){var n=v(e);n||(n=""),-1==N.indexOf(n)?(N.push(n),y.push(1)):y[N.indexOf(n)]++}),console.log("parties",N),console.log("availableCnt",y),N.sort(function(e,t){return e&&e.length?t&&t.length?y[N.indexOf(t)]-y[N.indexOf(e)]:-1:1});var C=s.selectAll(".".concat(At("legend"))).data(N).enter().append("g").attr("class",At("legend")).attr("transform",function(e,t){return"translate("+function(e){return[e%5*150,o+10+40*parseInt(e/5)]}(t)+")"});if(C.append("rect").attr("width",20).attr("height",20).attr("x",0).attr("y",0).attr("fill",function(e,t){return d(e)}),C.append("text").attr("x",30).attr("y",16).text(function(e){return m[e]||"No results available"}),-1==a.state.regionType.indexOf("municipality")&&s.selectAll(".place-label").data(u).enter().append("text").attr("class","place-label").attr("font-size","12px").attr("transform",function(e){var t,n;return"Polygon"===e.geometry.type?(t=bt()(e.geometry.coordinates),(n=h(t))[1]-=12,"translate("+n+")"):(t=bt()(e.geometry.coordinates[0]),(n=h(t))[1]-=5,"translate("+n+")")}).attr("dy",".35em").style("text-anchor","middle").text(function(e){return F(e.properties,a.state)}),-1==a.state.regionType.indexOf("municipality")&&j(),s.selectAll(".eventLayer").data(u).enter().append("path").attr("d",f).attr("class","eventLayer").attr("id",function(e,t){return"eventLayer-".concat(t)}).attr("fill","transparent").on("mouseover",function(e,t){p.select("#region-".concat(t)).attr("stroke-width",3).style("fill-opacity",.8)}).on("mousemove",function(e,t){var n;i.transition().duration(200).style("opacity",1),n=2019==g(a.state.eventDescription)?"no results available":"no previous results available";var r=v(e),o=F(e.properties,a.state);2019==g(a.state.eventDescription)||r||(o="province"===a.state.regionType?"New municipality":"New voting district");var s="undefined"!==typeof r&&r?o+" : "+r:o+" : "+n;i.html(s).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e,t){p.select("#region-".concat(t)).attr("stroke-width",1).style("fill-opacity",1),"municipality"!==a.state.regionType&&i.transition().duration(200).style("opacity",0)}).on("click",function(e,t){i.transition().duration(200).style("opacity",0);var n=a.state.regionType;if("national"===n)r={regionType:"province",provinceName:e.properties.SPROVINCE};else if("province"===n)r={regionType:"municipality",provinceName:a.state.provinceName,muniName:e.properties.smunicipal,muniCode:R(e.properties)};else{if("municipality"!==n)return;var r={regionType:"municipality-vd",provinceName:a.state.provinceName,muniName:a.state.muniName,muniCode:a.state.muniCode,iecId:W(e.properties)}}(v(e)||"municipality"!==n)&&(D(Y,r),a.state.disableNavigation||a.setState(r))}),!a.state.disableNavigation){var b,E=function(e,t,n){n&&e.append("span").html(" > "),e.append("span").style("height","30px").style("cursor","default").html(t)},I=function(e,t,n,r){r&&e.append("span").html(" > "),e.append("a").style("height","30px").style("cursor","pointer").html(t).on("click",function(){!function(e){var t;(t={regionType:a.state.regionType,provinceName:a.state.provinceName,muniName:a.state.muniName,muniCode:a.state.muniCode,iecId:a.state.iecId}).regionType=e,D(Y,t),a.setState(t)}(n)})},P=s.append("foreignObject").attr("x",0).attr("y",10).attr("width",500).attr("height",30).attr("class",At("map-controls")).append("xhtml:div");"national"==(b=a.state.regionType)?E(P,"South Africa",!1):(I(P,"South Africa","national",!1),"province"==b?E(P,a.state.provinceName,!0):(I(P,a.state.provinceName,"province",!0),"municipality"==b?E(P,a.state.muniCode,!0):(I(P,a.state.muniCode,"municipality",!0),E(P,a.state.iecId,!0))))}a.getLoadingSpinner().style("display","none")}).catch(function(e){console.error(e),console.log("failed to get data from server")})}).catch(function(e){if(console.error(e),a.getLoadingSpinner().style("display","none"),!a.state.disableNavigation){var t=M(n.state),r=a.state.regionType,i={regionType:a.state.regionType,provinceName:a.state.provinceName,muniName:a.state.muniName,muniCode:a.state.muniCode,iecId:a.state.iecId};"province"===r?i.regionType="national":"municipality"===r?i.regionType="province":"municipality-vd"===r&&(i.regionType="municipality"),D(Y,i),a.setState(i),setTimeout(function(){"national"==r||"province"==r?console.log("Can't get map data for $currentRegionName"):alert("".concat(t," has been disestablished"))},300)}})}}]),t}(a.Component);function Ot(e){return It.a[e]||e}function Lt(e){return Ot(N.CSS_PREFIX+e)}it();var St=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={isTurnout:!0,disableNavigation:!1,eventDescription:"2019 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:11},Z(n.state,e),console.log("updatedState",n.state,e),n.refreshIntervalID=0,n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t){this.drawGraph(e,t)}},{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener($,this.handlePreviewEvent)}},{key:"componentWillUnmount",value:function(){this.getContainer().selectAll("svg").remove(),document.removeEventListener(te,this.exportAsPNG),document.removeEventListener($,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(e,t){JSON.stringify(t)!==JSON.stringify(this.state)&&this.draw(this.getContainer(),this.state)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){var a=950,r=890,i=document.createElement("canvas");if(i.setAttribute("width",a),i.setAttribute("height",r),!window.canvg)return n("canvg module not available");window.canvg(i,e.refs.vizcontainer.innerHTML,{ignoreDimensions:!0,scaleWidth:a,scaleHeight:r}),t(i.toDataURL("image/png;base64").split(",")[1])})}},{key:"exportAsPNG",value:function(e){if(e.detail.componentID==this.state.componentID){var t=950,n=890,a=document.createElement("canvas");if(a.setAttribute("width",t),a.setAttribute("height",n),!window.canvg)return console.error("canvg module not available");window.canvg(a,this.refs.vizcontainer.innerHTML,{ignoreDimensions:!0,scaleWidth:t,scaleHeight:n});var r=a,i="turnout-map(".concat(M(this.state),").png");this.state.isTurnout||(i="counting-progress-map(".concat(M(this.state),").png"));var o,s=document.createElement("a");s.download=i,s.href=r.toDataURL("image/png;base64"),document.createEvent?((o=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(o)):s.fireEvent&&s.fireEvent("onclick")}}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"getLoadingSpinner",value:function(){return p.select(this.refs.loading)}},{key:"render",value:function(){var e=this.state,t=(e.disableNavigation,e.stylesheetFor),n=e.componentID;return r.a.createElement("div",{className:Ot("map-widget")+" "+Lt("stylesheet-".concat(t))},-1e3!=n&&r.a.createElement("div",{className:Lt("map-title")},M(this.state)),r.a.createElement("div",{ref:"vizcontainer",className:Ot("map")}),r.a.createElement("div",{className:Lt("loading-spinner"),ref:"loading"},r.a.createElement(Pt.a,{type:"spin",color:"#777",height:100,width:100})))}},{key:"drawGraph",value:function(e,t){var n=this,a=this,r=N.DOMAIN+"/mapdata/"+B(a.state);a.getLoadingSpinner().style("display","block").transition().duration(200).style("opacity",1);var i=V(Ot),o=800;e.selectAll("svg").remove();var s=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 950 "+(o+90)).classed("svg-content",!0),c=p.json(r),u=[function(e){var t=e.eventDescription;if(t)return"national"===e.regionType?ue.query({query:ie()(qe(),t)}):"province"===e.regionType?ue.query({query:ie()(Ue(),t,e.provinceName)}):ue.query({query:ie()(Ze(),t,e.muniCode)})}(t)];c.then(function(e){var n=e;Promise.all(u).then(function(e){var c,u;function l(e){return e>90?"#39711D":e>=80?"#458923":e>=70?"#53B025":e>=60?"#7CE547":e>=50?"#C5F3AF":"#D3F6C3"}function m(e){return e>=100?"#980043":e>=80?"#dd1c77":e>=60?"#df65b0":e>=40?"#c994c7":e>=20?"#d4b9da":e<=0?"#ffffff":"#f1eef6"}function d(e,t){var n,r=a.state.regionType;if("national"===r){var i=e.properties.SPROVINCE;n=c[i]}else if("province"===r){var o=R(e.properties);n=c[o]}else if("municipality"===r){var s=W(e.properties);n=c[s]}else{s=W(e.properties);n=c[s]}return n}if(c=a.state.isTurnout?function(e,t){if(!e)return null;var n={},a=t.regionType;return"national"===a?e.data.allProvincialBallots.edges.forEach(function(e){var t=e.node,a=t.location.name,r=t.percVoterTurnout.toFixed(2);n[a]=r}):"province"===a?e.data.allMunicipalBallots.edges.forEach(function(e){var t=e.node,a=t.location.code,r=t.percVoterTurnout.toFixed(2);n[a]=r}):e.data.allVotingDistrictBallots.edges.forEach(function(e){var t=e.node,a=t.location.iecId,r=t.percVoterTurnout.toFixed(2);n[a]=r}),n}(e[0],t):function(e,t){if(!e)return null;var n={},a=t.regionType;return"national"===a?e.data.allProvincialBallots.edges.forEach(function(e){var t=e.node,a=t.location.name;n[a]=y(t.vdWithResultsCaptured,t.vdCount)}):"province"===a?e.data.allMunicipalBallots.edges.forEach(function(e){var t=e.node,a=t.location.code;n[a]=y(t.vdWithResultsCaptured,t.vdCount)}):e.data.allVotingDistrictBallots.edges.forEach(function(e){var t=e.node,a=t.location.iecId;n[a]=y(t.vdWithResultsCaptured,t.vdCount)}),n}(e[0],t),-1!==r.indexOf(".topojson"))if("municipality"==(N=a.state.regionType)){if(!n.objects[a.state.muniCode])return;n=gt.a(n,n.objects[a.state.muniCode])}else{if(!n.objects[a.state.iecId])return;n=gt.a(n,n.objects[a.state.iecId])}u=n.features;var v=p.geoMercator().fitSize([900,o],n),h=p.geoPath().projection(v);s.selectAll(".".concat(Ot("region"))).data(u).enter().append("path").attr("class",Ot("region")).attr("stroke","#eeeeee").attr("fill",function(e,t){return a.state.isTurnout?l(d(e)):m(d(e))}).attr("id",function(e,t){return"region-".concat(t)}).attr("d",h);var f=s.selectAll(".".concat(Ot("legend"))).data(a.state.isTurnout?[{text:"More than 90%",turnout:91},{text:"80% - 89%",turnout:81},{text:"70% - 79%",turnout:71},{text:"60% - 69%",turnout:61},{text:"50% - 59%",turnout:51},{text:"Less than 50%",turnout:40}]:[{text:"100%",countProg:100},{text:"80% - 99%",countProg:81},{text:"60% - 79%",countProg:61},{text:"40% - 59%",countProg:41},{text:"20% - 39%",countProg:21},{text:"0.01% - 19%",countProg:1},{text:"0%",countProg:0}]).enter().append("g").attr("class",Ot("legend")).attr("transform",function(e,t){return"translate("+function(e){return[e%5*170,o+10+40*parseInt(e/5)]}(t)+")"});if(f.append("rect").attr("width",20).attr("height",20).attr("x",0).attr("y",0).attr("fill",function(e){return a.state.isTurnout?l(e.turnout):m(e.countProg)}),f.append("text").attr("x",30).attr("y",16).text(function(e){return e.text}),"municipality"!==a.state.regionType&&s.selectAll(".place-label").data(u).enter().append("text").attr("class","place-label").attr("font-size","12px").attr("transform",function(e){var t,n;return"Polygon"===e.geometry.type?(t=bt()(e.geometry.coordinates),(n=v(t))[1]-=12,"translate("+n+")"):(t=bt()(e.geometry.coordinates[0]),(n=v(t))[1]-=5,"translate("+n+")")}).attr("dy",".35em").style("text-anchor","middle").text(function(e){return F(e.properties,a.state)}),"municipality"!==a.state.regionType&&j(),s.selectAll(".eventLayer").data(u).enter().append("path").attr("d",h).attr("class","eventLayer").attr("id",function(e,t){return"eventLayer-".concat(t)}).attr("fill","transparent").on("mouseover",function(e,t){p.select("#region-".concat(t)).attr("stroke-width",3).style("fill-opacity",.8)}).on("mousemove",function(e,t){var n;i.transition().duration(200).style("opacity",1),n=-1==a.state.eventDescription.indexOf("2019")?"province"===a.state.regionType?"New municipality - no previous results available":"New voting district - no previous results available":"votes not counted yet";var r=d(e),o=F(e.properties,a.state),s="undefined"!==typeof r?o+" : "+r+"%":n;i.html(s).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e,t){p.select("#region-".concat(t)).attr("stroke-width",1).style("fill-opacity",1),"municipality"!==a.state.regionType&&i.transition().duration(200).style("opacity",0)}).on("click",function(e,t){if(!a.state.disableNavigation){i.transition().duration(200).style("opacity",0);var n=a.state.regionType;if("national"===n)r={regionType:"province",provinceName:e.properties.SPROVINCE},D(Y,r),a.setState(r);else if("province"===n)r={regionType:"municipality",provinceName:a.state.provinceName,muniName:e.properties.smunicipal,muniCode:R(e.properties)},D(Y,r),a.setState(r);else{var r={regionType:"municipality-vd",provinceName:a.state.provinceName,muniName:a.state.muniName,muniCode:a.state.muniCode,iecId:W(e.properties)};D(Y,r),a.setState(r)}}}),!a.state.disableNavigation){var N,g=function(e,t,n){n&&e.append("span").html(" > "),e.append("span").style("height","30px").style("cursor","default").html(t)},C=function(e,t,n,r){r&&e.append("span").html(" > "),e.append("a").style("height","30px").style("cursor","pointer").html(t).on("click",function(){!function(e){var t;(t={regionType:a.state.regionType,provinceName:a.state.provinceName,muniName:a.state.muniName,muniCode:a.state.muniCode,iecId:a.state.iecId}).regionType=e,D(Y,t),a.setState(t)}(n)})},b=s.append("foreignObject").attr("x",0).attr("y",10).attr("width",500).attr("height",30).attr("class","map-controls").append("xhtml:div");"national"==(N=a.state.regionType)?g(b,"South Africa",!1):(C(b,"South Africa","national",!1),"province"==N?g(b,a.state.provinceName,!0):(C(b,a.state.provinceName,"province",!0),"municipality"==N?g(b,a.state.muniCode,!0):(C(b,a.state.muniCode,"municipality",!0),g(b,a.state.iecId,!0))))}a.getLoadingSpinner().style("display","none")}).catch(function(e){console.error(e),console.log("failed to get data from server")})}).catch(function(e){console.error(e),a.getLoadingSpinner().style("display","none");var t=M(n.state),r=a.state.regionType,i={regionType:a.state.regionType,provinceName:a.state.provinceName,muniName:a.state.muniName,muniCode:a.state.muniCode,iecId:a.state.iecId};"province"===r?i.regionType="national":"municipality"===r?i.regionType="province":"municipality-vd"===r&&(i.regionType="municipality"),D(Y,i),a.setState(i),setTimeout(function(){"national"==r||"province"==r?console.log("Can't get map data for ".concat(t)):alert("".concat(t," has been disestablished"))},300)})}}]),t}(a.Component),kt={chartType:"Turnout Barchart",yAxisLabel:"PERCENTAGE",noXaxisByParty:!0,yValue:function(e){return e.percVoterTurnout},yValueFormat:function(e){return e+"%"}};function Vt(e){return h.a[e]||e}function jt(e){return Vt(N.CSS_PREFIX+e)}var Dt=function(e){function t(e){var n;Object(s.a)(this,t),n=Object(u.a)(this,Object(l.a)(t).call(this,e));Object(d.a)(Object(d.a)(n));return n.state={eventType:"national",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:10},Z(n.state,e),n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this.chart=null,document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID==this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"turnout-barchart(".concat(M(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new H(this.getContainer(),null,null,Vt,kt),this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:jt("barchart")+" "+jt("stylesheet-".concat(t))},-1e3!=n&&r.a.createElement("div",{className:jt("chart-title")},kt.chartType," (",M(this.state),"): "),r.a.createElement("div",{ref:"vizcontainer",className:jt("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[function(e){if("national"===e.regionType)return ue.query({query:ie()(Fe())});if("province"===e.regionType)return ue.query({query:ie()(Ke(),e.provinceName)});if("municipality"===e.regionType){var t=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()(De(),e.provinceName,t)})}return"municipality-vd"===e.regionType?ue.query({query:ie()(je(),e.iecId)}):void 0}(t)];Promise.all(a).then(function(a){var r=a[0];n.drawGraph(e,t,r,"rgb(157,51,55)")}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=function(e,t){if(!e)return null;var n,a=t.regionType;return"national"==a?n=e.data.allBallots.edges:"province"==a?n=e.data.allProvincialBallots.edges:"municipality"==a?n=e.data.allMunicipalBallots.edges:"municipality-vd"==a&&(n=e.data.allVotingDistrictBallots.edges),n.map(function(e){var t=e.node,n=t.event.description,a=t.event.eventType.description,r=t.percVoterTurnout.toFixed(2);return{name:g(n),eventType:a,percVoterTurnout:r}}).filter(function(e){return-1!=e.eventType.toLowerCase().indexOf(t.eventType)}).sort(function(e,t){return-parseInt(/(19|20)\d{2}/g.exec(e.name)[0])+parseInt(/(19|20)\d{2}/g.exec(t.name)[0])})}(n,t);this.chart||(this.chart=new H(e,null,null,Vt,kt)),this.chart.draw(r,a)}}]),t}(a.Component),Kt=n(49),Ft=n.n(Kt),Rt=n(34);function Wt(e){return Ft.a[e]||e}a.Component;var Bt=n(59),Gt=n(50),Zt=n.n(Gt),Ut=n(51),qt=n.n(Ut);function zt(e,t,n,a,r){var i=[],o=10,s=10,c=10,u=10,l=r.variable,m=r.category,d=p.format(".4r"),v=null;function h(e){return v&&v[e]?v[e]:"rgb("+250*Math.random()+","+250*Math.random()+","+250*Math.random()+")"}var f=Math.min(700,300)/2,N=p.pie().value(function(e){return d(e[l])}).sort(null),y=p.arc().outerRadius(.8*f).innerRadius(.6*f).cornerRadius(3).padAngle(.015),g=q(e,700+u+s,300+o+c),C=150;"Progress on Votes Count"===r.chartType||(C=350);var b=g.append("g").attr("transform","translate("+C+",150)"),E=g.append("g").attr("transform","translate(360,150)");b.append("g").attr("class","slices"),b.append("g").attr("class","lines");var I=b.select(".slices").selectAll("path").data(N(i)).enter().append("path").attr("fill",function(e){return h(e.data[m])}).attr("d",y),x=z(b);function P(e){r.hideTooltip||(e.on("mouseenter",function(e){b.append("text").attr("class","toolCircle").attr("dy",-15).html(function(e){if("Progress on Votes Count"===r.chartType){var t="";t+='<tspan x="0">Progress: '+e.data.percent+"%</tspan>",t+='<tspan x="0" dy="1.2em">Captured Votes: '+e.data.count+"</tspan>",t+='<tspan x="0" dy="1.2em">Total: '+e.data.totalCount+"</tspan>"}else{var t="";t+='<tspan x="0">Seats: '+e.data.seats+"</tspan>",t+='<tspan x="0" dy="1.2em">Party: '+e.data.name+"</tspan>"}return t}(e)).style("font-size",".7em").style("text-anchor","middle"),b.append("circle").attr("class","toolCircle").attr("r",.55*f).style("fill",h(e.data[m])).style("fill-opacity",.35)}),e.on("mouseout",function(){p.selectAll(".toolCircle").remove()}))}function w(e){var t=p.interpolate(this._current,e);return this._current=t(0),function(e){return y(t(e))}}function A(e){return e.data[m]}this.destroy=function(){e.selectAll("svg").remove()},this.draw=function(e,t){if(e){if(x.text(""),"Progress on Votes Count"===r.chartType)v=t;else{var n={},a=t;a&&a.data.allParties.edges&&a.data.allParties.edges.forEach(function(e){n[e.node.abbreviation]=e.node.colour}),v=n}i=e,"Progress on Votes Count"===r.chartType&&(E.selectAll("text").remove(),E.append("text").attr("x",0).attr("y",-15).style("font-size",".7em").style("text-anchor","middle").text("Completed: "+i[0].percent+"%"),E.append("text").attr("x",0).attr("y",0).text("Captured Votes: "+i[0].count).style("font-size",".7em").style("text-anchor","middle"),E.append("text").attr("x",0).attr("y",15).text("Total: "+i[0].totalCount).style("font-size",".7em").style("text-anchor","middle"));var o=p.select(".slices").selectAll("path"),s=I.data(),c=N(i);(o=o.data(c,A)).enter().append("path").each(function(e,t){this._current=function(e,t,n,a){var r;return(r=function(e,t,n,a){var r=t.length;for(;--e>=0;)for(var i=a(n[e]),o=0;o<r;++o)if(a(t[o])===i)return t[o]}(e,t,n,a))?{startAngle:r.endAngle,endAngle:r.endAngle}:(r=function(e,t,n,a){var r=n.length,i=t.length;for(;++e<r;)for(var o=a(n[e]),s=0;s<i;++s)if(a(t[s])===o)return t[s]}(e,t,n,a))?{startAngle:r.startAngle,endAngle:r.startAngle}:null}(t,s,c,A)||e}).attr("fill",function(e){return h(e.data[m])}).attr("d",y),o.exit().transition().duration(750).attrTween("d",w).remove(),o.transition().duration(750).attrTween("d",w),p.selectAll(".labelName text, .slices path").call(P)}else x.text("chart data is not available")}}var Ht={chartType:"Progress on Votes Count",variable:"percent",category:"name",hideTooltip:!0};function _t(e){return qt.a[e]||e}function Xt(e){return _t(N.CSS_PREFIX+e)}var Yt,Jt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={numParties:5,eventDescription:"2019 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:4},Z(n.state,e),n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this.chart=null,document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID==this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"progress-on-votes-piechart(".concat(M(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new zt(this.getContainer(),null,null,_t,Ht),this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:_t("piechart")+" "+Xt("stylesheet-".concat(t))},-1e3!=n&&r.a.createElement("div",{className:Xt("chart-title")},Ht.chartType," (",M(this.state),"): "),r.a.createElement("div",{ref:"vizcontainer",className:Xt("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[nt(t)];Promise.all(a).then(function(a){var r=a[0];n.drawGraph(e,t,r)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n){var a=I(n,t);this.chart||(this.chart=new zt(e,null,null,_t,Ht)),this.chart.draw(a,{Completed:"#15707C","Not Completed":"#CCCCCC"})}}]),t}(a.Component),Qt=n(52),$t=n.n(Qt),en={chartType:"Race For Seats Donut Chart",variable:"seats",category:"name",viewBox:"170 0 360 320"};function tn(e){return $t.a[e]||e}function nn(e){return tn(N.CSS_PREFIX+e)}var an;a.Component,it();function rn(e){return h.a[e]||e}function on(e){return rn(N.CSS_PREFIX+e)}var sn,cn={chartType:"Race For Votes Comparison",yAxisLabel:"PERCENTAGE VOTES",yValue:function(e){return e.percOfVotes},yValueFormat:function(e){return e+"%"},showLegend:!0},un=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={partyAbbr:"ANC",partyIecId:null,eventDescriptions:["National Elections 1999","14 Apr 2004 National Election","22 Apr 2009 National Election","2014 National Election","2019 NATIONAL ELECTION"],regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:16},Z(n.state,e),n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this.chart&&(this.chart.destroy(),this.chart=null),document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID==this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"race-for-votes-comparison-barchart(".concat(M(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new H(this.getContainer(),null,null,rn,cn),this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:on("barchart")+" "+on("stylesheet-".concat(t))},-1e3!=n&&r.a.createElement("div",{className:on("chart-title")},cn.chartType," (",M(this.state),"): "),r.a.createElement("div",{ref:"vizcontainer",className:on("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[ke(t)];if(!an){var r=rt();a.push(r)}Promise.all(a).then(function(a){var r=a[0];an=an||a[1],n.drawGraph(e,t,r,an)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=b(n,t);console.log("comparison data fetch",n,r),this.chart||(this.chart=new H(e,null,null,rn,cn)),this.chart.draw(r,a)}}]),t}(a.Component),ln={chartType:"Race For Seats Comparison",yAxisLabel:"Seats Count",dynamicYAxisFromValues:!0,yValue:function(e){return e.seats},yValueFormat:function(e){return e},showLegend:!0};function mn(e){return h.a[e]||e}function dn(e){return mn(N.CSS_PREFIX+e)}var pn=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={partyAbbr:"ANC",partyIecId:null,eventDescriptions:["National Elections 1999","Provincial Elections 1999","14 Apr 2004 National Election","14 Apr 2004 Provincial Election","22 Apr 2009 National Election","22 Apr 2009 Provincial Election","2014 National Election","2014 Provincial Election","2019 NATIONAL ELECTION","2019 PROVINCIAL ELECTION"],regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:7},Z(n.state,e),n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this.chart=null,document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID==this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"race-for-seats-comparison-barchart(".concat(S(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new H(this.getContainer(),null,null,mn,ln),this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:dn("barchart")+" "+dn("stylesheet-".concat(t))},-1e3!=n&&r.a.createElement("div",{className:dn("chart-title")},ln.chartType," (",S(this.state),"): "),r.a.createElement("div",{ref:"vizcontainer",className:dn("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[ve(t)];if(!sn){var r=rt();a.push(r)}Promise.all(a).then(function(a){var r=a[0];sn=sn||a[1],n.drawGraph(e,t,r,sn)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=w(n,t);r.map(function(e){return e.seats}).reduce(function(e,t){return e+t},0)>-10&&(this.chart||e.selectAll("*").remove(),this.chart.draw(r,a))}}]),t}(a.Component),vn=n(53),hn=n.n(vn);function fn(e,t,n,a,r){r||(r={});var i=["blue","yellow","red"],o=q(e,550,180),s=V(a),c=o.append("g"),u=z(o,275,90);this.draw=function(e,t){var n=[];if(e){u.text("");var a=(n=e)[0],r=n.slice(1);r.push(a),n=r;var o={},l=t;l&&l.data.allParties.edges&&l.data.allParties.edges.forEach(function(e){o[e.node.name]=e.node.colour});for(var m=0,d=0;d<n.length;d++)m+=n[d].seats;!function(e,t){var a,r,i,o,c,u,l=[3,15,33,61,95,138,189,247,313,388,469,559,657,762,876,997,1126,1263,1408,1560,1722,1889,2066,2250,2442,2641,2850,3064,3289,3519,3759,4005,4261,4522,4794,5071,5358,5652,5953,6263,6581,6906,7239,7581,7929,8287,8650,9024,9404,9793,10187,10594,11003,11425,11850,12288,12729,13183,13638,14109,14580,15066,15553,16055,16557,17075,17592,18126,18660,19208,19758,20323,20888,21468,22050,22645,23243,23853,24467,25094,25723,26364,27011,27667,28329,29001,29679,30367,31061];e>l[l.length-1]&&console.error("total seats >",l[l.length-1]),e<1&&console.error("total seats < 1");for(var m=0;m<l.length;m++)if(l[m]>=e){a=m+1;break}for(r=.4/a,i=[],m=1;m<a;m++)if(c=(3*a+4*m-2)/(4*a),1===(o=parseInt(e/l[a-1]*Math.PI/(2*Math.asin(2/(3*a+4*m-2))))))i.push({angle:Math.PI/2,x:1.75*c,y:c});else for(var d=0;d<o;d++)u=d*(Math.PI-2*Math.sin(r/c))/(o-1)+Math.sin(r/c),i.push({angle:u,x:c*Math.cos(u)+1.75,y:c*Math.sin(u)});if(c=(7*a-2)/(4*a),1===(o=e-i.length))i.push({angle:Math.PI/2,x:1.75*c,y:c});else for(d=0;d<o;d++)u=d*(Math.PI-2*Math.sin(r/c))/(o-1)+Math.sin(r/c),i.push({angle:u,x:c*Math.cos(u)+1.75,y:c*Math.sin(u)});function v(e,t){var a;e.attr("opacity",.8),s.transition().duration(200).style("opacity",.9),s.html((a=n[t],a.name)).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}function h(e){e.attr("opacity",1),s.transition().duration(200).style("opacity",0)}i.sort(function(e,t){function n(e){return e.angle-Math.PI/2}return n(t)-n(e)}),t.append("text").attr("x",175).attr("y",175).attr("style","font-size:36px;font-weight:bold;text-align:center;text-anchor:middle;font-family:sans-serif").text(e);var f=0;for(m=0;m<n.length;m++){var N=t.append("g").attr("fill",C(n[m].partyInfo.name,m)).attr("id",n[m].name);for(N.on("mousemove",v.bind(this,N,m)).on("mouseout",h.bind(this,N)),d=0;d<n[m].seats;d++,f++)N.append("circle").attr("cx",100*i[f].x+5).attr("cy",100*(1.75-i[f].y)+5).attr("r",100*r)}}(m,c);var v={boxX:360,columnSpacing:70,boxMargin:20},h=function(e,t){var n=(t=t||{}).boxWidth||5,a=t.boxX||380,r=t.columnSpacing||6*n;return{x:e%2==0?a:a+r,y:(e%2==0?e/2:(e-1)/2)*(n+(t.boxMargin||2*n))+10}},f=function(e,t){var n=(t=t||{}).boxWidth||5,a=t.boxX||390;return e%3==0?e/3:e%3==1?(e-1)/3:(e-2)/3,{x:(t.columnSpacing||6*n)*(e%3)+a,y:(e-e%3)/3*(t.boxMargin||2*n)+(t.yShift||30)}},N=n.slice();N.sort(function(e,t){return t.seats-e.seats});var y=c.append("g").classed("legend",!0),g=N.filter(function(e){return e.seats>0});y.selectAll(".legend rect").data(g).enter().append("rect").attr("transform",function(e,t){if(g.length<12)var n=h(t,v);else n=f(t,v);return"translate("+n.x+", "+n.y+")"}).attr("width",10).attr("height",10).style("fill",function(e){return C(e.partyInfo.name)}),y.selectAll(".legend text").data(g).enter().append("text").text(function(e){return e.name+" ("+e.seats+")"}).attr("transform",function(e,t){if(g.length<12)var n=h(t,v);else n=f(t,v);return"translate("+(n.x+15)+", "+(n.y+8)+")"}).classed("label")}else u.text("chart data is not available");function C(e,t){return o[e.split("/")[0]]||i[t%i.length]}},this.destroy=function(){o.remove()}}var Nn,yn={chartType:"Race For Seats HorseShoe Chart"};function gn(e){return hn.a[e]||e}function Cn(e){return gn(N.CSS_PREFIX+e)}var bn=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={numParties:100,eventDescription:"2019 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:8},Z(n.state,e),n.state.numParties=100,n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){void 0===this.has_drawn?(this.draw(this.getContainer(),this.state),this.has_drawn=!0):this.has_drawn=void 0}},{key:"componentWillUnmount",value:function(){this.chart=null,document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID===this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"race-for-seats-horseshoe-chart(".concat(S(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new fn(this.getContainer(),null,null,gn,yn),this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID;return r.a.createElement("div",{className:gn("horseshoechart")+" "+Cn("stylesheet-".concat(t))},-1e3!==n&&r.a.createElement("div",{className:Cn("chart-title")},yn.chartType," (",S(this.state),"): "),r.a.createElement("div",{ref:"vizcontainer",id:Cn("horseshoe-chart"),className:Cn("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[he(t)];if(!Nn){var r=rt();a.push(r)}Promise.all(a).then(function(a){var r=a[0];Nn=Nn||a[1],n.drawGraph(e,t,r,Nn)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=P(n,t);this.chart||(this.chart=new fn(e,null,null,gn,yn)),this.chart.draw(r,a)}}]),t}(a.Component),En=n(54),In=n.n(En);function xn(e,t,n,a,r){r||(r={});var i=r.showPoints||!0,o=r.pointRadius||2,s=r.showPointLabels||!1,c=r.pointLabelOffset||4;r.showCurrentLine;var u=20,l=40,m={top:u,bottom:400-50-u,left:l,right:600-20-l},d=q(e,600,400),v=V(a),h=d.append("g"),f=z(d,300,200);this.draw=function(e,t,n){var r=function(e){var t={};return e&&e.data.allParties.edges&&e.data.allParties.edges.forEach(function(e){t[e.node.name]=e.node.colour}),function(e,n){return t[e]}}(t);if(e){if(n.minX||(n.minX=0),!n.maxX){var u=p.max(e.map(function(e){return p.max(e.data.map(function(e){return e.x}))}));n.maxX=Math.min(100,1.5*u)}var l=p.scaleLinear().domain([n.minX,n.maxX]).range([m.left,m.right]),d=p.scaleLinear().domain([0,100]).range([m.bottom,m.top]),N=p.scaleLinear().domain([0,100]).range([0,100]);h.selectAll("g").remove();var y=h.append("g").classed("axes",!0);y.append("g").attr("transform","translate(0, "+m.bottom+")").classed("x-axis",!0).call(p.axisBottom(l)),y.append("g").attr("transform","translate("+m.left+", 0)").classed("y-axis",!0).call(p.axisLeft(d)),y.append("text").text("% VDs declared").attr("transform","translate("+l((n.minX+n.maxX)/2)+", "+d(-10)+")").style("fill","white").attr("text-anchor","middle").classed("x-axis-text","true").classed("axis-text","true"),y.append("text").text("% Party support").attr("text-anchor","middle").attr("transform","rotate(-90) translate(-180, 10)").style("fill","white").classed("y-axis-text","true").classed("axis-text","true");var g=null,C=null,b=null,E=null,I=null;e.map(function(t){I=p.line().x(function(e){return l(e.x)}).y(function(e){return d(e.y)}),g=t.data;var n=r(t.name);C=h.append("g").classed("line-container",!0).classed(t.cleaned_name,!0),b=h.append("g").classed("ledgends",!0),E=h.append("g").classed("event-capture-container",!0).classed(t.cleaned_name,!0),C.append("path").data([g]).attr("class","line").attr("d",I).style("stroke",n),i&&(C.selectAll("circle").data(g).enter().append("circle").attr("cx",function(e){return l(e.x)}).attr("cy",function(e){return d(e.y)}).attr("r",function(e){return N(o)}).style("fill",n).classed("graph-points",!0),E.selectAll("circle").data(g).enter().append("circle").attr("cx",function(e){return l(e.x)}).attr("cy",function(e){return d(e.y)}).attr("r",function(e){return 3*N(o)}).style("fill","transparent").classed("graph-points",!0).on("mousemove",function(e,t){console.log("tooltip mousemove"),p.select(this).attr("opacity",.8),v.transition().duration(200).style("opacity",.9),v.html(e.y.toFixed(2)+"%").style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e){console.log("tooltip mouseout"),p.select(this).attr("opacity",1),v.transition().duration(200).style("opacity",0)})),s&&C.selectAll("text").data(g).enter().append("text").text(function(e){return e.y}).attr("transform",function(e){return"translate("+l(e.x-N(o/2))+", "+d(e.y+c)+")"}).classed("graph-labels",!0);var u=[],m=[],f=[];e.forEach(function(e){var t=e.name;-1===f.indexOf(e.iecId)&&e.iecId&&(u.push(t),m.push(e.abbreviation),f.push(e.iecId))}),b.selectAll(".".concat(a("legend"))).remove();var y=b.selectAll(".".concat(a("legend"))).data(u).enter().append("g").attr("class",a("legend")).attr("transform",function(e,t){return"translate("+function(e){var t=[30+e%5*100,370+40*parseInt(e/5)];return u.length<6&&(t[0]+=100*(6-u.length)/2),t}(t)+")"});y.append("rect").attr("width",10).attr("height",10).attr("x",0).attr("y",0).attr("fill",function(e,t){return r(e)}),y.append("text").attr("x",30).attr("y",10).style("font-size","12px").text(function(e,t){return m[t]})})}else f.text("chart data is not available")},this.destroy=function(){d.remove()}}var Pn,wn={chartType:"Votes prediction line charts"};function An(e){return In.a[e]||e}function Tn(e){return An(N.CSS_PREFIX+e)}function Mn(e){var t=e.getHours(),n=e.getMinutes();n<10&&(n="0"+n);return t+":"+n+" on "+e.getDate()+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getFullYear()}var On=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={numParties:100,electionType:"national",eventDescription:"2019 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:8},n._isMounted=!1,Z(n.state,e),n.state.numParties=100,n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.chart=null,document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID==this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"race-for-seats-horseshoe-chart(".concat(S(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){if(this._isMounted){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new xn(this.getContainer(),null,null,An,wn),this.setState(t)}}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state,t=e.stylesheetFor,n=e.componentID,a=Mn(new Date);return r.a.createElement("div",{className:An("votepredictionlinechart")+" "+Tn("stylesheet-".concat(t))},-1e3!=n&&r.a.createElement("div",{className:Tn("chart-title")},wn.chartType," (",S(this.state),"): "),r.a.createElement("div",{className:Tn("vote-prediction-title")},r.a.createElement("div",{className:Tn("projected-turnout")},"Projected turnout: ",r.a.createElement("span",{ref:"projectedTurnout"},"10%")),r.a.createElement("div",{className:Tn("prediction-time")},"Predictions at ",r.a.createElement("span",{ref:"lastTimestamp"},a))),r.a.createElement("div",{ref:"vizcontainer",className:Tn("chart-body")}),r.a.createElement("div",{className:Tn("CSIR-bottom-label")},r.a.createElement("b",null,"CSIR's election prediction  model"),r.a.createElement("br",null),"The CSIR produces predictions of the final results of the election based on a statistical model. The model can provide scientific predictions even if only a small number of voting districts have been declared and therefore can give a reliable early indication of what the final percentages for each party and the voter turnout rates would be."))}},{key:"draw",value:function(e,t){var n=this,a=[function(e){console.log("getVotesPredictionData",e);var t="national"==e.electionType?"National Election":"Provincial Election";return"national"===e.regionType?ue.query({query:ie()(Se(),t)}):ue.query({query:ie()(Le(),t,e.provinceName)})}(t)];if(!Pn){var r=rt();a.push(r)}Promise.all(a).then(function(a){var r=a[0];Pn=Pn||a[1],n.drawGraph(e,t,r,Pn)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=function(e){var t=e.data.CSIRPrediction;return{minX:t.minX,maxX:t.maxX}}(n),i=function(e,t){var n=e.data.CSIRPrediction.results.edges,a=[],r=[];return n.forEach(function(e){var t=e.node,n=t.percVds;t.prediction.edges.forEach(function(e){console.log("predictionEdge",e);var t=e.node,i=t.party;if(i){var o=t.predictedPercent,s=(t.actualPercent,a.indexOf(i.iecId));-1==s&&(a.push(i.iecId),r.push({name:i.name,iecId:i.iecId,abbreviation:i.abbreviation,cleaned_name:i.abbreviation.replace(/[^a-zA-Z0-9]+/g,""),data:[]}),s=a.length-1),r[s].data.push({x:n,y:o})}})}),r.forEach(function(e){e.data.sort(function(e,t){return e.x-t.x})}),console.log("parsedLineData",r),r}(n),o=function(e){var t=e.data.CSIRPrediction,n=t.turnout,a=t.timestamp;return{turnout:n.toFixed(2),timestamp:a}}(n),s=o.turnout,c=o.timestamp;if(this.refs.projectedTurnout&&this.refs.projectedTurnout.innerHTML&&(this.refs.projectedTurnout.innerHTML=s+"%"),this.refs.lastTimestamp&&this.refs.lastTimestamp.innerHTML){var u=Mn(new Date(c));console.log("timestamp",new Date(c),c,u),this.refs.lastTimestamp.innerHTML=u}this.chart||(this.chart=new xn(e,null,null,An,wn)),this.chart.draw(i,a,r)}}]),t}(a.Component);function Ln(e,t,n,a,r){r||(r={});var i=70,o=["blue","yellow","red"],s=q(e,700+i,(n=250)+50),c=V(a),u=p.scaleBand().rangeRound([i,700]),l=p.scaleLinear().rangeRound([n,50]);s.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")"),s.append("g").attr("class","y axis").attr("transform","translate("+i+", 0)");var m=s.append("g").attr("transform","translate(350,"+n/2+")").append("text").attr("text-anchor","middle");this.draw=function(e,t){if(s.selectAll(".topLabel").remove(),s.append("text").attr("class","topLabel").attr("text-anchor","middle").attr("x",350).attr("y",20).text(r.topLabel),e){m.text("");var d={},v={};t&&t.data.allParties.edges&&t.data.allParties.edges.forEach(function(e){d[e.node.name]=e.node.colour,v[e.node.name]=e.node.abbreviation}),u.domain(e.map(function(e){return e.eventDescription}));var h=[0,100];r.dynamicYAxisFromValues&&(h[1]=Math.min(100,1.5*p.max(e.map(function(e){return p.max(e.data,function(e){return parseFloat(r.yValue(e))})})))),l.domain(h);s.select(".x.axis").transition().duration(300).call(p.axisBottom(u));s.select(".y.axis").transition().duration(300).call(p.axisLeft(l).ticks(4).tickFormat(function(e){return r.yValueFormat(e)})),s.selectAll(".bar-group").remove();var f=s.selectAll(".bar-group").data(e);f.exit().transition().duration(300).style("fill-opacity",1e-6).remove(),(E=f.enter().append("g").attr("class",function(e){return"bar-group ".concat(U(e.eventDescription))}).attr("transform",function(e){return"translate(".concat(u(e.eventDescription)+1*u.bandwidth()/20,", 0)")})).append("g").attr("class","bar-container"),E.append("g").attr("class","bartext-container");for(var N=function(){g=e[y].eventDescription,C=e[y].data,b=p.scaleBand().rangeRound([0,9*u.bandwidth()/10]).domain(C.map(function(e){return e.name})),E=s.selectAll(".bar-group.".concat(U(g))),I=E.select(".bar-container"),x=E.select(".bartext-container"),(P=I.selectAll(".".concat(a("bar"))).data(C)).exit().transition().duration(300).attr("y",function(e){return l(0)}).attr("height",0).style("fill-opacity",1e-6).remove(),P.enter().append("rect").attr("class",function(e){return a("bar")+" bar_"+e.name}).attr("x",function(e,t){return b(e.name)+b.bandwidth()/4}).attr("width",1*b.bandwidth()/2).attr("fill",function(e,t){return L(e,t)}).on("mousemove",function(e,t){p.select(this).attr("opacity",.8),c.transition().duration(200).style("opacity",.9),c.html(function(e,t){return r.noXaxisByParty?e.name+" : "+r.yValueFormat(r.yValue(e)):K(e.partyInfo.name)+" : "+r.yValueFormat(r.yValue(e))}(e)).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e){p.select(this).attr("opacity",1),c.transition().duration(200).style("opacity",0)}).attr("y",function(e){return l(0)}).attr("height",0),I.selectAll(".".concat(a("bar"))).data(C).attr("fill",function(e,t){return L(e,t)}).transition().duration(300).attr("y",function(e){return l(Number(r.yValue(e)))}).attr("height",function(e){return n-l(Number(r.yValue(e)))}),(w=x.selectAll(".".concat(a("bartext"))).data(C)).exit().transition().duration(300).attr("y",function(e){return l(0)-5}).style("fill-opacity",1e-6).remove(),w.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return b(e.name)+b.bandwidth()/2}).attr("text-anchor","middle").attr("font-size","7px").attr("y",function(e){return l(0)-5}),x.selectAll(".".concat(a("bartext"))).data(C).text(function(e){return r.yValueFormat(r.yValue(e))}).transition().duration(300).attr("y",function(e){return l(Number(r.yValue(e)))-5}),A=[],T=[],e.forEach(function(e){e.data.forEach(function(e){var t=e.partyInfo,n=t.name;-1==T.indexOf(t.iecId)&&(A.push(n),T.push(t.iecId))})}),s.selectAll(".".concat(a("legend"))).remove(),(M=s.selectAll(".".concat(a("legend"))).data(A).enter().append("g").attr("class",a("legend")).attr("transform",function(e,t){return"translate("+function(e){return[i+e%5*100,n+30+40*parseInt(e/5)]}(t)+")"})).append("rect").attr("width",10).attr("height",10).attr("x",0).attr("y",0).attr("fill",function(e,t){return O(e)}),M.append("text").attr("x",30).attr("y",10).attr("fill","currentColor").style("font-size","12px").text(function(e){return v[e]})},y=0;y<e.length;y++){var g,C,b,E,I,x,P,w,A,T,M;N()}}else m.text("chart data is not available");function O(e,t){return d[e.split("/")[0]]||o[t%o.length]}function L(e,t){return O(e.partyInfo.name,t)}},this.destroy=function(){s.remove()}}var Sn;it();function kn(e){return h.a[e]||e}function Vn(e){return kn(N.CSS_PREFIX+e)}var jn={topLabel:"NATIONAL ASSEMBLY: 2009, 2014, 2019",usedValue:"% VDS COUNTED",yValue:function(e){return e.percOfVotes},yValueFormat:function(e){return e+"%"},dynamicYAxisFromValues:!1},Dn=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={numPartiesSplitNatProv:3,eventDescriptionsSplitNatProv:["2014 National Election","2014 Provincial Election","2019 NATIONAL ELECTION","2019 PROVINCIAL ELECTION"],regionType:"province",provinceName:"Western Cape",muniName:"",muniCode:"",iecId:"",stylesheetFor:"web",componentID:18},console.log("SplitNatProv state and props",n.state,e),Z(n.state,e),n.chart=null,n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.exportAsPNGUri=n.exportAsPNGUri.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),this.refreshIntervalID=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(te,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(J,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){this.chart&&(this.chart.destroy(),this.chart=null),document.removeEventListener(te,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(J,this.handlePreviewEvent),clearInterval(this.refreshIntervalID)}},{key:"exportAsPNGUri",value:function(){var e=this;return new Promise(function(t,n){X.a.svgAsPngUri(e.refs.vizcontainer.childNodes[0],{},function(e){t(e.split(",")[1])})})}},{key:"exportAsPNG",value:function(e){e.detail.componentID==this.state.componentID&&X.a.saveSvgAsPng(this.refs.vizcontainer.childNodes[0],"race-for-votes-comparison-barchart(".concat(M(this.state),").png"))}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.chart&&this.chart.destroy(),this.chart=new Ln(this.getContainer(),null,null,kn,jn),this.setState(t)}},{key:"getContainer",value:function(){return p.select(this.refs.vizcontainer)}},{key:"render",value:function(){var e=this.state.stylesheetFor;return r.a.createElement("div",{className:Vn("groupbarchart")+" "+Vn("stylesheet-".concat(e))},r.a.createElement("div",{ref:"vizcontainer",className:Vn("chart-body")}))}},{key:"draw",value:function(e,t){var n=this,a=[function(e){if("national"===e.regionType)return ue.query({query:ie()(we())});if("province"===e.regionType)return ue.query({query:ie()(Pe(),e.provinceName)});if("municipality"===e.regionType){var t=e.muniCode||e.muniName.split(" - ")[0];return ue.query({query:ie()(xe(),e.provinceName,t)})}return"municipality-vd"===e.regionType?ue.query({query:ie()(Ie(),e.iecId)}):void 0}(t)];if(jn.topLabel="".concat(M(t)," Race for Votes - Split (Nat/Prov)"),-1e3==this.state.componentID&&(jn.topLabel=""),!Sn){var r=rt();a.push(r)}Promise.all(a).then(function(a){var r=a[0];Sn=Sn||a[1],n.drawGraph(e,t,r,Sn)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var r=function(e,t){var n,a,r=t.regionType;return a="national"==r?e.data.allBallots.edges:"province"==r?e.data.allProvincialBallots.edges:"municipality"==r?e.data.allMunicipalBallots.edges:e.data.allVotingDistrictBallots.edges,console.log("props",t),a.map(function(e){var a=e.node,r=function(e){var t=/(19|20)\d{2}/g.exec(e.description)[0],n="National Election"==e.eventType.description?"Nat":"Prov";return"".concat(t," ").concat(n)}(a.event),i=a.partyResults||a.topResult;return n=(n=(n=i.edges).sort(function(e,t){return t.node.percOfVotes-e.node.percOfVotes})).slice(0,t.numPartiesSplitNatProv),{longEventDescription:a.event.description,eventDescription:r,data:n.map(function(e){var t=e.node;return{name:t.party.abbreviation,iecId:t.party.iecId,validVotes:t.validVotes.toFixed(2),percOfVotes:t.percOfVotes.toFixed(2),partyInfo:t.party}})}}).filter(function(e){return-1!=t.eventDescriptionsSplitNatProv.indexOf(e.longEventDescription)}).sort(function(e,t){var n=parseInt(/(19|20)\d{2}/g.exec(e.eventDescription)[0]),a=parseInt(/(19|20)\d{2}/g.exec(t.eventDescription)[0]);return n==a?e.eventDescription>t.eventDescription?1:-1:-n+a})}(n,t);this.chart||(this.chart=new Ln(e,null,null,kn,jn)),this.chart.draw(r,a)}}]),t}(a.Component),Kn=n(55),Fn=n.n(Kn),Rn=n(58),Wn=n.n(Rn);function Bn(e){return N.CSS_PREFIX+e}var Gn=it(),Zn=[{provinceName:"Eastern Cape",muniName:"BUF - Buffalo City [East London]",muniCode:"BUF"},{provinceName:"Western Cape",muniName:"CPT - City of Cape Town [Cape Town]",muniCode:"CPT"},{provinceName:"Gauteng",muniName:"JHB - City of Johannesburg [Johannesburg]",muniCode:"JHB"},{provinceName:"Gauteng",muniName:"TSH - Tshwane Metro [Pretoria]",muniCode:"TSH"},{provinceName:"Gauteng",muniName:"EKU - Ekurhuleni [East Rand]",muniCode:"EKU"},{provinceName:"KwaZulu-Natal",muniName:"ETH - eThekwini [Durban Metro]",muniCode:"ETH"},{provinceName:"Free State",muniName:"MAN - Mangaung [Bloemfontein]",muniCode:"MAN"},{provinceName:"Eastern Cape",muniName:"NMA - Nelson Mandela Bay [Port Elizabeth]",muniCode:"NMA"}],Un=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).onClick=e.onClick.bind(Object(d.a)(Object(d.a)(e))),e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onClick",value:function(e){this.props.hasSubMenu?this.props.toggleSubMenu(e):this.props.activateMe({newLocation:this.props.to,selectedMenuLabel:this.props.label})}},{key:"render",value:function(){return this.props.hasSubMenu?r.a.createElement("div",{className:"metismenu-link",onClick:this.onClick},this.props.children):r.a.createElement("div",{className:"metismenu-link metismenu-end",onClick:this.onClick},this.props.children)}}]),t}(r.a.Component),qn=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={eventDescription:"2019 National Election",nationalEventDescription:"2019 National Election",provincialEventDescription:"2019 Provincial Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"",comp:"Race for Votes",activeLinkId:""},Z(n.state,e),e.regionType&&(n.state.regionType=e.regionType),e.provinceName&&(n.state.provinceName=e.provinceName),e.muniName&&(n.state.muniName=e.muniName),n.handleNavBarSelection=n.handleNavBarSelection.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e;document.getElementById("navbarcss")||((e=document.createElement("link")).id="navbarcss",e.rel="stylesheet",e.href=N.DOMAIN+"/navbar.css",document.head.appendChild(e));document.getElementById("font-awesome")||((e=document.createElement("link")).id="font-awesome",e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css",document.head.appendChild(e));this.refs.navbar.addEventListener("click",this.handleNavBarSelection)}},{key:"componentWillUnmount",value:function(){this.refs.navbar.removeEventListener("click",this.handleNavBarSelection)}},{key:"componentDidUpdate",value:function(){}},{key:"handleNavBarSelection",value:function(e){if(-1!=e.target.className.indexOf("metismenu-link")){this.activeElement&&this.activeElement.classList&&this.activeElement.classList.remove&&this.activeElement.classList.remove("active"),e.target.classList.add("active"),this.activeElement=e.target;var t=e.target.childNodes[0].className.split(" "),n=t[t.length-1];console.log("handleNavBarSelection",n);var a,r,i,o,s=n.split("-"),c=!0,u=!0,l=!0,m={},d="",p=s.slice(1,s.length).join("-");if(console.log("activeLinkId",p),"1"==s[1])if(a=this.state.nationalEventDescription,i="national","1"==s[2])switch(s[3]){case"1":d="votes-default";break;case"2":d="votes-comparisons",c=!1;break;case"3":d="votes-predictions",c=!1,l=!1;break;case"4":d="votes-progress";break;case"5":d="votes-turnout";break;case"6":d="votes-split",c=!1;break;case"7":d="votes-myvd";break;default:return}else if("2"==s[2])switch(s[3]){case"1":d="seats-default",c=!1;break;case"2":d="seats-comparisons",c=!1;break;case"3":d="seats-electeds";break;case"4":d="seats-women";break;case"5":d="seats-age";break;default:return}else{if("4"!=s[3])return;d="votes-default"}else if("2"==s[1])if(a=this.state.provincialEventDescription,i="province",m=Gn[s[2]],"1"==s[3])switch(s[4]){case"1":d="votes-default";break;case"2":d="votes-comparisons",c=!1;break;case"3":d="votes-progress";break;case"4":d="votes-turnout";break;case"5":d="votes-split",c=!1;break;case"6":d="votes-predictions",c=!1,l=!1;break;default:return}else if("2"==s[3])switch(s[4]){case"1":d="seats-default",c=!1;break;case"2":d="seats-comparisons",c=!1;break;case"3":d="seats-electeds";break;case"4":d="seats-women";break;case"5":d="seats-age";break;default:return}else{if("4"!=s[3])return;i="national",d="votes-default",r="provincial",u=!1}else{if("3"!=s[1])return;a=this.state.nationalEventDescription,i="municipality",m=Zn[s[2]],d="votes-default-metro"}if(d)a&&(r=a.toLowerCase().indexOf("provincial")>=0?"provincial":"national"),e.preventDefault(),"national"==i?o={regionType:i}:"province"==i?o={regionType:i,provinceName:m.name}:"municipality"==i&&(o={regionType:i,provinceName:m.provinceName,muniName:m.muniName,muniCode:m.muniCode}),o.eventDescription=a,o.electionType=r,o.comp=d,o.enableMap=c,o.enableBarChart=u,o.enableTurnoutProgressSpoilt=l,console.log("newState",o),"votes-myvd"==o.comp&&(o.regionType="municipality-vd",o.iecId=""),"seats-electeds"!=o.comp?"seats-electeds"!=o.comp&&"seats-women"!=o.comp&&"seats-age"!=o.comp&&(D(ee,o),o.activeLinkId=p,console.log("newState",o),this.setState(o)):window.open("http://elections.sabc.co.za/candidates/")}}},{key:"render",value:function(){var e,t=[{label:"National Assembly",content:[{label:"Race for votes",content:[{id:"1-1-1",icon:"1-1-1",label:"National assembly",to:"1-1-1"},{id:"1-1-2",icon:"1-1-2",label:"Comparisons",to:"1-1-2"},{icon:"1-1-3",label:"CSIR predictions",to:"1-1-3"},{icon:"1-1-4",label:"Counting progress",to:"1-1-4"},{icon:"1-1-5",label:"Turnout",to:"1-1-5"},{icon:"1-1-7",label:"My voting District",to:"1-1-7"},{label:"Metros",icon:"3-2",content:Zn.map(function(e,t){return{icon:"3-".concat(t),label:e.muniName.split("-")[1].split("[")[0],to:"3-".concat(t)}})}]},{label:"Race for seats",content:[{icon:"1-2-1",label:"National assembly",to:"1-2-1"},{icon:"1-2-2",label:"Comparisons",to:"1-2-2"},{icon:"1-2-3",label:"Candidates",to:"1-2-3"}]}]},{label:"Provincial Legislature",content:Gn.map(function(e,t){return{label:e.name,content:[{label:"Race for votes",content:[{icon:"2-".concat(t,"-1-1"),label:"Provincial legislature",to:"2-".concat(t,"-1-1")},{icon:"2-".concat(t,"-1-2"),label:"Comparisons",to:"2-".concat(t,"-1-2")},{icon:"2-".concat(t,"-1-3"),label:"Counting progress",to:"2-".concat(t,"-1-3")},{icon:"2-".concat(t,"-1-4"),label:"Turnout",to:"2-".concat(t,"-1-4")},{icon:"2-".concat(t,"-1-5"),label:"Split (Nat/Prov)",to:"2-".concat(t,"-1-5")},{icon:"2-".concat(t,"-1-6"),label:"CSIR Predictions",to:"2-".concat(t,"-1-6")}]},{label:"Race for seats",content:[{icon:"2-".concat(t,"-2-1"),label:"Provincial legislature",to:"2-".concat(t,"-2-1")},{icon:"2-".concat(t,"-2-2"),label:"Comparisons",to:"2-".concat(t,"-2-2")},{icon:"2-".concat(t,"-2-3"),label:"Candidates",to:"2-".concat(t,"-2-3")}]}]}})}];return r.a.createElement("div",{className:[(e=Bn("menu-widget"),Wn.a[e]||e),Bn("menu-widget")].join(" "),ref:"navbar"},r.a.createElement(Fn.a,{activeLinkTo:"1-2-1",content:t,LinkComponent:Un}))}}]),t}(a.Component);function zn(e){return Zt.a[e]||e}function Hn(e){return zn(N.CSS_PREFIX+e)}var _n=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._isMounted=!1,n.state={numParties:5,electionType:"national",eventDescription:"2019 National Election",nationalEventDescription:"2019 National Election",provincialEventDescription:"2019 Provincial Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",iecId:"65010035",comp:"votes-default",stylesheetFor:"web",componentID:5,enableBarChart:!0,enableMap:!0,enableTurnoutProgressSpoilt:!0,partyAbbrs:["ANC","DA","EFF","ID"],partyIecIds:[null,null,null,null],eventDescriptions:{national:["2019 NATIONAL ELECTION","2014 National Election","22 Apr 2009 National Election","14 Apr 2004 National Election"],provincial:["2019 PROVINCIAL ELECTION","2014 Provincial Election","22 Apr 2009 Provincial Election","14 Apr 2004 Provincial Election"]},eventDescriptionsSplitNatProv:["2019 NATIONAL ELECTION","2019 PROVINCIAL ELECTION","2014 National Election","2014 Provincial Election"],currentTurnout:0,currentCountingProg:0,currentSpoiltVotes:0},Z(n.state,e),n.refreshIntervalID=0,n.exportAsPNG=n.exportAsPNG.bind(Object(d.a)(Object(d.a)(n))),n.handleRegionChange=G.bind(Object(d.a)(Object(d.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(d.a)(Object(d.a)(n))),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this;this.refreshIntervalID=setInterval(function(){e.fetchCurrentResultData(!1)},3e4),document.addEventListener(ne,this.exportAsPNG),document.addEventListener(Y,this.handleRegionChange),document.addEventListener(ee,this.handlePreviewEvent),document.addEventListener(Q,this.handleSeatsElectedsEvent),this.fetchCurrentResultData(!1)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,document.removeEventListener(ne,this.exportAsPNG),document.removeEventListener(Y,this.handleRegionChange),document.removeEventListener(ee,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(e,t){this.fetchCurrentResultData(!0)}},{key:"handleSeatsElectedsEvent",value:function(e){}},{key:"fetchCurrentResultData",value:function(e){var t=this,n=JSON.parse(JSON.stringify(this.state)),a=this.state,r=a.comp,i=a.iecId;if(e&&(console.log("showLoadingIcon"),t.refs.currentTurnout&&(t.refs.currentTurnout.innerHTML="--"),t.refs.currentCountingProg&&(t.refs.currentCountingProg.innerHTML="--"),t.refs.currentSpoiltVotes&&(t.refs.currentSpoiltVotes.innerHTML="--")),"municipality-vd"==n.regionType&&(!i||!i.length))return t.refs.currentTurnout&&(t.refs.currentTurnout.innerHTML="--"),t.refs.currentCountingProg&&(t.refs.currentCountingProg.innerHTML="--"),void(t.refs.currentSpoiltVotes&&(t.refs.currentSpoiltVotes.innerHTML="--"));var o=[Je(n),ze(n),nt(n)];"votes-comparisons"==r&&o.push(Ve(n)),"seats-comparisons"==r&&o.push(he(n)),Promise.all(o).then(function(e){var a,i=e[0],o=e[1],s=e[2],c=T(i,n),u=function(e,t){if(!e)return null;var n,a=t.regionType;return"national"==a?n=e.data.allBallots.edges:"province"==a?n=e.data.allProvincialBallots.edges:"municipality"==a?n=e.data.allMunicipalBallots.edges:"municipality-vd"==a&&(n=e.data.allVotingDistrictBallots.edges),n.map(function(e){var t=e.node,n=t.event.description,a=t.percVoterTurnout.toFixed(2);return{name:g(n),percVoterTurnout:a}})}(o,n),l=I(s,n);if(a=u[0]&&l[0]&&c[1]?{currentTurnout:u[0].percVoterTurnout,currentCountingProg:l[0].percent,currentSpoiltVotes:c[1].percent}:{currentTurnout:0,currentCountingProg:0,currentSpoiltVotes:0},"votes-comparisons"==r){var m=C(e[3],n);a.partyAbbrs=m.map(function(e){return e.name}),a.partyIecIds=m.map(function(e){return e.iecId})}else if("seats-comparisons"==r){var d=P(e[3],n);a.partyAbbrs=d.map(function(e){return e.name}),a.partyIecIds=d.map(function(e){return e.iecId})}a.partyIecIds&&a.partyIecIds.join(" ")!=t.state.partyIecIds.join(" ")?t.setState(a):(t.refs.currentTurnout&&(t.refs.currentTurnout.innerHTML=a.currentTurnout+"%"),t.refs.currentCountingProg&&(t.refs.currentCountingProg.innerHTML=a.currentCountingProg+"%"),t.refs.curCountingProg&&t.refs.curCountingProg.innerHTML&&t._isMounted&&(console.log("self.refs.curCountingProg",t.refs.curCountingProg,t._isMounted),t.refs.curCountingProg.innerHTML=a.currentCountingProg+"%"),t.refs.currentSpoiltVotes&&(t.refs.currentSpoiltVotes.innerHTML=a.currentSpoiltVotes+"%"))}).catch(function(e){return console.error("catched error",e)})}},{key:"exportAsPNG",value:function(e){if(e.detail.componentID==this.state.componentID){var t=this.state.comp,n="quick-results-widget-".concat(t.replace(/\s/gi,"-"),"(").concat(M(this.state),")"),a=[];a="votes-comparisons"==t||"seats-comparisons"==t?[].concat(Object(Bt.a)(this.barchartInstances.map(function(e){return e.exportAsPNGUri()})),[this.mapInstance.exportAsPNGUri()]):[this.barchartInstance.exportAsPNGUri(),this.mapInstance.exportAsPNGUri()],Promise.all(a).then(function(e){var t=new window.JSZip,a=t.folder(n);e.forEach(function(e,t){a.file("image".concat(t+1,".png"),e,{base64:!0})}),t.generateAsync({type:"blob"}).then(function(e){Object(Rt.saveAs)(e,"".concat(n,".zip"))})}).catch(function(e){console.error("export error",e)})}}},{key:"handlePreviewEvent",value:function(e){if(this._isMounted){var t=e.detail;"national"==t.regionType&&"votes-split"==this.state.comp&&(t.regionType="province",t.provinceName=this.state.provinceName||"Western Cape"),this.setState(t);var n=JSON.parse(JSON.stringify(t));n.componentID=-1e3,D(J,n),D($,n)}}},{key:"renderTurnoutProgressSpoilt",value:function(){var e=this.state,t=e.comp,n=e.currentTurnout,a=e.currentCountingProg,i=e.currentSpoiltVotes;return"votes-turnout"==t||"votes-progress"==t?null:r.a.createElement("div",{className:Hn("current-progress")},r.a.createElement("div",{className:Hn("current-turnout")},r.a.createElement("div",null,"Turnout"),r.a.createElement("div",{ref:"currentTurnout"},n,"%")),r.a.createElement("div",{className:Hn("current-counting-progress")},r.a.createElement("div",null,"Counting Progress"),r.a.createElement("div",{ref:"currentCountingProg"},a,"%")),r.a.createElement("div",{className:Hn("current-spoilt-votes")},r.a.createElement("div",null,"Spoilt Votes"),r.a.createElement("div",{ref:"currentSpoiltVotes"},i,"%")))}},{key:"renderQuickResultsTitle",value:function(){var e=this.state,t=e.comp,n=e.currentCountingProg;return"votes-default"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Race for Votes: ",O(this.state)):"votes-default-metro"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Race for Votes: ",this.state.eventDescription.toLocaleLowerCase().indexOf("national election")>=0?"National Assembly":"Provincial Legislature"," - ",r.a.createElement("span",{className:"regionName"},function(e){if("national"==e.regionType){var t=e.eventDescription.toLocaleLowerCase();return t.indexOf("national election")>=0?"National Assembly":t.indexOf("provincial election")>=0?"Results for Provincial Legislatures":""}return"province"==e.regionType?M(e)+" Legislature":M(e)}(this.state))):"seats-default"==t?r.a.createElement("div",{className:zn("quick-results-title")+" "+zn("race-for-seats")},"Race for Seats: ",O(this.state)," (",L(this.state),")"):"votes-turnout"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Turnout: ",function(e){return e.eventDescription.toLocaleLowerCase().indexOf("national election")>=0?"National":e.provinceName+" Legislature"}(this.state)):"votes-progress"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Counting Progress",function(e){return e.eventDescription.toLocaleLowerCase().indexOf("national election")>=0?"":": "+e.provinceName+" Legislature"}(this.state)):"votes-comparisons"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Comparisons: ",O(this.state)):"seats-comparisons"==t?r.a.createElement("div",{className:zn("quick-results-title")+" "+zn("race-for-seats")},"Comparisons: ",O(this.state)," (",L(this.state),")"):"votes-myvd"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Voting District"):"votes-split"==t?r.a.createElement("div",{className:zn("quick-results-title")},"Split (Nat/Prov): National Assembly and ",O(this.state)):"votes-predictions"==t?r.a.createElement("div",{className:zn("quick-results-title")},"CSIR predictions for final results, with ",r.a.createElement("span",{ref:"curCountingProg"},n,"%")," VDs counted: ",function(e){return"national"==e.regionType?"National Assembly":e.provinceName+" Legislature"}(this.state)):null}},{key:"renderMap",value:function(){var e=this,t="Click on the map for detailed results",n=this.state,a=n.comp,i=n.iecId,o=n.muniCode,s=JSON.parse(JSON.stringify(this.state));return"votes-myvd"==a?i&&i.length&&o&&o.length?(s.disableNavigation=!0,r.a.createElement("div",{className:zn("map-container")},r.a.createElement("div",{className:Hn("leadingmap-title-container")},r.a.createElement("div",{className:Hn("leading-parties")},"Leading Parties"),r.a.createElement("div",{className:Hn("helper-text")},t)),r.a.createElement(Mt,Object.assign({ref:function(t){e.mapInstance=t},key:a},s,{componentID:-1e3})))):null:"votes-split"==a?(s.disableNavigation=!0,s.regionType="national",r.a.createElement("div",{className:zn("map-container")},r.a.createElement("div",{className:Hn("leadingmap-title-container")},r.a.createElement("div",{className:Hn("leading-parties")},"Leading Parties"),r.a.createElement("div",{className:Hn("helper-text")},t)),r.a.createElement(Mt,Object.assign({ref:function(t){e.mapInstance=t},key:a},s,{componentID:-1e3})))):"votes-turnout"==a?r.a.createElement("div",{className:zn("map-container")},r.a.createElement(St,Object.assign({ref:function(t){e.mapInstance=t},key:a},this.state,{componentID:-1e3}))):"votes-progress"==a?(console.log("votes-PROGRESS"),r.a.createElement("div",{className:zn("map-container")},r.a.createElement(St,Object.assign({ref:function(t){e.mapInstance=t},key:a},this.state,{isTurnout:!1,componentID:-1e3})))):r.a.createElement("div",{className:zn("map-container")},("votes-default"===a||"votes-default-metro"===a)&&r.a.createElement("div",{className:Hn("leadingmap-title-container")},r.a.createElement("div",{className:Hn("leading-parties")},"Leading Parties"),r.a.createElement("div",{className:Hn("helper-text")},t)),r.a.createElement(Mt,Object.assign({ref:function(t){e.mapInstance=t},key:a},this.state,{componentID:-1e3})))}},{key:"renderBarchart",value:function(){var e=this,t=this.state,n=t.comp,a=t.partyIecIds,i=t.partyAbbrs,o=t.iecId;if("votes-default"==n||"votes-default-metro"==n||"votes-myvd"==n&&o&&o.length)return r.a.createElement("div",{className:zn("barchart-container")},r.a.createElement(mt,Object.assign({key:n,ref:function(t){e.barchartInstance=t}},this.state,{componentID:-1e3})));if("seats-default"==n)return r.a.createElement("div",{className:zn("barchart-container")},r.a.createElement(bn,Object.assign({ref:function(t){e.barchartInstance=t}},this.state,{componentID:-1e3})));if("votes-turnout"==n)return r.a.createElement("div",{className:zn("barchart-container")},r.a.createElement(Dt,Object.assign({ref:function(t){e.barchartInstance=t}},this.state,{componentID:-1e3})));if("votes-progress"==n)return r.a.createElement("div",{className:zn("barchart-container")},r.a.createElement(Jt,Object.assign({ref:function(t){e.barchartInstance=t}},this.state,{componentID:-1e3})));if("votes-predictions"==n)return r.a.createElement("div",{className:zn("barchart-container")},r.a.createElement(On,Object.assign({ref:function(t){e.barchartInstance=t}},this.state,{componentID:-1e3})));if("votes-comparisons"==n){var s=this.state.numParties;return this.barchartInstances=new Array(s),r.a.createElement("div",{className:zn("barchart-container")},a.map(function(t,n){return r.a.createElement(un,Object.assign({ref:function(t){e.barchartInstances[n]=t},key:n},e.state,{partyAbbr:i[n],partyIecId:t,componentID:-1e3}))}))}return"seats-comparisons"==n?(this.barchartInstances=new Array(s),r.a.createElement("div",{className:zn("barchart-container")},a.map(function(t,n){return r.a.createElement(pn,Object.assign({ref:function(t){e.barchartInstances[n]=t},key:n},e.state,{partyAbbr:i[n],partyIecId:t,componentID:-1e3}))}))):"votes-split"==n?r.a.createElement("div",{className:zn("barchart-container")},r.a.createElement(Dn,Object.assign({ref:function(t){e.barchartInstance=t}},this.state,{componentID:-1e3}))):null}},{key:"renderMyVDEnterForm",value:function(){return"votes-myvd"!=this.state.comp?null:r.a.createElement("div",{className:"voting-district-enter-form"},r.a.createElement("input",{ref:"vdInput",type:"text",placeholder:"Enter your VD number"}),r.a.createElement("button",{onClick:this.onShowVDResult.bind(this)}," Show Result"),r.a.createElement("p",{className:"iec-link"},"Look up your voting district number at the ",r.a.createElement("a",{href:"http://maps.elections.org.za/vsfinder/",target:"_blank"},"IEC"),"."))}},{key:"onShowVDResult",value:function(){if(0!=this.refs.vdInput.value.length){var e={regionType:"municipality-vd",iecId:this.refs.vdInput.value,muniCode:""};D(Y,e)}else alert("please enter valid vd number")}},{key:"render",value:function(){var e=this.state.stylesheetFor,t=[];return t.push(this.renderQuickResultsTitle()),this.state.enableTurnoutProgressSpoilt&&t.push(this.renderTurnoutProgressSpoilt()),t.push(this.renderMyVDEnterForm()),this.state.enableBarChart&&t.push(this.renderBarchart()),this.state.enableMap&&t.push(this.renderMap()),r.a.createElement("div",{className:zn("quickresultswidget")+" "+Hn("stylesheet-".concat(e))},r.a.createElement("div",{className:Hn("row")},r.a.createElement("div",{className:Hn("col-md-4")+" "+zn("main-left-part")},r.a.createElement(qn,this.state)),r.a.createElement("div",{className:Hn("col-md-8")+" "+zn("main-right-part")},t)))}}]),t}(a.Component);function Xn(e,t,n,a,r){r||(r={}),e.selectAll("svg").remove();var i=["blue","yellow","red"],o=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",r.viewBox||"0 0 770 420").classed("svg-content",!0),s=V(a),c=p.scaleBand().rangeRound([70,700]),u=p.scaleLinear().rangeRound([300,120]),l=o.append("g").attr("transform","translate(350,150)").append("text").attr("text-anchor","middle");this.draw=function(e,t){if(o.selectAll(".topLabel").remove(),o.append("text").attr("class","topLabel").attr("text-anchor","middle").attr("x",350).attr("y",20).text(r.topLabel),e){l.text("");var n={},m=t;m&&m.data.allParties.edges&&m.data.allParties.edges.forEach(function(e){n[e.node.name]=e.node.colour}),c.domain(e.map(function(e){return e.partyAbbr}));var d=[0,100];r.dynamicYAxisFromValues&&(d[1]=p.max(e.map(function(e){return p.max(e.data,function(e){return parseFloat(r.yValue(e))})}))+1),u.domain(d);var v=o.selectAll(".bar-group").data(e);v.exit().transition().duration(300).style("fill-opacity",1e-6).remove(),(f=v.enter().append("g").attr("class",function(e){return"bar-group ".concat(U(e.partyAbbr))}).attr("transform",function(e){return"translate(".concat(c(e.partyAbbr),", 0)")})).append("rect").attr("class",a(N.CSS_PREFIX+"grouprect")).attr("x",1*-c.bandwidth()/12).attr("y",35).attr("width",5*c.bandwidth()/6).attr("height",300),f.append("g").attr("class","groupname-container").attr("transform","translate(".concat(1*c.bandwidth()/3,", ").concat(70,")")).append("text").attr("text-anchor","middle").text(function(e){return e.partyAbbr}),f.append("g").attr("class","bar-container"),f.append("g").attr("class","bartext-container"),f.append("g").attr("class","baraxistext-container");for(var h=0;h<e.length;h++){var f,y=e[h].partyAbbr,g=e[h].data,C=p.scaleBand().rangeRound([0,2*c.bandwidth()/3]).domain(g.map(function(e){return e.name})),b=(f=o.selectAll(".bar-group.".concat(U(y)))).select(".bar-container"),E=f.select(".bartext-container"),I=f.select(".baraxistext-container"),x=b.selectAll(".".concat(a("bar"))).data(g);x.exit().transition().duration(300).attr("y",function(e){return u(0)}).attr("height",0).style("fill-opacity",1e-6).remove(),x.enter().append("rect").attr("class",function(e){return a("bar")+" bar_"+e.name}).attr("x",function(e,t){return C(e.name)+C.bandwidth()/4}).attr("width",1*C.bandwidth()/2).attr("fill",function(e,t){return A(e,t)}).on("mousemove",function(e,t){p.select(this).attr("opacity",.8),s.transition().duration(200).style("opacity",.9),s.html(T(e)).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e){p.select(this).attr("opacity",1),s.transition().duration(200).style("opacity",0)}).attr("y",function(e){return u(0)}).attr("height",0),b.selectAll(".".concat(a("bar"))).data(g).attr("fill",function(e,t){return A(e,t)}).transition().duration(300).attr("y",function(e){return u(Number(r.yValue(e)))}).attr("height",function(e){return 300-u(Number(r.yValue(e)))});var P=I.selectAll(".".concat(a("bartext"))).data(g);P.exit().transition().duration(300).style("fill-opacity",1e-6).remove(),P.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return C(e.name)+C.bandwidth()/2}).attr("text-anchor","middle").attr("font-size","7px").attr("y",function(e){return u(0)+18}),I.selectAll(".".concat(a("bartext"))).data(g).text(function(e){return/(19|20)\d{2}/g.exec(e.name)[0]});var w=E.selectAll(".".concat(a("bartext"))).data(g);w.exit().transition().duration(300).attr("y",function(e){return u(0)-5}).style("fill-opacity",1e-6).remove(),w.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return C(e.name)+C.bandwidth()/2}).attr("text-anchor","middle").attr("font-size","7px").attr("y",function(e){return u(0)-5}),E.selectAll(".".concat(a("bartext"))).data(g).text(function(e){return r.yValueFormat(r.yValue(e))}).transition().duration(300).attr("y",function(e){return u(Number(r.yValue(e)))-5})}}else l.text("chart data is not available");function A(e,t){return function(e,t){return n[e.split("/")[0]]||i[t%i.length]}(e.partyInfo.name,t)}function T(e,t){return r.noXaxisByParty?e.name+" : "+r.yValueFormat(r.yValue(e)):K(e.partyInfo.name)+" : "+r.yValueFormat(r.yValue(e))}},this.destroy=function(){o.remove()}}var Yn,Jn={topLabel:"NATIONAL ASSEMBLY: 2009, 2014, 2019",usedValue:"SEATS COUNTED",yValue:function(e){return e.seats},yValueFormat:function(e){return e},dynamicYAxisFromValues:!0,viewBox:"45 0 655 340"};function Qn(e){return h.a[e]||e}function $n(e){return Qn(N.CSS_PREFIX+e)}a.Component;function ea(e,t,n,a,r){r||(r={}),e.selectAll("svg").remove();var i=["blue","yellow","red"],o=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 770 420").classed("svg-content",!0),s=V(a),c=p.scaleBand().rangeRound([70,700]),u=p.scaleLinear().rangeRound([300,120]),l=o.append("g").attr("transform","translate(350,150)").append("text").attr("text-anchor","middle");this.draw=function(e,t){if(o.selectAll(".topLabel").remove(),o.append("text").attr("text-anchor","middle").attr("class","topLabel").attr("x",350).attr("y",20).text(r.topLabel),e){l.text("");var n={},m=t;m&&m.data.allParties.edges&&m.data.allParties.edges.forEach(function(e){n[e.node.name]=e.node.colour});var d=e.map(function(e){var t=e.data;return Object(f.a)({},e,{data:[Object(f.a)({},t[1],{delta:r.yValue(t[1])-r.yValue(t[0])})]})});c.domain(e.map(function(e){return e.partyAbbr}));var v=[-100,100];r.dynamicYAxisFromValues&&(v[1]=p.max(d.map(function(e){return parseFloat(e.data[0].delta)}))+1,v[0]=p.min(d.map(function(e){return parseFloat(e.data[0].delta)}))-1),u.domain(v);var h=o.selectAll(".bar-group").data(d);h.exit().transition().duration(300).style("fill-opacity",1e-6).remove(),(y=h.enter().append("g").attr("class",function(e){return"bar-group ".concat(U(e.partyAbbr))}).attr("transform",function(e){return"translate(".concat(c(e.partyAbbr),", 0)")})).append("g").attr("class","groupname-container").attr("transform","translate(".concat(1*c.bandwidth()/3,", ").concat(70,")")).append("text").attr("text-anchor","middle").text(function(e){return e.partyAbbr}),y.append("g").attr("class","bar-container"),y.append("g").attr("class","bartext-container");for(var N=0;N<d.length;N++){var y,g=d[N].partyAbbr,C=d[N].data,b=(y=o.selectAll(".bar-group.".concat(U(g)))).select(".bar-container"),E=y.select(".bartext-container"),I=b.selectAll(".".concat(a("bar"))).data(C);I.exit().transition().duration(300).attr("height",0).style("fill-opacity",1e-6).remove(),I.enter().append("rect").attr("class",function(e){return a("bar")+" bar_"+e.name}).attr("x",c.bandwidth()/6).attr("width",1*c.bandwidth()/3).attr("fill",function(e,t){return P(e,t)}).on("mousemove",function(e,t){p.select(this).attr("opacity",.8),s.transition().duration(200).style("opacity",.9),s.html(w(e)).style("left",p.event.pageX+"px").style("top",p.event.pageY-28+"px")}).on("mouseout",function(e){p.select(this).attr("opacity",1),s.transition().duration(200).style("opacity",0)}).attr("y",function(e){return u(0)}).attr("height",0),b.selectAll(".".concat(a("bar"))).data(C).attr("fill",function(e,t){return P(e,t)}).transition().duration(300).attr("y",function(e){return Math.min(u(Number(e.delta)),u(0))}).attr("height",function(e){return Math.abs(u(Number(e.delta))-u(0))});var x=E.selectAll(".".concat(a("bartext"))).data(C);x.exit().transition().duration(300).style("fill-opacity",1e-6).remove(),x.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return c.bandwidth()/3}).attr("text-anchor","middle").attr("font-size","12px").attr("y",function(e){return e.delta>0?u(0)-5:u(0)+5}),E.selectAll(".".concat(a("bartext"))).data(C).text(function(e){return r.yValueFormat(e.delta)}).transition().duration(300).attr("y",function(e){var t=0;return t=e.delta>0?-5:15,u(Number(e.delta))+t})}o.selectAll(".xAxisLine").remove();o.append("line").attr("class","xAxisLine").attr("stroke-width",2).attr("stroke","currentColor").attr("x1",70).attr("y1",u(0)-1).attr("x2",700).attr("y2",u(0)-1)}else l.text("chart data is not available");function P(e,t){return function(e,t){return n[e.split("/")[0]]||i[t%i.length]}(e.partyInfo.name,t)}function w(e,t){return r.noXaxisByParty?e.name+" : "+r.yValueFormat(e.delta):K(e.partyInfo.name)+" : "+r.yValueFormat(e.delta)}},this.destroy=function(){o.remove()}}var ta,na={topLabel:"NATIONAL ASSEMBLY: 2009, 2014",usedValue:"SEATS COUNTED",yValue:function(e){return e.seats},yValueFormat:function(e){return e},dynamicYAxisFromValues:!0};function aa(e){return h.a[e]||e}function ra(e){return aa(N.CSS_PREFIX+e)}var ia;a.Component,it();function oa(e){return h.a[e]||e}function sa(e){return oa(N.CSS_PREFIX+e)}var ca,ua={topLabel:"NATIONAL ASSEMBLY: 2009, 2014, 2019",usedValue:"% VDS COUNTED",yValue:function(e){return e.percOfVotes},yValueFormat:function(e){return e+"%"},dynamicYAxisFromValues:!0};a.Component,it();function la(e){return h.a[e]||e}function ma(e){return la(N.CSS_PREFIX+e)}var da={topLabel:"NATIONAL ASSEMBLY: 2009, 2014, 2019",usedValue:"% VDS COUNTED",yValue:function(e){return e.percOfVotes},yValueFormat:function(e){return(e>0?"+":"")+e.toFixed(2)+"%"},dynamicYAxisFromValues:!0},pa=(a.Component,function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(_n,{stylesheetFor:"tv",eventDescription:"2019 NATIONAL ELECTION",nationalEventDescription:"2019 NATIONAL ELECTION",provincialEventDescription:"2019 PROVINCIAL ELECTION"}))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(pa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},14:function(e,t,n){},32:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},58:function(e,t,n){},64:function(e,t,n){e.exports=n(106)},69:function(e,t,n){},71:function(e,t,n){}},[[64,2,1]]]);
//# sourceMappingURL=main.d7fe4b64.chunk.js.map